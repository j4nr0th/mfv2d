
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>solving &#8212; mfv2d  documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=8f2a1f02" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="../_static/jupyter-sphinx.css" />
    <link rel="stylesheet" type="text/css" href="../_static/thebelab.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery.css?v=d2d258e8" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-binder.css?v=f4aeca0c" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-dataframe.css?v=2082cf3c" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-rendered-html.css?v=1277b6f3" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../_static/doctools.js?v=9bcbadda"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/thebelab-helper.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@jupyter-widgets/html-manager@^1.0.1/dist/embed-amd.js"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'modules/solving';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="system" href="system.html" />
    <link rel="prev" title="solve_system" href="solve_system.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search..."
         aria-label="Search..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
  
  
    <p class="title logo__title">mfv2d  documentation</p>
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../basis.html">Mimetic Spectral Elements Method</a></li>
<li class="toctree-l1"><a class="reference internal" href="../auto_examples/index.html">Examples</a></li>



<li class="toctree-l1 current active has-children"><a class="reference internal" href="../modules.html">Modules</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="_mfv2d.html">_mfv2d</a></li>
<li class="toctree-l2"><a class="reference internal" href="boundary.html">boundary</a></li>
<li class="toctree-l2"><a class="reference internal" href="continuity.html">continuity</a></li>
<li class="toctree-l2"><a class="reference internal" href="eval.html">eval</a></li>
<li class="toctree-l2"><a class="reference internal" href="examples.html">examples</a></li>
<li class="toctree-l2"><a class="reference internal" href="kform.html">kform</a></li>
<li class="toctree-l2"><a class="reference internal" href="mimetic2d.html">mimetic2d</a></li>
<li class="toctree-l2"><a class="reference internal" href="progress.html">progress</a></li>
<li class="toctree-l2"><a class="reference internal" href="refinement.html">refinement</a></li>
<li class="toctree-l2"><a class="reference internal" href="solve_system.html">solve_system</a></li>
<li class="toctree-l2 current active"><a class="current reference internal" href="#">solving</a></li>
<li class="toctree-l2"><a class="reference internal" href="system.html">system</a></li>
</ul>
</details></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/modules/solving.rst" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.rst</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>solving</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#support-types">Support Types</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mfv2d.solving.LinearSystem"><code class="docutils literal notranslate"><span class="pre">LinearSystem</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#mfv2d.solving.LinearSystem.__new__"><code class="docutils literal notranslate"><span class="pre">LinearSystem.__new__()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#mfv2d.solving.LinearSystem.apply_diagonal"><code class="docutils literal notranslate"><span class="pre">LinearSystem.apply_diagonal()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#mfv2d.solving.LinearSystem.apply_diagonal_inverse"><code class="docutils literal notranslate"><span class="pre">LinearSystem.apply_diagonal_inverse()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#mfv2d.solving.LinearSystem.apply_full_trace_system"><code class="docutils literal notranslate"><span class="pre">LinearSystem.apply_full_trace_system()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#mfv2d.solving.LinearSystem.apply_trace"><code class="docutils literal notranslate"><span class="pre">LinearSystem.apply_trace()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#mfv2d.solving.LinearSystem.apply_trace_transpose"><code class="docutils literal notranslate"><span class="pre">LinearSystem.apply_trace_transpose()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#mfv2d.solving.LinearSystem.combined_system_matrix"><code class="docutils literal notranslate"><span class="pre">LinearSystem.combined_system_matrix()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#mfv2d.solving.LinearSystem.get_constraint_blocks"><code class="docutils literal notranslate"><span class="pre">LinearSystem.get_constraint_blocks()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#mfv2d.solving.LinearSystem.get_dense_blocks"><code class="docutils literal notranslate"><span class="pre">LinearSystem.get_dense_blocks()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mfv2d.solving.FullVector"><code class="docutils literal notranslate"><span class="pre">FullVector</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#mfv2d.solving.FullVector.__post_init__"><code class="docutils literal notranslate"><span class="pre">FullVector.__post_init__()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#mfv2d.solving.FullVector.add"><code class="docutils literal notranslate"><span class="pre">FullVector.add()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#mfv2d.solving.FullVector.copy"><code class="docutils literal notranslate"><span class="pre">FullVector.copy()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#mfv2d.solving.FullVector.dense"><code class="docutils literal notranslate"><span class="pre">FullVector.dense</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#mfv2d.solving.FullVector.dot"><code class="docutils literal notranslate"><span class="pre">FullVector.dot()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#mfv2d.solving.FullVector.make_empty"><code class="docutils literal notranslate"><span class="pre">FullVector.make_empty()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#mfv2d.solving.FullVector.scale"><code class="docutils literal notranslate"><span class="pre">FullVector.scale()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#mfv2d.solving.FullVector.set_from"><code class="docutils literal notranslate"><span class="pre">FullVector.set_from()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#mfv2d.solving.FullVector.subtract"><code class="docutils literal notranslate"><span class="pre">FullVector.subtract()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#mfv2d.solving.FullVector.trace"><code class="docutils literal notranslate"><span class="pre">FullVector.trace</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#core-solvers">Core Solvers</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mfv2d.solving.gmres_general"><code class="docutils literal notranslate"><span class="pre">gmres_general()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mfv2d.solving.cg_general"><code class="docutils literal notranslate"><span class="pre">cg_general()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mfv2d.solving.pcg_general"><code class="docutils literal notranslate"><span class="pre">pcg_general()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#system-solvers">System Solvers</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#gmres">GMRES</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#mfv2d.solving.solve_gmres_iterative"><code class="docutils literal notranslate"><span class="pre">solve_gmres_iterative()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cg">CG</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#mfv2d.solving.solve_cg_iterative"><code class="docutils literal notranslate"><span class="pre">solve_cg_iterative()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pcg">PCG</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#mfv2d.solving.solve_pcg_iterative"><code class="docutils literal notranslate"><span class="pre">solve_pcg_iterative()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#schur-s-complement">Schur’s Complement</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="solving">
<h1>solving<a class="headerlink" href="#solving" title="Link to this heading">#</a></h1>
<p>This sub-module contains functions and types that are used to implement
different solvers for the system of equations. They rely on the types
implemented in C to speed the most time consuming parts of the calculations.</p>
<p>The key idea behind all these is to write it in a way that would make it
straight forward to port to a distributed memory architecture. As such,
data and operations are made in a way which requires minimal communication
between the different element data.</p>
<section id="support-types">
<h2>Support Types<a class="headerlink" href="#support-types" title="Link to this heading">#</a></h2>
<p>A wrapper around <a class="reference internal" href="_mfv2d.html#mfv2d._mfv2d.LinearSystem" title="mfv2d._mfv2d.LinearSystem"><code class="xref py py-class docutils literal notranslate"><span class="pre">mfv2d._mfv2d.LinearSystem</span></code></a> is provided by
<a class="reference internal" href="#mfv2d.solving.LinearSystem" title="mfv2d.solving.LinearSystem"><code class="xref py py-class docutils literal notranslate"><span class="pre">LinearSystem</span></code></a>. This provides an easier to deal with constructor,
as well as a few convenience methods.</p>
<dl class="py class">
<dt class="sig sig-object py" id="mfv2d.solving.LinearSystem">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mfv2d.solving.</span></span><span class="sig-name descname"><span class="pre">LinearSystem</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_elem</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">form_spec</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="system.html#mfv2d.system.ElementFormSpecification" title="mfv2d.system.ElementFormSpecification"><span class="pre">ElementFormSpecification</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">orders</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">npt.NDArray</span><span class="p"><span class="pre">[</span></span><span class="pre">np.uint32</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">element_matrices</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><span class="pre">npt.NDArray</span><span class="p"><span class="pre">[</span></span><span class="pre">np.float64</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">constraints</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="mimetic2d.html#mfv2d.mimetic2d.Constraint" title="mfv2d.mimetic2d.Constraint"><span class="pre">Constraint</span></a><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mfv2d/solving.html#LinearSystem"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mfv2d.solving.LinearSystem" title="Link to this definition">#</a></dt>
<dd><p>Class used to represent a linear system with element equations and constraints.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n_elem</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a>) – Number of elements in the system.</p></li>
<li><p><strong>form_spec</strong> (<a class="reference internal" href="system.html#mfv2d.system.ElementFormSpecification" title="mfv2d.system.ElementFormSpecification"><em>ElementFormSpecification</em></a>) – Specification of forms in the element system.</p></li>
<li><p><strong>orders</strong> (<em>array</em>) – Array of element orders.</p></li>
<li><p><strong>element_matrices</strong> (<em>Sequence</em><em> of </em><em>arrays</em>) – Sequence of element matrices.</p></li>
<li><p><strong>constraints</strong> (<em>Sequence</em><em> of </em><a class="reference internal" href="mimetic2d.html#mfv2d.mimetic2d.Constraint" title="mfv2d.mimetic2d.Constraint"><em>Constraint</em></a>) – Sequences of constraints the element systems are subject to.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="mfv2d.solving.LinearSystem.__new__">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">__new__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cls</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_elem</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">form_spec</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="system.html#mfv2d.system.ElementFormSpecification" title="mfv2d.system.ElementFormSpecification"><span class="pre">ElementFormSpecification</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">orders</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">npt.NDArray</span><span class="p"><span class="pre">[</span></span><span class="pre">np.uint32</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">element_matrices</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><span class="pre">npt.NDArray</span><span class="p"><span class="pre">[</span></span><span class="pre">np.float64</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">constraints</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="mimetic2d.html#mfv2d.mimetic2d.Constraint" title="mfv2d.mimetic2d.Constraint"><span class="pre">Constraint</span></a><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference internal" href="../_modules/mfv2d/solving.html#LinearSystem.__new__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mfv2d.solving.LinearSystem.__new__" title="Link to this definition">#</a></dt>
<dd><p>Create a new LinearSystem.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mfv2d.solving.LinearSystem.apply_diagonal">
<span class="sig-name descname"><span class="pre">apply_diagonal</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="_mfv2d.html#mfv2d._mfv2d.DenseVector" title="mfv2d._mfv2d.DenseVector"><span class="pre">DenseVector</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">out</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="_mfv2d.html#mfv2d._mfv2d.DenseVector" title="mfv2d._mfv2d.DenseVector"><span class="pre">DenseVector</span></a></span></em>, <em class="sig-param"><span class="positional-only-separator o"><abbr title="Positional-only parameter separator (PEP 570)"><span class="pre">/</span></abbr></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span></span><a class="headerlink" href="#mfv2d.solving.LinearSystem.apply_diagonal" title="Link to this definition">#</a></dt>
<dd><p>Apply multiplication by the diagonal part of the system.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>DenseVector</strong> – Dense vector to which this is applied.</p></li>
<li><p><strong>DenseVector</strong> – Dense vector to which the output is returned.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mfv2d.solving.LinearSystem.apply_diagonal_inverse">
<span class="sig-name descname"><span class="pre">apply_diagonal_inverse</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="_mfv2d.html#mfv2d._mfv2d.DenseVector" title="mfv2d._mfv2d.DenseVector"><span class="pre">DenseVector</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">out</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="_mfv2d.html#mfv2d._mfv2d.DenseVector" title="mfv2d._mfv2d.DenseVector"><span class="pre">DenseVector</span></a></span></em>, <em class="sig-param"><span class="positional-only-separator o"><abbr title="Positional-only parameter separator (PEP 570)"><span class="pre">/</span></abbr></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span></span><a class="headerlink" href="#mfv2d.solving.LinearSystem.apply_diagonal_inverse" title="Link to this definition">#</a></dt>
<dd><p>Apply inverse of the diagonal part of the system.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>DenseVector</strong> – Dense vector to which this is applied.</p></li>
<li><p><strong>DenseVector</strong> – Dense vector to which the output is returned.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mfv2d.solving.LinearSystem.apply_full_trace_system">
<span class="sig-name descname"><span class="pre">apply_full_trace_system</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="_mfv2d.html#mfv2d._mfv2d.TraceVector" title="mfv2d._mfv2d.TraceVector"><span class="pre">TraceVector</span></a></span></em>, <em class="sig-param"><span class="positional-only-separator o"><abbr title="Positional-only parameter separator (PEP 570)"><span class="pre">/</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">out</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="_mfv2d.html#mfv2d._mfv2d.TraceVector" title="mfv2d._mfv2d.TraceVector"><span class="pre">TraceVector</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">tmp1</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="_mfv2d.html#mfv2d._mfv2d.DenseVector" title="mfv2d._mfv2d.DenseVector"><span class="pre">DenseVector</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">tmp2</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="_mfv2d.html#mfv2d._mfv2d.DenseVector" title="mfv2d._mfv2d.DenseVector"><span class="pre">DenseVector</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span></span><a class="reference internal" href="../_modules/mfv2d/solving.html#LinearSystem.apply_full_trace_system"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mfv2d.solving.LinearSystem.apply_full_trace_system" title="Link to this definition">#</a></dt>
<dd><p>Apply the Schur’s trace system.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>TraceVector</strong> – Trace vector to which this is applied to.</p></li>
<li><p><strong>out</strong> (<a class="reference internal" href="_mfv2d.html#mfv2d._mfv2d.TraceVector" title="mfv2d._mfv2d.TraceVector"><em>TraceVector</em></a>) – Trace vector, which receives output. Can be the same as input.</p></li>
<li><p><strong>tmp1</strong> (<a class="reference internal" href="_mfv2d.html#mfv2d._mfv2d.DenseVector" title="mfv2d._mfv2d.DenseVector"><em>DenseVector</em></a>) – Dense vector used to store intermediate result. Must be unique.</p></li>
<li><p><strong>tmp2</strong> (<a class="reference internal" href="_mfv2d.html#mfv2d._mfv2d.DenseVector" title="mfv2d._mfv2d.DenseVector"><em>DenseVector</em></a>) – Dense vector used to store intermediate result. Must be unique.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mfv2d.solving.LinearSystem.apply_trace">
<span class="sig-name descname"><span class="pre">apply_trace</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="_mfv2d.html#mfv2d._mfv2d.DenseVector" title="mfv2d._mfv2d.DenseVector"><span class="pre">DenseVector</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">out</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="_mfv2d.html#mfv2d._mfv2d.TraceVector" title="mfv2d._mfv2d.TraceVector"><span class="pre">TraceVector</span></a></span></em>, <em class="sig-param"><span class="positional-only-separator o"><abbr title="Positional-only parameter separator (PEP 570)"><span class="pre">/</span></abbr></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span></span><a class="headerlink" href="#mfv2d.solving.LinearSystem.apply_trace" title="Link to this definition">#</a></dt>
<dd><p>Apply the trace constraints to the dense vector.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>DenseVector</strong> – Dense vector to which this is applied.</p></li>
<li><p><strong>TraceVector</strong> – Trace vector to which the output is returned.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mfv2d.solving.LinearSystem.apply_trace_transpose">
<span class="sig-name descname"><span class="pre">apply_trace_transpose</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="_mfv2d.html#mfv2d._mfv2d.TraceVector" title="mfv2d._mfv2d.TraceVector"><span class="pre">TraceVector</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">out</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="_mfv2d.html#mfv2d._mfv2d.DenseVector" title="mfv2d._mfv2d.DenseVector"><span class="pre">DenseVector</span></a></span></em>, <em class="sig-param"><span class="positional-only-separator o"><abbr title="Positional-only parameter separator (PEP 570)"><span class="pre">/</span></abbr></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span></span><a class="headerlink" href="#mfv2d.solving.LinearSystem.apply_trace_transpose" title="Link to this definition">#</a></dt>
<dd><p>Apply the transpose of the constraints to the trace vector.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>TraceVector</strong> – Trace vector to which this is applied.</p></li>
<li><p><strong>DenseVector</strong> – Dense vector to which the output is returned.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mfv2d.solving.LinearSystem.combined_system_matrix">
<span class="sig-name descname"><span class="pre">combined_system_matrix</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.sparse.csr_array.html#scipy.sparse.csr_array" title="(in SciPy v1.16.2)"><span class="pre">csr_array</span></a></span></span><a class="reference internal" href="../_modules/mfv2d/solving.html#LinearSystem.combined_system_matrix"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mfv2d.solving.LinearSystem.combined_system_matrix" title="Link to this definition">#</a></dt>
<dd><p>Combine the system matrix into a scipy CSR array.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mfv2d.solving.LinearSystem.get_constraint_blocks">
<span class="sig-name descname"><span class="pre">get_constraint_blocks</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#mfv2d.solving.LinearSystem.get_constraint_blocks" title="Link to this definition">#</a></dt>
<dd><p>get_system_constraint_blocks() -&gt; tuple[MatrixCRS, …]
Get the constraint blocks of the system.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mfv2d.solving.LinearSystem.get_dense_blocks">
<span class="sig-name descname"><span class="pre">get_dense_blocks</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#mfv2d.solving.LinearSystem.get_dense_blocks" title="Link to this definition">#</a></dt>
<dd><p>get_system_dense_blocks() -&gt; tuple[numpy.typing.NDArray[numpy.float64], …]
Get the dense blocks of the system.</p>
</dd></dl>

</dd></dl>

<p>To make writing some solvers easier <a class="reference internal" href="#mfv2d.solving.FullVector" title="mfv2d.solving.FullVector"><code class="xref py py-class docutils literal notranslate"><span class="pre">FullVector</span></code></a> is provided.
This type just packs the dense parts represented by
<a class="reference internal" href="_mfv2d.html#mfv2d._mfv2d.DenseVector" title="mfv2d._mfv2d.DenseVector"><code class="xref py py-class docutils literal notranslate"><span class="pre">mfv2d._mfv2d.DenseVector</span></code></a> and the trace parts
<a class="reference internal" href="_mfv2d.html#mfv2d._mfv2d.TraceVector" title="mfv2d._mfv2d.TraceVector"><code class="xref py py-class docutils literal notranslate"><span class="pre">mfv2d._mfv2d.TraceVector</span></code></a> together and provides methods
these two provide.</p>
<dl class="py class">
<dt class="sig sig-object py" id="mfv2d.solving.FullVector">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mfv2d.solving.</span></span><span class="sig-name descname"><span class="pre">FullVector</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dense</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="_mfv2d.html#mfv2d._mfv2d.DenseVector" title="mfv2d._mfv2d.DenseVector"><span class="pre">DenseVector</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">trace</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="_mfv2d.html#mfv2d._mfv2d.TraceVector" title="mfv2d._mfv2d.TraceVector"><span class="pre">TraceVector</span></a></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mfv2d/solving.html#FullVector"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mfv2d.solving.FullVector" title="Link to this definition">#</a></dt>
<dd><p>Class contaning a dense and trace vector.</p>
<dl class="py method">
<dt class="sig sig-object py" id="mfv2d.solving.FullVector.__post_init__">
<span class="sig-name descname"><span class="pre">__post_init__</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span></span><a class="reference internal" href="../_modules/mfv2d/solving.html#FullVector.__post_init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mfv2d.solving.FullVector.__post_init__" title="Link to this definition">#</a></dt>
<dd><p>Check both are from the same parent.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mfv2d.solving.FullVector.add">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">add</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">v1</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#mfv2d.solving.FullVector" title="mfv2d.solving.FullVector"><span class="pre">FullVector</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">v2</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#mfv2d.solving.FullVector" title="mfv2d.solving.FullVector"><span class="pre">FullVector</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">v_out</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#mfv2d.solving.FullVector" title="mfv2d.solving.FullVector"><span class="pre">FullVector</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">k</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><span class="pre">float</span></a></span></em>, <em class="sig-param"><span class="positional-only-separator o"><abbr title="Positional-only parameter separator (PEP 570)"><span class="pre">/</span></abbr></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span></span><a class="reference internal" href="../_modules/mfv2d/solving.html#FullVector.add"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mfv2d.solving.FullVector.add" title="Link to this definition">#</a></dt>
<dd><p>Add two vectors.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mfv2d.solving.FullVector.copy">
<span class="sig-name descname"><span class="pre">copy</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#mfv2d.solving.FullVector" title="mfv2d.solving.FullVector"><span class="pre">FullVector</span></a></span></span><a class="reference internal" href="../_modules/mfv2d/solving.html#FullVector.copy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mfv2d.solving.FullVector.copy" title="Link to this definition">#</a></dt>
<dd><p>Create a copy of itself.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="mfv2d.solving.FullVector.dense">
<span class="sig-name descname"><span class="pre">dense</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="_mfv2d.html#mfv2d._mfv2d.DenseVector" title="mfv2d._mfv2d.DenseVector"><span class="pre">DenseVector</span></a></em><a class="headerlink" href="#mfv2d.solving.FullVector.dense" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mfv2d.solving.FullVector.dot">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">dot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">v1</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#mfv2d.solving.FullVector" title="mfv2d.solving.FullVector"><span class="pre">FullVector</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">v2</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#mfv2d.solving.FullVector" title="mfv2d.solving.FullVector"><span class="pre">FullVector</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><span class="pre">float</span></a></span></span><a class="reference internal" href="../_modules/mfv2d/solving.html#FullVector.dot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mfv2d.solving.FullVector.dot" title="Link to this definition">#</a></dt>
<dd><p>Compute dot product of two vectors.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mfv2d.solving.FullVector.make_empty">
<em class="property"><span class="k"><span class="pre">classmethod</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">make_empty</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">system</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#mfv2d.solving.LinearSystem" title="mfv2d.solving.LinearSystem"><span class="pre">LinearSystem</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Self" title="(in Python v3.14)"><span class="pre">Self</span></a></span></span><a class="reference internal" href="../_modules/mfv2d/solving.html#FullVector.make_empty"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mfv2d.solving.FullVector.make_empty" title="Link to this definition">#</a></dt>
<dd><p>Create an empty vector.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mfv2d.solving.FullVector.scale">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">scale</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">v</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#mfv2d.solving.FullVector" title="mfv2d.solving.FullVector"><span class="pre">FullVector</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">k</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><span class="pre">float</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">v_out</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#mfv2d.solving.FullVector" title="mfv2d.solving.FullVector"><span class="pre">FullVector</span></a></span></em>, <em class="sig-param"><span class="positional-only-separator o"><abbr title="Positional-only parameter separator (PEP 570)"><span class="pre">/</span></abbr></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span></span><a class="reference internal" href="../_modules/mfv2d/solving.html#FullVector.scale"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mfv2d.solving.FullVector.scale" title="Link to this definition">#</a></dt>
<dd><p>Scale the vector by a constant.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mfv2d.solving.FullVector.set_from">
<span class="sig-name descname"><span class="pre">set_from</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">other</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#mfv2d.solving.FullVector" title="mfv2d.solving.FullVector"><span class="pre">FullVector</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span></span><a class="reference internal" href="../_modules/mfv2d/solving.html#FullVector.set_from"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mfv2d.solving.FullVector.set_from" title="Link to this definition">#</a></dt>
<dd><p>Set the vector from another.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mfv2d.solving.FullVector.subtract">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">subtract</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">v1</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#mfv2d.solving.FullVector" title="mfv2d.solving.FullVector"><span class="pre">FullVector</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">v2</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#mfv2d.solving.FullVector" title="mfv2d.solving.FullVector"><span class="pre">FullVector</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">v_out</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#mfv2d.solving.FullVector" title="mfv2d.solving.FullVector"><span class="pre">FullVector</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">k</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><span class="pre">float</span></a></span></em>, <em class="sig-param"><span class="positional-only-separator o"><abbr title="Positional-only parameter separator (PEP 570)"><span class="pre">/</span></abbr></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span></span><a class="reference internal" href="../_modules/mfv2d/solving.html#FullVector.subtract"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mfv2d.solving.FullVector.subtract" title="Link to this definition">#</a></dt>
<dd><p>Subtracts two vectors.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="mfv2d.solving.FullVector.trace">
<span class="sig-name descname"><span class="pre">trace</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="_mfv2d.html#mfv2d._mfv2d.TraceVector" title="mfv2d._mfv2d.TraceVector"><span class="pre">TraceVector</span></a></em><a class="headerlink" href="#mfv2d.solving.FullVector.trace" title="Link to this definition">#</a></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="core-solvers">
<h2>Core Solvers<a class="headerlink" href="#core-solvers" title="Link to this heading">#</a></h2>
<p>The solvers implemented in this sub-module all follow the phylosophy that
they should be type-agnostic. As such, they all take the system along with
all functions needed to operate on it. This allows the same solver to be
used for different vector and system types by just writing a few short
wrapper functions.</p>
<dl class="py function">
<dt class="sig sig-object py" id="mfv2d.solving.gmres_general">
<span class="sig-prename descclassname"><span class="pre">mfv2d.solving.</span></span><span class="sig-name descname"><span class="pre">gmres_general</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mat</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">_Mat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rhs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">_Vec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">initial_guess</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">_Vec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">convergence</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ConvergenceSettings</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">system_application_function</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Callable" title="(in Python v3.14)"><span class="pre">Callable</span></a><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="pre">_Mat</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">_Vec</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">_Vec</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vec_dot_function</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Callable" title="(in Python v3.14)"><span class="pre">Callable</span></a><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="pre">_Vec</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">_Vec</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><span class="pre">float</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vec_add_to_function</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Callable" title="(in Python v3.14)"><span class="pre">Callable</span></a><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="pre">_Vec</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">_Vec</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">_Vec</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><span class="pre">float</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vec_sub_from_scaled_function</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Callable" title="(in Python v3.14)"><span class="pre">Callable</span></a><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="pre">_Vec</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">_Vec</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">_Vec</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><span class="pre">float</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vec_scale_by_function</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Callable" title="(in Python v3.14)"><span class="pre">Callable</span></a><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="pre">_Vec</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><span class="pre">float</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">_Vec</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vec_copy_function</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Callable" title="(in Python v3.14)"><span class="pre">Callable</span></a><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="pre">_Vec</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">_Vec</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.14)"><span class="pre">tuple</span></a><span class="p"><span class="pre">[</span></span><span class="pre">_Vec</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><span class="pre">float</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/mfv2d/solving.html#gmres_general"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mfv2d.solving.gmres_general" title="Link to this definition">#</a></dt>
<dd><p>General implementation of GMRES to use for any data type with operators.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><ul class="simple">
<li><p><em>_Vec</em> – Computed solution.</p></li>
<li><p><em>float</em> – Estimated residual.</p></li>
<li><p><em>int</em> – Iterations done.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="mfv2d.solving.cg_general">
<span class="sig-prename descclassname"><span class="pre">mfv2d.solving.</span></span><span class="sig-name descname"><span class="pre">cg_general</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mat</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">_Mat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rhs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">_Vec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">initial_guess</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">_Vec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">convergence</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ConvergenceSettings</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">system_application_function</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Callable" title="(in Python v3.14)"><span class="pre">Callable</span></a><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="pre">_Mat</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">_Vec</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vec_dot_function</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Callable" title="(in Python v3.14)"><span class="pre">Callable</span></a><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="pre">_Vec</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">_Vec</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><span class="pre">float</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vec_add_to_scaled_function</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Callable" title="(in Python v3.14)"><span class="pre">Callable</span></a><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="pre">_Vec</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">_Vec</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><span class="pre">float</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vec_sub_from_scaled_function</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Callable" title="(in Python v3.14)"><span class="pre">Callable</span></a><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="pre">_Vec</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">_Vec</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><span class="pre">float</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vec_copy_function</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Callable" title="(in Python v3.14)"><span class="pre">Callable</span></a><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="pre">_Vec</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">_Vec</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vec_set_function</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Callable" title="(in Python v3.14)"><span class="pre">Callable</span></a><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="pre">_Vec</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">_Vec</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.14)"><span class="pre">tuple</span></a><span class="p"><span class="pre">[</span></span><span class="pre">_Vec</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><span class="pre">float</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/mfv2d/solving.html#cg_general"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mfv2d.solving.cg_general" title="Link to this definition">#</a></dt>
<dd><p>General implementation of GMRES to use for any data type with operators.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>m</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a>) – Number of basis to use for the solution.</p></li>
<li><p><strong>mat</strong> (<em>_Mat</em>) – System matrix state.</p></li>
<li><p><strong>rhs</strong> (<em>_Vec</em>) – Right side of the system.</p></li>
<li><p><strong>convergence</strong> (<em>ConvergenceSettings</em>) – Settings to use for convergence.</p></li>
<li><p><strong>system_application_function</strong> (<em>(</em><em>_Mat</em><em>, </em><em>_Vec</em><em>) </em><em>-&gt; _Vec</em>) – Function that applies the system to the input vector.</p></li>
<li><p><strong>vec_dot_function</strong> (<em>(</em><em>_Vec</em><em>, </em><em>_Vec</em><em>) </em><em>-&gt; float</em>) – Function that computes the dot product of system vectors.</p></li>
<li><p><strong>vec_add_function</strong> (<em>(</em><em>_Vec</em><em>, </em><em>_Vec</em><em>) </em><em>-&gt; _Vec</em>) – Function that adds two vectors together.</p></li>
<li><p><strong>vec_sub_function</strong> (<em>(</em><em>_Vec</em><em>, </em><em>_Vec</em><em>) </em><em>-&gt; _Vec</em>) – Function which subtracts two vectors.</p></li>
<li><p><strong>vec_scale_function</strong> (<em>(</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a><em>, </em><em>_Vec</em><em>) </em><em>-&gt; _Vec</em>) – Function which scales a vector by a constant</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><em>_Vec</em> – Computed solution.</p></li>
<li><p><em>float</em> – Estimated residual.</p></li>
<li><p><em>int</em> – Iterations done.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="mfv2d.solving.pcg_general">
<span class="sig-prename descclassname"><span class="pre">mfv2d.solving.</span></span><span class="sig-name descname"><span class="pre">pcg_general</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mat</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">_Mat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rhs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">_Vec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">initial_guess</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">_Vec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">convergence</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ConvergenceSettings</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">system_application_function</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Callable" title="(in Python v3.14)"><span class="pre">Callable</span></a><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="pre">_Mat</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">_Vec</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">_Vec</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">precondition_function</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Callable" title="(in Python v3.14)"><span class="pre">Callable</span></a><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="pre">_Mat</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">_Vec</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">_Vec</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vec_dot_function</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Callable" title="(in Python v3.14)"><span class="pre">Callable</span></a><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="pre">_Vec</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">_Vec</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><span class="pre">float</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vec_add_to_scaled_function</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Callable" title="(in Python v3.14)"><span class="pre">Callable</span></a><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="pre">_Vec</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">_Vec</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><span class="pre">float</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">_Vec</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vec_sub_from_scaled_function</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Callable" title="(in Python v3.14)"><span class="pre">Callable</span></a><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="pre">_Vec</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">_Vec</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><span class="pre">float</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">_Vec</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vec_copy_function</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Callable" title="(in Python v3.14)"><span class="pre">Callable</span></a><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="pre">_Vec</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">_Vec</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">degen_limit</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><span class="pre">float</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1e-12</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.14)"><span class="pre">tuple</span></a><span class="p"><span class="pre">[</span></span><span class="pre">_Vec</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><span class="pre">float</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/mfv2d/solving.html#pcg_general"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mfv2d.solving.pcg_general" title="Link to this definition">#</a></dt>
<dd><p>General implementation of GMRES to use for any data type with operators.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><ul class="simple">
<li><p><em>_Vec</em> – Computed solution.</p></li>
<li><p><em>float</em> – Estimated residual.</p></li>
<li><p><em>int</em> – Iterations done.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="system-solvers">
<h2>System Solvers<a class="headerlink" href="#system-solvers" title="Link to this heading">#</a></h2>
<p>Solvers which actually solve the system are based on the core solvers
and use them at some point, though the specific way the do it can differ.</p>
<section id="gmres">
<h3>GMRES<a class="headerlink" href="#gmres" title="Link to this heading">#</a></h3>
<p>GMRES may be slow and memory hungry, but it is guaranteed to give you the
best solution possible from a Krylov method solver. It solves the system
by using the <a class="reference internal" href="#mfv2d.solving.FullVector" title="mfv2d.solving.FullVector"><code class="xref py py-class docutils literal notranslate"><span class="pre">FullVector</span></code></a> and solve it all at once.</p>
<dl class="py function">
<dt class="sig sig-object py" id="mfv2d.solving.solve_gmres_iterative">
<span class="sig-prename descclassname"><span class="pre">mfv2d.solving.</span></span><span class="sig-name descname"><span class="pre">solve_gmres_iterative</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">system</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#mfv2d.solving.LinearSystem" title="mfv2d.solving.LinearSystem"><span class="pre">LinearSystem</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">rhs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="_mfv2d.html#mfv2d._mfv2d.DenseVector" title="mfv2d._mfv2d.DenseVector"><span class="pre">DenseVector</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">constraints</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="_mfv2d.html#mfv2d._mfv2d.TraceVector" title="mfv2d._mfv2d.TraceVector"><span class="pre">TraceVector</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">convergence</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ConvergenceSettings</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.14)"><span class="pre">tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference internal" href="_mfv2d.html#mfv2d._mfv2d.DenseVector" title="mfv2d._mfv2d.DenseVector"><span class="pre">DenseVector</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="_mfv2d.html#mfv2d._mfv2d.TraceVector" title="mfv2d._mfv2d.TraceVector"><span class="pre">TraceVector</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><span class="pre">float</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/mfv2d/solving.html#solve_gmres_iterative"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mfv2d.solving.solve_gmres_iterative" title="Link to this definition">#</a></dt>
<dd><p>Solve the system using GMRES.</p>
</dd></dl>

</section>
<section id="cg">
<h3>CG<a class="headerlink" href="#cg" title="Link to this heading">#</a></h3>
<p>Conjugate gradient is the optimal method for symmetric positive definite (SPD)
matrices. Unfortunately, mixed problems (mixed Poisson, Navier-Stokes) give
rise to indefinete problems, which means that CG will likely terminate due to
the degeneration of the Krylov subspace.</p>
<dl class="py function">
<dt class="sig sig-object py" id="mfv2d.solving.solve_cg_iterative">
<span class="sig-prename descclassname"><span class="pre">mfv2d.solving.</span></span><span class="sig-name descname"><span class="pre">solve_cg_iterative</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">system</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#mfv2d.solving.LinearSystem" title="mfv2d.solving.LinearSystem"><span class="pre">LinearSystem</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">rhs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="_mfv2d.html#mfv2d._mfv2d.DenseVector" title="mfv2d._mfv2d.DenseVector"><span class="pre">DenseVector</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">constraints</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="_mfv2d.html#mfv2d._mfv2d.TraceVector" title="mfv2d._mfv2d.TraceVector"><span class="pre">TraceVector</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">convergence</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ConvergenceSettings</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.14)"><span class="pre">tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference internal" href="_mfv2d.html#mfv2d._mfv2d.DenseVector" title="mfv2d._mfv2d.DenseVector"><span class="pre">DenseVector</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="_mfv2d.html#mfv2d._mfv2d.TraceVector" title="mfv2d._mfv2d.TraceVector"><span class="pre">TraceVector</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><span class="pre">float</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/mfv2d/solving.html#solve_cg_iterative"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mfv2d.solving.solve_cg_iterative" title="Link to this definition">#</a></dt>
<dd><p>Solve the system using CG.</p>
</dd></dl>

</section>
<section id="pcg">
<h3>PCG<a class="headerlink" href="#pcg" title="Link to this heading">#</a></h3>
<p>Preconditioned conjugate gradient can deal with the problems of CG solver
by applying a preconditioner to the system. This allows for both faster
convergence and nicer behavior with indefinete systems. It uses block-Jacobi
preconditioner.</p>
<dl class="py function">
<dt class="sig sig-object py" id="mfv2d.solving.solve_pcg_iterative">
<span class="sig-prename descclassname"><span class="pre">mfv2d.solving.</span></span><span class="sig-name descname"><span class="pre">solve_pcg_iterative</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">system</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#mfv2d.solving.LinearSystem" title="mfv2d.solving.LinearSystem"><span class="pre">LinearSystem</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">rhs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="_mfv2d.html#mfv2d._mfv2d.DenseVector" title="mfv2d._mfv2d.DenseVector"><span class="pre">DenseVector</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">constraints</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="_mfv2d.html#mfv2d._mfv2d.TraceVector" title="mfv2d._mfv2d.TraceVector"><span class="pre">TraceVector</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">convergence</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ConvergenceSettings</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.14)"><span class="pre">tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference internal" href="_mfv2d.html#mfv2d._mfv2d.DenseVector" title="mfv2d._mfv2d.DenseVector"><span class="pre">DenseVector</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="_mfv2d.html#mfv2d._mfv2d.TraceVector" title="mfv2d._mfv2d.TraceVector"><span class="pre">TraceVector</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><span class="pre">float</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/mfv2d/solving.html#solve_pcg_iterative"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mfv2d.solving.solve_pcg_iterative" title="Link to this definition">#</a></dt>
<dd><p>Solve the system using preconditioned CG.</p>
</dd></dl>

</section>
<section id="schur-s-complement">
<h3>Schur’s Complement<a class="headerlink" href="#schur-s-complement" title="Link to this heading">#</a></h3>
<p>Schur’s complement is the best performing solver I have written thus far.
The idea is to use Gaussian eleimination to obtain the system for Lagrange
multipliers using the equation <a class="reference internal" href="#equation-eq-schur-complement-1">(1)</a>, where
<span class="math notranslate nohighlight">\(\vec{\lambda}\)</span> are the Lagrange multipliers, <span class="math notranslate nohighlight">\(\mathbf{N}\)</span>
the matrix that enforces the constraints, <span class="math notranslate nohighlight">\(\mathbf{A}\)</span> the
block diagonal part, and the <span class="math notranslate nohighlight">\(\vec{y}\)</span> and <span class="math notranslate nohighlight">\(\vec{\phi}\)</span>
being the dense and trace forcing respectively.</p>
<p>While the matrix <span class="math notranslate nohighlight">\(\mathbf{N} \mathbf{A}^{-1} \mathbf{N}^T\)</span> is dense,
the is solved iteratively using PCG in a matrix-free manner. This is because
the dense solve would scale with the cube of the degrees of freedom.</p>
<div class="math notranslate nohighlight" id="equation-eq-schur-complement-1">
<span class="eqno">(1)<a class="headerlink" href="#equation-eq-schur-complement-1" title="Link to this equation">#</a></span>\[\mathbf{N} \mathbf{A}^{-1} \mathbf{N}^T \vec{\lambda} = \mathbf{N} \mathbf{A}^{-1} \vec{y} - \phi\]</div>
</section>
</section>
</section>


                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="solve_system.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">solve_system</p>
      </div>
    </a>
    <a class="right-next"
       href="system.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">system</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#support-types">Support Types</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mfv2d.solving.LinearSystem"><code class="docutils literal notranslate"><span class="pre">LinearSystem</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#mfv2d.solving.LinearSystem.__new__"><code class="docutils literal notranslate"><span class="pre">LinearSystem.__new__()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#mfv2d.solving.LinearSystem.apply_diagonal"><code class="docutils literal notranslate"><span class="pre">LinearSystem.apply_diagonal()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#mfv2d.solving.LinearSystem.apply_diagonal_inverse"><code class="docutils literal notranslate"><span class="pre">LinearSystem.apply_diagonal_inverse()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#mfv2d.solving.LinearSystem.apply_full_trace_system"><code class="docutils literal notranslate"><span class="pre">LinearSystem.apply_full_trace_system()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#mfv2d.solving.LinearSystem.apply_trace"><code class="docutils literal notranslate"><span class="pre">LinearSystem.apply_trace()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#mfv2d.solving.LinearSystem.apply_trace_transpose"><code class="docutils literal notranslate"><span class="pre">LinearSystem.apply_trace_transpose()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#mfv2d.solving.LinearSystem.combined_system_matrix"><code class="docutils literal notranslate"><span class="pre">LinearSystem.combined_system_matrix()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#mfv2d.solving.LinearSystem.get_constraint_blocks"><code class="docutils literal notranslate"><span class="pre">LinearSystem.get_constraint_blocks()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#mfv2d.solving.LinearSystem.get_dense_blocks"><code class="docutils literal notranslate"><span class="pre">LinearSystem.get_dense_blocks()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mfv2d.solving.FullVector"><code class="docutils literal notranslate"><span class="pre">FullVector</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#mfv2d.solving.FullVector.__post_init__"><code class="docutils literal notranslate"><span class="pre">FullVector.__post_init__()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#mfv2d.solving.FullVector.add"><code class="docutils literal notranslate"><span class="pre">FullVector.add()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#mfv2d.solving.FullVector.copy"><code class="docutils literal notranslate"><span class="pre">FullVector.copy()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#mfv2d.solving.FullVector.dense"><code class="docutils literal notranslate"><span class="pre">FullVector.dense</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#mfv2d.solving.FullVector.dot"><code class="docutils literal notranslate"><span class="pre">FullVector.dot()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#mfv2d.solving.FullVector.make_empty"><code class="docutils literal notranslate"><span class="pre">FullVector.make_empty()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#mfv2d.solving.FullVector.scale"><code class="docutils literal notranslate"><span class="pre">FullVector.scale()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#mfv2d.solving.FullVector.set_from"><code class="docutils literal notranslate"><span class="pre">FullVector.set_from()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#mfv2d.solving.FullVector.subtract"><code class="docutils literal notranslate"><span class="pre">FullVector.subtract()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#mfv2d.solving.FullVector.trace"><code class="docutils literal notranslate"><span class="pre">FullVector.trace</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#core-solvers">Core Solvers</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mfv2d.solving.gmres_general"><code class="docutils literal notranslate"><span class="pre">gmres_general()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mfv2d.solving.cg_general"><code class="docutils literal notranslate"><span class="pre">cg_general()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mfv2d.solving.pcg_general"><code class="docutils literal notranslate"><span class="pre">pcg_general()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#system-solvers">System Solvers</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#gmres">GMRES</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#mfv2d.solving.solve_gmres_iterative"><code class="docutils literal notranslate"><span class="pre">solve_gmres_iterative()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cg">CG</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#mfv2d.solving.solve_cg_iterative"><code class="docutils literal notranslate"><span class="pre">solve_cg_iterative()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pcg">PCG</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#mfv2d.solving.solve_pcg_iterative"><code class="docutils literal notranslate"><span class="pre">solve_pcg_iterative()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#schur-s-complement">Schur’s Complement</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Jan Roth
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2025, Jan Roth.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>