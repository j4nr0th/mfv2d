
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>solve_system &#8212; mfv2d  documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=8f2a1f02" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="../_static/jupyter-sphinx.css" />
    <link rel="stylesheet" type="text/css" href="../_static/thebelab.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../_static/doctools.js?v=9bcbadda"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/thebelab-helper.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@jupyter-widgets/html-manager@^1.0.1/dist/embed-amd.js"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'modules/solve_system';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="prev" title="mimetic2d" href="mimetic2d.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search..."
         aria-label="Search..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
  
  
    <p class="title logo__title">mfv2d  documentation</p>
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../basis.html">Mimetic Spectral Elements Method</a></li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="../modules.html">Modules</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="_mfv2d.html">_mfv2d</a></li>
<li class="toctree-l2"><a class="reference internal" href="boundary.html">boundary</a></li>
<li class="toctree-l2"><a class="reference internal" href="element.html">element</a></li>
<li class="toctree-l2"><a class="reference internal" href="eval.html">eval</a></li>
<li class="toctree-l2"><a class="reference internal" href="kform.html">kform</a></li>
<li class="toctree-l2"><a class="reference internal" href="mimetic2d.html">mimetic2d</a></li>
<li class="toctree-l2 current active"><a class="current reference internal" href="#">solve_system</a></li>
</ul>
</details></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/modules/solve_system.rst" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.rst</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>solve_system</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#computing-the-explicit-terms">Computing the Explicit Terms</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mfv2d.solve_system.compute_element_rhs"><code class="docutils literal notranslate"><span class="pre">compute_element_rhs()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mfv2d.solve_system._extract_rhs_2d"><code class="docutils literal notranslate"><span class="pre">_extract_rhs_2d()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mfv2d.solve_system.rhs_2d_element_projection"><code class="docutils literal notranslate"><span class="pre">rhs_2d_element_projection()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#lagrange-multipliers-and-constraints">Lagrange Multipliers and Constraints</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mfv2d.solve_system.ElementConstraint"><code class="docutils literal notranslate"><span class="pre">ElementConstraint</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#mfv2d.solve_system.ElementConstraint.coeffs"><code class="docutils literal notranslate"><span class="pre">ElementConstraint.coeffs</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#mfv2d.solve_system.ElementConstraint.dofs"><code class="docutils literal notranslate"><span class="pre">ElementConstraint.dofs</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#mfv2d.solve_system.ElementConstraint.i_e"><code class="docutils literal notranslate"><span class="pre">ElementConstraint.i_e</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mfv2d.solve_system.Constraint"><code class="docutils literal notranslate"><span class="pre">Constraint</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#mfv2d.solve_system.Constraint.element_constraints"><code class="docutils literal notranslate"><span class="pre">Constraint.element_constraints</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#mfv2d.solve_system.Constraint.rhs"><code class="docutils literal notranslate"><span class="pre">Constraint.rhs</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#continuity">Continuity</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mfv2d.solve_system.continuity_matrices"><code class="docutils literal notranslate"><span class="pre">continuity_matrices()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mfv2d.solve_system._continuity_element_1_forms"><code class="docutils literal notranslate"><span class="pre">_continuity_element_1_forms()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mfv2d.solve_system._continuity_element_0_forms_inner"><code class="docutils literal notranslate"><span class="pre">_continuity_element_0_forms_inner()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mfv2d.solve_system._continuity_element_0_forms_corner"><code class="docutils literal notranslate"><span class="pre">_continuity_element_0_forms_corner()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mfv2d.solve_system.continuity_child_matrices"><code class="docutils literal notranslate"><span class="pre">continuity_child_matrices()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mfv2d.solve_system._continuity_parent_child_nodes"><code class="docutils literal notranslate"><span class="pre">_continuity_parent_child_nodes()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mfv2d.solve_system._continuity_parent_child_edges"><code class="docutils literal notranslate"><span class="pre">_continuity_parent_child_edges()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mfv2d.solve_system._parent_child_equations"><code class="docutils literal notranslate"><span class="pre">_parent_child_equations()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#matrix-assembly">Matrix Assembly</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mfv2d.solve_system.assemble_matrix"><code class="docutils literal notranslate"><span class="pre">assemble_matrix()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mfv2d.solve_system._compute_element_matrix"><code class="docutils literal notranslate"><span class="pre">_compute_element_matrix()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#vector-assembly">Vector Assembly</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mfv2d.solve_system.assemble_vector"><code class="docutils literal notranslate"><span class="pre">assemble_vector()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mfv2d.solve_system._compute_element_vector"><code class="docutils literal notranslate"><span class="pre">_compute_element_vector()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#forcing-assembly">Forcing Assembly</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mfv2d.solve_system.assemble_forcing"><code class="docutils literal notranslate"><span class="pre">assemble_forcing()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mfv2d.solve_system._compute_element_forcing"><code class="docutils literal notranslate"><span class="pre">_compute_element_forcing()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#global-continuity">Global Continuity</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mfv2d.solve_system.mesh_continuity_constraints"><code class="docutils literal notranslate"><span class="pre">mesh_continuity_constraints()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mfv2d.solve_system._top_level_continuity_0"><code class="docutils literal notranslate"><span class="pre">_top_level_continuity_0()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mfv2d.solve_system._top_level_continuity_1"><code class="docutils literal notranslate"><span class="pre">_top_level_continuity_1()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#boundary-conditions">Boundary Conditions</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mfv2d.solve_system.mesh_boundary_conditions"><code class="docutils literal notranslate"><span class="pre">mesh_boundary_conditions()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mfv2d.solve_system._element_weak_boundary_condition"><code class="docutils literal notranslate"><span class="pre">_element_weak_boundary_condition()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mfv2d.solve_system._element_strong_boundary_condition"><code class="docutils literal notranslate"><span class="pre">_element_strong_boundary_condition()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#global-reconstruction">Global Reconstruction</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mfv2d.solve_system.reconstruct_mesh_from_solution"><code class="docutils literal notranslate"><span class="pre">reconstruct_mesh_from_solution()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#time-march-support">Time March Support</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mfv2d.solve_system.extract_carry"><code class="docutils literal notranslate"><span class="pre">extract_carry()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mfv2d.solve_system._extract_time_carry"><code class="docutils literal notranslate"><span class="pre">_extract_time_carry()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mfv2d.solve_system.find_time_carry_indices"><code class="docutils literal notranslate"><span class="pre">find_time_carry_indices()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#leaf-calculations">Leaf Calculations</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mfv2d.solve_system.compute_leaf_matrix"><code class="docutils literal notranslate"><span class="pre">compute_leaf_matrix()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mfv2d.solve_system.compute_leaf_vector"><code class="docutils literal notranslate"><span class="pre">compute_leaf_vector()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mfv2d.solve_system.compute_element_vector_fields_nonlin"><code class="docutils literal notranslate"><span class="pre">compute_element_vector_fields_nonlin()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mfv2d.solve_system.compute_element_vector_fields"><code class="docutils literal notranslate"><span class="pre">compute_element_vector_fields()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-actual-solver">The Actual Solver</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mfv2d.solve_system.non_linear_solve_run"><code class="docutils literal notranslate"><span class="pre">non_linear_solve_run()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#solver-settings">Solver Settings</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#mfv2d.solve_system.SystemSettings"><code class="docutils literal notranslate"><span class="pre">SystemSettings</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#mfv2d.solve_system.SystemSettings.boundary_conditions"><code class="docutils literal notranslate"><span class="pre">SystemSettings.boundary_conditions</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#mfv2d.solve_system.SystemSettings.constrained_forms"><code class="docutils literal notranslate"><span class="pre">SystemSettings.constrained_forms</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#mfv2d.solve_system.SystemSettings.initial_conditions"><code class="docutils literal notranslate"><span class="pre">SystemSettings.initial_conditions</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#mfv2d.solve_system.SystemSettings.system"><code class="docutils literal notranslate"><span class="pre">SystemSettings.system</span></code></a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#mfv2d.solve_system.SolverSettings"><code class="docutils literal notranslate"><span class="pre">SolverSettings</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#mfv2d.solve_system.SolverSettings.absolute_tolerance"><code class="docutils literal notranslate"><span class="pre">SolverSettings.absolute_tolerance</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#mfv2d.solve_system.SolverSettings.maximum_iterations"><code class="docutils literal notranslate"><span class="pre">SolverSettings.maximum_iterations</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#mfv2d.solve_system.SolverSettings.relative_tolerance"><code class="docutils literal notranslate"><span class="pre">SolverSettings.relative_tolerance</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#mfv2d.solve_system.SolverSettings.relaxation"><code class="docutils literal notranslate"><span class="pre">SolverSettings.relaxation</span></code></a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#mfv2d.solve_system.RefinementSettings"><code class="docutils literal notranslate"><span class="pre">RefinementSettings</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#mfv2d.solve_system.RefinementSettings.division_function"><code class="docutils literal notranslate"><span class="pre">RefinementSettings.division_function()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#mfv2d.solve_system.RefinementSettings.division_predicate"><code class="docutils literal notranslate"><span class="pre">RefinementSettings.division_predicate</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#mfv2d.solve_system.RefinementSettings.refinement_levels"><code class="docutils literal notranslate"><span class="pre">RefinementSettings.refinement_levels</span></code></a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#mfv2d.solve_system.TimeSettings"><code class="docutils literal notranslate"><span class="pre">TimeSettings</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#mfv2d.solve_system.TimeSettings.dt"><code class="docutils literal notranslate"><span class="pre">TimeSettings.dt</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#mfv2d.solve_system.TimeSettings.nt"><code class="docutils literal notranslate"><span class="pre">TimeSettings.nt</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#mfv2d.solve_system.TimeSettings.sample_rate"><code class="docutils literal notranslate"><span class="pre">TimeSettings.sample_rate</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#mfv2d.solve_system.TimeSettings.time_march_relations"><code class="docutils literal notranslate"><span class="pre">TimeSettings.time_march_relations</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#solver-statistics">Solver Statistics</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#mfv2d.solve_system.SolutionStatistics"><code class="docutils literal notranslate"><span class="pre">SolutionStatistics</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#mfv2d.solve_system.SolutionStatistics.element_orders"><code class="docutils literal notranslate"><span class="pre">SolutionStatistics.element_orders</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#mfv2d.solve_system.SolutionStatistics.iter_history"><code class="docutils literal notranslate"><span class="pre">SolutionStatistics.iter_history</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#mfv2d.solve_system.SolutionStatistics.n_elems"><code class="docutils literal notranslate"><span class="pre">SolutionStatistics.n_elems</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#mfv2d.solve_system.SolutionStatistics.n_lagrange"><code class="docutils literal notranslate"><span class="pre">SolutionStatistics.n_lagrange</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#mfv2d.solve_system.SolutionStatistics.n_leaf_dofs"><code class="docutils literal notranslate"><span class="pre">SolutionStatistics.n_leaf_dofs</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#mfv2d.solve_system.SolutionStatistics.n_leaves"><code class="docutils literal notranslate"><span class="pre">SolutionStatistics.n_leaves</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#mfv2d.solve_system.SolutionStatistics.n_total_dofs"><code class="docutils literal notranslate"><span class="pre">SolutionStatistics.n_total_dofs</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#mfv2d.solve_system.SolutionStatistics.residual_history"><code class="docutils literal notranslate"><span class="pre">SolutionStatistics.residual_history</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="solve-system">
<h1>solve_system<a class="headerlink" href="#solve-system" title="Link to this heading">#</a></h1>
<p>This submodule contains all the basic building blocks which are needed to
create the solver in <code class="xref py py-mod docutils literal notranslate"><span class="pre">mfv2d.solve_system_2d</span></code>. Some of these should
be replaced or removed, as they are outdated, but it works for now.</p>
<section id="computing-the-explicit-terms">
<h2>Computing the Explicit Terms<a class="headerlink" href="#computing-the-explicit-terms" title="Link to this heading">#</a></h2>
<p>To compute <a class="reference internal" href="kform.html#mfv2d.kform.KExplicit" title="mfv2d.kform.KExplicit"><code class="xref py py-class docutils literal notranslate"><span class="pre">mfv2d.kform.KExplicit</span></code></a> terms of the
<a class="reference internal" href="kform.html#mfv2d.kform.KFormSystem" title="mfv2d.kform.KFormSystem"><code class="xref py py-class docutils literal notranslate"><span class="pre">mfv2d.kform.KFormSystem</span></code></a> the function <a class="reference internal" href="#mfv2d.solve_system.compute_element_rhs" title="mfv2d.solve_system.compute_element_rhs"><code class="xref py py-func docutils literal notranslate"><span class="pre">compute_element_rhs()</span></code></a>
is used, which is to be passed to <a class="reference internal" href="element.html#mfv2d.element.call_per_leaf_flex" title="mfv2d.element.call_per_leaf_flex"><code class="xref py py-func docutils literal notranslate"><span class="pre">mfv2d.element.call_per_leaf_flex()</span></code></a>
to compute forcing terms. Under the hood it just calls <a class="reference internal" href="#mfv2d.solve_system._extract_rhs_2d" title="mfv2d.solve_system._extract_rhs_2d"><code class="xref py py-func docutils literal notranslate"><span class="pre">_extract_rhs_2d()</span></code></a>
for each element and then joins them together. This function in turn calls
<a class="reference internal" href="#mfv2d.solve_system.rhs_2d_element_projection" title="mfv2d.solve_system.rhs_2d_element_projection"><code class="xref py py-func docutils literal notranslate"><span class="pre">rhs_2d_element_projection()</span></code></a>, since boundary projections are evaluated
separately.</p>
<dl class="py function">
<dt class="sig sig-object py" id="mfv2d.solve_system.compute_element_rhs">
<span class="sig-prename descclassname"><span class="pre">mfv2d.solve_system.</span></span><span class="sig-name descname"><span class="pre">compute_element_rhs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ie</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">system</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="kform.html#mfv2d.kform.KFormSystem" title="mfv2d.kform.KFormSystem"><span class="pre">KFormSystem</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">basis_cache</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="mimetic2d.html#mfv2d.mimetic2d.FemCache" title="mfv2d.mimetic2d.FemCache"><span class="pre">FemCache</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">orders</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="element.html#mfv2d.element.FixedElementArray" title="mfv2d.element.FixedElementArray"><span class="pre">FixedElementArray</span></a><span class="p"><span class="pre">[</span></span><span class="pre">uint32</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">corners</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="element.html#mfv2d.element.FixedElementArray" title="mfv2d.element.FixedElementArray"><span class="pre">FixedElementArray</span></a><span class="p"><span class="pre">[</span></span><span class="pre">float64</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><span class="pre">ndarray</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><span class="pre">tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.13)"><span class="pre">Any</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.dtype.html#numpy.dtype" title="(in NumPy v2.3)"><span class="pre">dtype</span></a><span class="p"><span class="pre">[</span></span><span class="pre">float64</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/mfv2d/solve_system.html#compute_element_rhs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mfv2d.solve_system.compute_element_rhs" title="Link to this definition">#</a></dt>
<dd><p>Compute rhs for an element.</p>
<p>This basically means just concatenating the projections of the functions on the
element for each of the equations in the system.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ie</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – Index of the element.
TODO: REPLACE WITH JUST ORDERS AND BASIS</p></li>
<li><p><strong>system</strong> (<a class="reference internal" href="kform.html#mfv2d.kform.KFormSystem" title="mfv2d.kform.KFormSystem"><em>KFormSystem</em></a>) – System for which to compute the rhs.</p></li>
<li><p><strong>basis_cache</strong> (<a class="reference internal" href="mimetic2d.html#mfv2d.mimetic2d.FemCache" title="mfv2d.mimetic2d.FemCache"><em>FemCache</em></a>) – Cache from which to get the basis from.</p></li>
<li><p><strong>orders</strong> (<a class="reference internal" href="element.html#mfv2d.element.FixedElementArray" title="mfv2d.element.FixedElementArray"><em>FixedElementArray</em></a><em>[</em><em>np.uint32</em><em>]</em>) – Array with orders of the elements.</p></li>
<li><p><strong>corners</strong> (<a class="reference internal" href="element.html#mfv2d.element.FixedElementArray" title="mfv2d.element.FixedElementArray"><em>FixedElementArray</em></a><em>[</em><em>np.float64</em><em>]</em>) – Array with corners of the elements.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Array with the resulting rhs.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>array</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="mfv2d.solve_system._extract_rhs_2d">
<span class="sig-prename descclassname"><span class="pre">mfv2d.solve_system.</span></span><span class="sig-name descname"><span class="pre">_extract_rhs_2d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">proj</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Sequence" title="(in Python v3.13)"><span class="pre">Sequence</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><span class="pre">tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><span class="pre">float</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="kform.html#mfv2d.kform.KExplicit" title="mfv2d.kform.KExplicit"><span class="pre">KExplicit</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="kform.html#mfv2d.kform.KWeight" title="mfv2d.kform.KWeight"><span class="pre">KWeight</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">corners</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><span class="pre">ndarray</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><span class="pre">tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.13)"><span class="pre">Any</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.dtype.html#numpy.dtype" title="(in NumPy v2.3)"><span class="pre">dtype</span></a><span class="p"><span class="pre">[</span></span><span class="pre">float64</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">basis</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Basis2D</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><span class="pre">ndarray</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><span class="pre">tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.13)"><span class="pre">Any</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.dtype.html#numpy.dtype" title="(in NumPy v2.3)"><span class="pre">dtype</span></a><span class="p"><span class="pre">[</span></span><span class="pre">float64</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/mfv2d/solve_system.html#_extract_rhs_2d"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mfv2d.solve_system._extract_rhs_2d" title="Link to this definition">#</a></dt>
<dd><p>Extract the rhs resulting from element projections.</p>
<p>Combines the sequence of <code class="xref py py-class docutils literal notranslate"><span class="pre">KExplicit</span></code> terms together.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>proj</strong> (<em>Sequence</em><em> of </em><em>(</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a><em>, </em><a class="reference internal" href="kform.html#mfv2d.kform.KExplicit" title="mfv2d.kform.KExplicit"><em>KExplicit</em></a><em>)</em>) – Sequence of projections to compute.</p></li>
<li><p><strong>weight</strong> (<a class="reference internal" href="kform.html#mfv2d.kform.KWeight" title="mfv2d.kform.KWeight"><em>KWeight</em></a>) – Weight form used for these projections.</p></li>
<li><p><strong>corners</strong> (<em>(</em><em>4</em><em>, </em><em>2</em><em>) </em><em>array</em>) – Array of corners of the element.</p></li>
<li><p><strong>basis</strong> (<em>Basis2D</em>) – Basis to use for computing the projection.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Array of the resulting projection degrees of freedom.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>array</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="mfv2d.solve_system.rhs_2d_element_projection">
<span class="sig-prename descclassname"><span class="pre">mfv2d.solve_system.</span></span><span class="sig-name descname"><span class="pre">rhs_2d_element_projection</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">right</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="kform.html#mfv2d.kform.KElementProjection" title="mfv2d.kform.KElementProjection"><span class="pre">KElementProjection</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">corners</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><span class="pre">ndarray</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><span class="pre">tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.13)"><span class="pre">Any</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.dtype.html#numpy.dtype" title="(in NumPy v2.3)"><span class="pre">dtype</span></a><span class="p"><span class="pre">[</span></span><span class="pre">float64</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">basis</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Basis2D</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><span class="pre">ndarray</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><span class="pre">tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.13)"><span class="pre">Any</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.dtype.html#numpy.dtype" title="(in NumPy v2.3)"><span class="pre">dtype</span></a><span class="p"><span class="pre">[</span></span><span class="pre">float64</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/mfv2d/solve_system.html#rhs_2d_element_projection"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mfv2d.solve_system.rhs_2d_element_projection" title="Link to this definition">#</a></dt>
<dd><p>Evaluate the differential form projections on the 1D element.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>right</strong> (<a class="reference internal" href="kform.html#mfv2d.kform.KElementProjection" title="mfv2d.kform.KElementProjection"><em>KElementProjection</em></a>) – The projection of a function on the element.</p></li>
<li><p><strong>corners</strong> (<em>(</em><em>4</em><em>, </em><em>2</em><em>) </em><em>array</em>) – Array with corners of the element.</p></li>
<li><p><strong>basis</strong> (<em>Basis2D</em>) – Basis to use for computing the projection.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The resulting projection vector.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>array of <code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.float64</span></code></p>
</dd>
</dl>
</dd></dl>

</section>
<section id="lagrange-multipliers-and-constraints">
<h2>Lagrange Multipliers and Constraints<a class="headerlink" href="#lagrange-multipliers-and-constraints" title="Link to this heading">#</a></h2>
<p>Since continuity and strong boundary conditions are enforced throught
Lagrange multipliers, there are types to represent these relations
efficiently. The base building block is the
<a class="reference internal" href="#mfv2d.solve_system.ElementConstraint" title="mfv2d.solve_system.ElementConstraint"><code class="xref py py-class docutils literal notranslate"><span class="pre">ElementConstraint</span></code></a> type, which describes the degrees of
freedom and coefficients involved in a specific constraint. These
may then be combined into <a class="reference internal" href="#mfv2d.solve_system.Constraint" title="mfv2d.solve_system.Constraint"><code class="xref py py-class docutils literal notranslate"><span class="pre">Constraint</span></code></a> type which associates
one or more <a class="reference internal" href="#mfv2d.solve_system.ElementConstraint" title="mfv2d.solve_system.ElementConstraint"><code class="xref py py-class docutils literal notranslate"><span class="pre">ElementConstraint</span></code></a> with their right hand side value.</p>
<p>Note that <a class="reference internal" href="#mfv2d.solve_system.ElementConstraint" title="mfv2d.solve_system.ElementConstraint"><code class="xref py py-class docutils literal notranslate"><span class="pre">ElementConstraint</span></code></a> are also used to convey weak boundary
condition information, however, in that case the coefficients in the
<a class="reference internal" href="#mfv2d.solve_system.ElementConstraint" title="mfv2d.solve_system.ElementConstraint"><code class="xref py py-class docutils literal notranslate"><span class="pre">ElementConstraint</span></code></a> object represent contributions to the right
hand side.</p>
<dl class="py class">
<dt class="sig sig-object py" id="mfv2d.solve_system.ElementConstraint">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mfv2d.solve_system.</span></span><span class="sig-name descname"><span class="pre">ElementConstraint</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">i_e</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">dofs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><span class="pre">ndarray</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><span class="pre">tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.13)"><span class="pre">Any</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.dtype.html#numpy.dtype" title="(in NumPy v2.3)"><span class="pre">dtype</span></a><span class="p"><span class="pre">[</span></span><span class="pre">uint32</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coeffs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><span class="pre">ndarray</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><span class="pre">tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.13)"><span class="pre">Any</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.dtype.html#numpy.dtype" title="(in NumPy v2.3)"><span class="pre">dtype</span></a><span class="p"><span class="pre">[</span></span><span class="pre">float64</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mfv2d/solve_system.html#ElementConstraint"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mfv2d.solve_system.ElementConstraint" title="Link to this definition">#</a></dt>
<dd><p>Type intended to enforce a constraint on an element.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>i_e</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – Index of the element for which this constraint is applied.</p></li>
<li><p><strong>dofs</strong> (<em>(</em><em>n</em><em>,</em><em>) </em><em>array</em>) – Array with indices of the degrees of freedom of the element involved.</p></li>
<li><p><strong>coeffs</strong> (<em>(</em><em>n</em><em>,</em><em>) </em><em>array</em>) – Array with coefficients of degrees of freedom of the element involved.</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="mfv2d.solve_system.ElementConstraint.coeffs">
<span class="sig-name descname"><span class="pre">coeffs</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><span class="pre">ndarray</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><span class="pre">tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.13)"><span class="pre">Any</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.dtype.html#numpy.dtype" title="(in NumPy v2.3)"><span class="pre">dtype</span></a><span class="p"><span class="pre">[</span></span><span class="pre">float64</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#mfv2d.solve_system.ElementConstraint.coeffs" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="mfv2d.solve_system.ElementConstraint.dofs">
<span class="sig-name descname"><span class="pre">dofs</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><span class="pre">ndarray</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><span class="pre">tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.13)"><span class="pre">Any</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.dtype.html#numpy.dtype" title="(in NumPy v2.3)"><span class="pre">dtype</span></a><span class="p"><span class="pre">[</span></span><span class="pre">uint32</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#mfv2d.solve_system.ElementConstraint.dofs" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="mfv2d.solve_system.ElementConstraint.i_e">
<span class="sig-name descname"><span class="pre">i_e</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></em><a class="headerlink" href="#mfv2d.solve_system.ElementConstraint.i_e" title="Link to this definition">#</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mfv2d.solve_system.Constraint">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mfv2d.solve_system.</span></span><span class="sig-name descname"><span class="pre">Constraint</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rhs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><span class="pre">float</span></a></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">element_constraints</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#mfv2d.solve_system.ElementConstraint" title="mfv2d.solve_system.ElementConstraint"><span class="pre">ElementConstraint</span></a></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mfv2d/solve_system.html#Constraint"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mfv2d.solve_system.Constraint" title="Link to this definition">#</a></dt>
<dd><p>Type used to specify constraints on degrees of freedom.</p>
<p>This type combines the individual <a class="reference internal" href="#mfv2d.solve_system.ElementConstraint" title="mfv2d.solve_system.ElementConstraint"><code class="xref py py-class docutils literal notranslate"><span class="pre">ElementConstraint</span></code></a> together
with a right-hand side of the constraint.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rhs</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – The right-hand side of the constraint.</p></li>
<li><p><strong>*element_constraints</strong> (<a class="reference internal" href="#mfv2d.solve_system.ElementConstraint" title="mfv2d.solve_system.ElementConstraint"><em>ElementConstraint</em></a>) – Constraints to combine together.</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="mfv2d.solve_system.Constraint.element_constraints">
<span class="sig-name descname"><span class="pre">element_constraints</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><span class="pre">tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#mfv2d.solve_system.ElementConstraint" title="mfv2d.solve_system.ElementConstraint"><span class="pre">ElementConstraint</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#mfv2d.solve_system.Constraint.element_constraints" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="mfv2d.solve_system.Constraint.rhs">
<span class="sig-name descname"><span class="pre">rhs</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><span class="pre">float</span></a></em><a class="headerlink" href="#mfv2d.solve_system.Constraint.rhs" title="Link to this definition">#</a></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="continuity">
<h2>Continuity<a class="headerlink" href="#continuity" title="Link to this heading">#</a></h2>
<p>Continuity between elements is enforced throught creating <a class="reference internal" href="#mfv2d.solve_system.Constraint" title="mfv2d.solve_system.Constraint"><code class="xref py py-class docutils literal notranslate"><span class="pre">Constraint</span></code></a>
values. Since continuity may be between elements which have different orders
on the edge where they border one another, the coefficients in these
constraints may not be ones and zeros. As such, there is a function
<a class="reference internal" href="#mfv2d.solve_system.continuity_matrices" title="mfv2d.solve_system.continuity_matrices"><code class="xref py py-func docutils literal notranslate"><span class="pre">continuity_matrices()</span></code></a>, which returns a matrix with coefficients
that can be used for these relations. It uses Python’s
<a class="reference external" href="https://docs.python.org/3/library/functools.html#functools.cache" title="(in Python v3.13)"><code class="xref py py-func docutils literal notranslate"><span class="pre">functools.cache()</span></code></a> annotation, so calling it repetedly should not be
slow.</p>
<dl class="py function">
<dt class="sig sig-object py" id="mfv2d.solve_system.continuity_matrices">
<span class="sig-prename descclassname"><span class="pre">mfv2d.solve_system.</span></span><span class="sig-name descname"><span class="pre">continuity_matrices</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n1</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">n2</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><span class="pre">tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><span class="pre">ndarray</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><span class="pre">tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.13)"><span class="pre">Any</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.dtype.html#numpy.dtype" title="(in NumPy v2.3)"><span class="pre">dtype</span></a><span class="p"><span class="pre">[</span></span><span class="pre">float64</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><span class="pre">ndarray</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><span class="pre">tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.13)"><span class="pre">Any</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.dtype.html#numpy.dtype" title="(in NumPy v2.3)"><span class="pre">dtype</span></a><span class="p"><span class="pre">[</span></span><span class="pre">float64</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/mfv2d/solve_system.html#continuity_matrices"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mfv2d.solve_system.continuity_matrices" title="Link to this definition">#</a></dt>
<dd><p>Compute continuity equation coefficients for 0 and 1 forms between elements.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n1</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – Higher order.</p></li>
<li><p><strong>n2</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – Lower order.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><em>(n1 + 1, n2 + 1) array</em> – Array of coefficients for 0-form continuity.</p></li>
<li><p><em>(n1, n2) array</em> – Array of coefficients for 1-form continuity.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<p>The internal functions used to generate these relations are
<a class="reference internal" href="#mfv2d.solve_system._continuity_element_1_forms" title="mfv2d.solve_system._continuity_element_1_forms"><code class="xref py py-func docutils literal notranslate"><span class="pre">_continuity_element_1_forms()</span></code></a>, <a class="reference internal" href="#mfv2d.solve_system._continuity_element_0_forms_inner" title="mfv2d.solve_system._continuity_element_0_forms_inner"><code class="xref py py-func docutils literal notranslate"><span class="pre">_continuity_element_0_forms_inner()</span></code></a>,
and <a class="reference internal" href="#mfv2d.solve_system._continuity_element_0_forms_corner" title="mfv2d.solve_system._continuity_element_0_forms_corner"><code class="xref py py-func docutils literal notranslate"><span class="pre">_continuity_element_0_forms_corner()</span></code></a>, which are used by other
functions.</p>
<dl class="py function">
<dt class="sig sig-object py" id="mfv2d.solve_system._continuity_element_1_forms">
<span class="sig-prename descclassname"><span class="pre">mfv2d.solve_system.</span></span><span class="sig-name descname"><span class="pre">_continuity_element_1_forms</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">unknown_ordering</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">UnknownOrderings</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">elements</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="element.html#mfv2d.element.ElementCollection" title="mfv2d.element.ElementCollection"><span class="pre">ElementCollection</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">dof_offsets</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="element.html#mfv2d.element.FixedElementArray" title="mfv2d.element.FixedElementArray"><span class="pre">FixedElementArray</span></a><span class="p"><span class="pre">[</span></span><span class="pre">uint32</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">e_other</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">e_self</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">side_other</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ElementSide</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">side_self</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ElementSide</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><span class="pre">tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#mfv2d.solve_system.Constraint" title="mfv2d.solve_system.Constraint"><span class="pre">Constraint</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/mfv2d/solve_system.html#_continuity_element_1_forms"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mfv2d.solve_system._continuity_element_1_forms" title="Link to this definition">#</a></dt>
<dd><p>Generate equations for 1-form continuity between elements.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>List of constraint equations, which enforce continuity of 1 forms.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)">tuple</a> of <a class="reference internal" href="#mfv2d.solve_system.Constraint" title="mfv2d.solve_system.Constraint">Constraint</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="mfv2d.solve_system._continuity_element_0_forms_inner">
<span class="sig-prename descclassname"><span class="pre">mfv2d.solve_system.</span></span><span class="sig-name descname"><span class="pre">_continuity_element_0_forms_inner</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">unknown_ordering</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">UnknownOrderings</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">elements</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="element.html#mfv2d.element.ElementCollection" title="mfv2d.element.ElementCollection"><span class="pre">ElementCollection</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">dof_offsets</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="element.html#mfv2d.element.FixedElementArray" title="mfv2d.element.FixedElementArray"><span class="pre">FixedElementArray</span></a><span class="p"><span class="pre">[</span></span><span class="pre">uint32</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">e_other</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">e_self</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">side_other</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ElementSide</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">side_self</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ElementSide</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><span class="pre">tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#mfv2d.solve_system.Constraint" title="mfv2d.solve_system.Constraint"><span class="pre">Constraint</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/mfv2d/solve_system.html#_continuity_element_0_forms_inner"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mfv2d.solve_system._continuity_element_0_forms_inner" title="Link to this definition">#</a></dt>
<dd><p>Generate equations for 0-form continuity between elements.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>List of constraint equations, which enforce continuity of 0 forms.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)">tuple</a> of <a class="reference internal" href="#mfv2d.solve_system.Constraint" title="mfv2d.solve_system.Constraint">Constraint</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="mfv2d.solve_system._continuity_element_0_forms_corner">
<span class="sig-prename descclassname"><span class="pre">mfv2d.solve_system.</span></span><span class="sig-name descname"><span class="pre">_continuity_element_0_forms_corner</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">unknown_ordering</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">UnknownOrderings</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">elements</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="element.html#mfv2d.element.ElementCollection" title="mfv2d.element.ElementCollection"><span class="pre">ElementCollection</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">dof_offsets</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="element.html#mfv2d.element.FixedElementArray" title="mfv2d.element.FixedElementArray"><span class="pre">FixedElementArray</span></a><span class="p"><span class="pre">[</span></span><span class="pre">uint32</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">e_other</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">e_self</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">side_other</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ElementSide</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">side_self</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ElementSide</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><span class="pre">tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#mfv2d.solve_system.Constraint" title="mfv2d.solve_system.Constraint"><span class="pre">Constraint</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/mfv2d/solve_system.html#_continuity_element_0_forms_corner"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mfv2d.solve_system._continuity_element_0_forms_corner" title="Link to this definition">#</a></dt>
<dd><p>Generate equations for 0-form continuity between elements.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>List of constraint equations, which enforce continuity of 0 forms.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)">tuple</a> of <a class="reference internal" href="#mfv2d.solve_system.Constraint" title="mfv2d.solve_system.Constraint">Constraint</a></p>
</dd>
</dl>
</dd></dl>

<p>Another function which is used to generate continuity coefficients is
<a class="reference internal" href="#mfv2d.solve_system.continuity_child_matrices" title="mfv2d.solve_system.continuity_child_matrices"><code class="xref py py-func docutils literal notranslate"><span class="pre">continuity_child_matrices()</span></code></a>. This is used for continuity between
elements.</p>
<dl class="py function">
<dt class="sig sig-object py" id="mfv2d.solve_system.continuity_child_matrices">
<span class="sig-prename descclassname"><span class="pre">mfv2d.solve_system.</span></span><span class="sig-name descname"><span class="pre">continuity_child_matrices</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nchild</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">nparent</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><span class="pre">tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><span class="pre">ndarray</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><span class="pre">tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.13)"><span class="pre">Any</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.dtype.html#numpy.dtype" title="(in NumPy v2.3)"><span class="pre">dtype</span></a><span class="p"><span class="pre">[</span></span><span class="pre">float64</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><span class="pre">ndarray</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><span class="pre">tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.13)"><span class="pre">Any</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.dtype.html#numpy.dtype" title="(in NumPy v2.3)"><span class="pre">dtype</span></a><span class="p"><span class="pre">[</span></span><span class="pre">float64</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/mfv2d/solve_system.html#continuity_child_matrices"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mfv2d.solve_system.continuity_child_matrices" title="Link to this definition">#</a></dt>
<dd><p>Compute continuity equation coefficients for 0 and 1 forms between elements.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>nc</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – Child’s order.</p></li>
<li><p><strong>nparent</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – Parent’s order.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><em>(nc + 1, np + 1) array</em> – Array of coefficients for 0-form continuity.</p></li>
<li><p><em>(nc, np) array</em> – Array of coefficients for 1-form continuity.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<p>These are then in turn used by <a class="reference internal" href="#mfv2d.solve_system._continuity_parent_child_nodes" title="mfv2d.solve_system._continuity_parent_child_nodes"><code class="xref py py-func docutils literal notranslate"><span class="pre">_continuity_parent_child_nodes()</span></code></a>
and <a class="reference internal" href="#mfv2d.solve_system._continuity_parent_child_edges" title="mfv2d.solve_system._continuity_parent_child_edges"><code class="xref py py-func docutils literal notranslate"><span class="pre">_continuity_parent_child_edges()</span></code></a>, which generate equations for
parent-child continuity of 0- and 1-forms respectively. Together they
are wrapped in the <a class="reference internal" href="#mfv2d.solve_system._parent_child_equations" title="mfv2d.solve_system._parent_child_equations"><code class="xref py py-func docutils literal notranslate"><span class="pre">_parent_child_equations()</span></code></a> function.</p>
<dl class="py function">
<dt class="sig sig-object py" id="mfv2d.solve_system._continuity_parent_child_nodes">
<span class="sig-prename descclassname"><span class="pre">mfv2d.solve_system.</span></span><span class="sig-name descname"><span class="pre">_continuity_parent_child_nodes</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">unknown_orders</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">UnknownOrderings</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">elements</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="element.html#mfv2d.element.ElementCollection" title="mfv2d.element.ElementCollection"><span class="pre">ElementCollection</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">dof_offsets</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="element.html#mfv2d.element.FixedElementArray" title="mfv2d.element.FixedElementArray"><span class="pre">FixedElementArray</span></a><span class="p"><span class="pre">[</span></span><span class="pre">uint32</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">e_parent</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">e_child</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">side</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ElementSide</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flipped</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><span class="pre">bool</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><span class="pre">tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#mfv2d.solve_system.Constraint" title="mfv2d.solve_system.Constraint"><span class="pre">Constraint</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/mfv2d/solve_system.html#_continuity_parent_child_nodes"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mfv2d.solve_system._continuity_parent_child_nodes" title="Link to this definition">#</a></dt>
<dd><p>Connect parent and child element boundaries.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>unknown_orders</strong> (<em>UnknownOrderings</em>) – Orders of all unknown differential forms.</p></li>
<li><p><strong>e_parent</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – Parent element.</p></li>
<li><p><strong>e_child</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – Child element.</p></li>
<li><p><strong>side</strong> (<em>ElementSide</em>) – Index of the boundary which is to be connected.</p></li>
<li><p><strong>flipped</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a>) – Determines if the child is on the second half of the boundary instead of the
first. This in practice means that coefficients in equations must be flipped.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Equations which enforce continuity of the 0-forms on the boundary of a parent and
a child.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)">tuple</a> of <a class="reference internal" href="#mfv2d.solve_system.Constraint" title="mfv2d.solve_system.Constraint">Constraint</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="mfv2d.solve_system._continuity_parent_child_edges">
<span class="sig-prename descclassname"><span class="pre">mfv2d.solve_system.</span></span><span class="sig-name descname"><span class="pre">_continuity_parent_child_edges</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">unknown_orders</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">UnknownOrderings</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">elements</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="element.html#mfv2d.element.ElementCollection" title="mfv2d.element.ElementCollection"><span class="pre">ElementCollection</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">dof_offsets</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="element.html#mfv2d.element.FixedElementArray" title="mfv2d.element.FixedElementArray"><span class="pre">FixedElementArray</span></a><span class="p"><span class="pre">[</span></span><span class="pre">uint32</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">e_parent</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">e_child</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">side</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ElementSide</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flipped</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><span class="pre">bool</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><span class="pre">tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#mfv2d.solve_system.Constraint" title="mfv2d.solve_system.Constraint"><span class="pre">Constraint</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/mfv2d/solve_system.html#_continuity_parent_child_edges"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mfv2d.solve_system._continuity_parent_child_edges" title="Link to this definition">#</a></dt>
<dd><p>Connect parent and child element boundaries.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>unknown_orders</strong> (<em>UnknownOrderings</em>) – Orders of all unknown differential forms.</p></li>
<li><p><strong>e_parent</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – Parent element.</p></li>
<li><p><strong>e_child</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – Child element.</p></li>
<li><p><strong>side</strong> (<em>ElementSide</em>) – Index of the boundary which is to be connected.</p></li>
<li><p><strong>flipped</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a>) – Determines if the child is on the second half of the boundary instead of the
first. This in practice means that coefficients in equations must be flipped.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Equations which enforce continuity of the 1-forms on the boundary of a parent and
a child.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)">tuple</a> of <a class="reference internal" href="#mfv2d.solve_system.Constraint" title="mfv2d.solve_system.Constraint">Constraint</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="mfv2d.solve_system._parent_child_equations">
<span class="sig-prename descclassname"><span class="pre">mfv2d.solve_system.</span></span><span class="sig-name descname"><span class="pre">_parent_child_equations</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">unknown_ordering</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">UnknownOrderings</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">elements</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="element.html#mfv2d.element.ElementCollection" title="mfv2d.element.ElementCollection"><span class="pre">ElementCollection</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">dof_offsets</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="element.html#mfv2d.element.FixedElementArray" title="mfv2d.element.FixedElementArray"><span class="pre">FixedElementArray</span></a><span class="p"><span class="pre">[</span></span><span class="pre">uint32</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ie</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">child_bl</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">child_br</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">child_tr</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">child_tl</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><span class="pre">tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#mfv2d.solve_system.Constraint" title="mfv2d.solve_system.Constraint"><span class="pre">Constraint</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/mfv2d/solve_system.html#_parent_child_equations"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mfv2d.solve_system._parent_child_equations" title="Link to this definition">#</a></dt>
<dd><p>Create constraint equations for the parent-child and child-child continuity.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>unknown_ordering</strong> (<em>UnknownOrderings</em>) – Order of unknown differential forms.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Tuple of the constraint equations which ensure continuity between these elements.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)">tuple</a> of <a class="reference internal" href="#mfv2d.solve_system.Constraint" title="mfv2d.solve_system.Constraint">Constraint</a></p>
</dd>
</dl>
</dd></dl>

</section>
<section id="matrix-assembly">
<h2>Matrix Assembly<a class="headerlink" href="#matrix-assembly" title="Link to this heading">#</a></h2>
<p>Global system matrix is created by <a class="reference internal" href="#mfv2d.solve_system.assemble_matrix" title="mfv2d.solve_system.assemble_matrix"><code class="xref py py-func docutils literal notranslate"><span class="pre">assemble_matrix()</span></code></a>, which creates
individual root element matrices. These are created by calling
<a class="reference internal" href="#mfv2d.solve_system._compute_element_matrix" title="mfv2d.solve_system._compute_element_matrix"><code class="xref py py-func docutils literal notranslate"><span class="pre">_compute_element_matrix()</span></code></a>, which recursevly collect child element
matrices and adds Lagrange multipliers resulting from continuity between
children and parent.</p>
<dl class="py function">
<dt class="sig sig-object py" id="mfv2d.solve_system.assemble_matrix">
<span class="sig-prename descclassname"><span class="pre">mfv2d.solve_system.</span></span><span class="sig-name descname"><span class="pre">assemble_matrix</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">unknown_ordering</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">UnknownOrderings</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">collection</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="element.html#mfv2d.element.ElementCollection" title="mfv2d.element.ElementCollection"><span class="pre">ElementCollection</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">dof_offsets_array</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="element.html#mfv2d.element.FixedElementArray" title="mfv2d.element.FixedElementArray"><span class="pre">FixedElementArray</span></a><span class="p"><span class="pre">[</span></span><span class="pre">uint32</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">leaf_matrices</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="element.html#mfv2d.element.FlexibleElementArray" title="mfv2d.element.FlexibleElementArray"><span class="pre">FlexibleElementArray</span></a><span class="p"><span class="pre">[</span></span><span class="pre">float64</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">uint32</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.sparse.csr_array.html#scipy.sparse.csr_array" title="(in SciPy v1.15.3)"><span class="pre">csr_array</span></a></span></span><a class="reference internal" href="../_modules/mfv2d/solve_system.html#assemble_matrix"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mfv2d.solve_system.assemble_matrix" title="Link to this definition">#</a></dt>
<dd><p>Assemble global matrix.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="mfv2d.solve_system._compute_element_matrix">
<span class="sig-prename descclassname"><span class="pre">mfv2d.solve_system.</span></span><span class="sig-name descname"><span class="pre">_compute_element_matrix</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">unknown_ordering</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">UnknownOrderings</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">collection</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="element.html#mfv2d.element.ElementCollection" title="mfv2d.element.ElementCollection"><span class="pre">ElementCollection</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">ie</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">dof_offsets_array</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="element.html#mfv2d.element.FixedElementArray" title="mfv2d.element.FixedElementArray"><span class="pre">FixedElementArray</span></a><span class="p"><span class="pre">[</span></span><span class="pre">uint32</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">leaf_matrices</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="element.html#mfv2d.element.FlexibleElementArray" title="mfv2d.element.FlexibleElementArray"><span class="pre">FlexibleElementArray</span></a><span class="p"><span class="pre">[</span></span><span class="pre">float64</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">uint32</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">elements</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="element.html#mfv2d.element.ElementCollection" title="mfv2d.element.ElementCollection"><span class="pre">ElementCollection</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.sparse.csr_array.html#scipy.sparse.csr_array" title="(in SciPy v1.15.3)"><span class="pre">csr_array</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><span class="pre">ndarray</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><span class="pre">tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.13)"><span class="pre">Any</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.dtype.html#numpy.dtype" title="(in NumPy v2.3)"><span class="pre">dtype</span></a><span class="p"><span class="pre">[</span></span><span class="pre">float64</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/mfv2d/solve_system.html#_compute_element_matrix"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mfv2d.solve_system._compute_element_matrix" title="Link to this definition">#</a></dt>
<dd><p>Compute matrix for a top level element.</p>
</dd></dl>

</section>
<section id="vector-assembly">
<h2>Vector Assembly<a class="headerlink" href="#vector-assembly" title="Link to this heading">#</a></h2>
<p>Global system vector is similarly created by <a class="reference internal" href="#mfv2d.solve_system.assemble_vector" title="mfv2d.solve_system.assemble_vector"><code class="xref py py-func docutils literal notranslate"><span class="pre">assemble_vector()</span></code></a>. It creates
individual root element vectors by by calling <a class="reference internal" href="#mfv2d.solve_system._compute_element_vector" title="mfv2d.solve_system._compute_element_vector"><code class="xref py py-func docutils literal notranslate"><span class="pre">_compute_element_vector()</span></code></a>,
which recursevly collect child element matrices and padds to account for
Lagrange multipliers resulting from continuity between children and parent.</p>
<dl class="py function">
<dt class="sig sig-object py" id="mfv2d.solve_system.assemble_vector">
<span class="sig-prename descclassname"><span class="pre">mfv2d.solve_system.</span></span><span class="sig-name descname"><span class="pre">assemble_vector</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">unknown_ordering</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">UnknownOrderings</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">collection</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="element.html#mfv2d.element.ElementCollection" title="mfv2d.element.ElementCollection"><span class="pre">ElementCollection</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">dof_offsets_array</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="element.html#mfv2d.element.FixedElementArray" title="mfv2d.element.FixedElementArray"><span class="pre">FixedElementArray</span></a><span class="p"><span class="pre">[</span></span><span class="pre">uint32</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lagrange_dof_count_array</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="element.html#mfv2d.element.FixedElementArray" title="mfv2d.element.FixedElementArray"><span class="pre">FixedElementArray</span></a><span class="p"><span class="pre">[</span></span><span class="pre">uint32</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">leaf_vectors</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="element.html#mfv2d.element.FlexibleElementArray" title="mfv2d.element.FlexibleElementArray"><span class="pre">FlexibleElementArray</span></a><span class="p"><span class="pre">[</span></span><span class="pre">float64</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">uint32</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><span class="pre">ndarray</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><span class="pre">tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.13)"><span class="pre">Any</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.dtype.html#numpy.dtype" title="(in NumPy v2.3)"><span class="pre">dtype</span></a><span class="p"><span class="pre">[</span></span><span class="pre">float64</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/mfv2d/solve_system.html#assemble_vector"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mfv2d.solve_system.assemble_vector" title="Link to this definition">#</a></dt>
<dd><p>Assemble global vector.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="mfv2d.solve_system._compute_element_vector">
<span class="sig-prename descclassname"><span class="pre">mfv2d.solve_system.</span></span><span class="sig-name descname"><span class="pre">_compute_element_vector</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">unknown_ordering</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">UnknownOrderings</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">collection</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="element.html#mfv2d.element.ElementCollection" title="mfv2d.element.ElementCollection"><span class="pre">ElementCollection</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">ie</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">dof_offsets_array</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="element.html#mfv2d.element.FixedElementArray" title="mfv2d.element.FixedElementArray"><span class="pre">FixedElementArray</span></a><span class="p"><span class="pre">[</span></span><span class="pre">uint32</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lagrange_dof_count_array</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="element.html#mfv2d.element.FixedElementArray" title="mfv2d.element.FixedElementArray"><span class="pre">FixedElementArray</span></a><span class="p"><span class="pre">[</span></span><span class="pre">uint32</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">leaf_vectors</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="element.html#mfv2d.element.FlexibleElementArray" title="mfv2d.element.FlexibleElementArray"><span class="pre">FlexibleElementArray</span></a><span class="p"><span class="pre">[</span></span><span class="pre">float64</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">uint32</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><span class="pre">ndarray</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><span class="pre">tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.13)"><span class="pre">Any</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.dtype.html#numpy.dtype" title="(in NumPy v2.3)"><span class="pre">dtype</span></a><span class="p"><span class="pre">[</span></span><span class="pre">float64</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/mfv2d/solve_system.html#_compute_element_vector"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mfv2d.solve_system._compute_element_vector" title="Link to this definition">#</a></dt>
<dd><p>Compute matrix for a top level element.</p>
</dd></dl>

</section>
<section id="forcing-assembly">
<h2>Forcing Assembly<a class="headerlink" href="#forcing-assembly" title="Link to this heading">#</a></h2>
<p>Last of the assembly routines is the <a class="reference internal" href="#mfv2d.solve_system.assemble_forcing" title="mfv2d.solve_system.assemble_forcing"><code class="xref py py-func docutils literal notranslate"><span class="pre">assemble_forcing()</span></code></a> function. This
computes root element forcing (value of the given expression given solution)
by recursivly calling <a class="reference internal" href="#mfv2d.solve_system._compute_element_forcing" title="mfv2d.solve_system._compute_element_forcing"><code class="xref py py-func docutils literal notranslate"><span class="pre">_compute_element_forcing()</span></code></a>, then adding values
resulting from Lagrange multiplier relations.</p>
<dl class="py function">
<dt class="sig sig-object py" id="mfv2d.solve_system.assemble_forcing">
<span class="sig-prename descclassname"><span class="pre">mfv2d.solve_system.</span></span><span class="sig-name descname"><span class="pre">assemble_forcing</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">unknown_ordering</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">UnknownOrderings</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">collection</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="element.html#mfv2d.element.ElementCollection" title="mfv2d.element.ElementCollection"><span class="pre">ElementCollection</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">dof_offsets_array</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="element.html#mfv2d.element.FixedElementArray" title="mfv2d.element.FixedElementArray"><span class="pre">FixedElementArray</span></a><span class="p"><span class="pre">[</span></span><span class="pre">uint32</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">leaf_vectors</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="element.html#mfv2d.element.FlexibleElementArray" title="mfv2d.element.FlexibleElementArray"><span class="pre">FlexibleElementArray</span></a><span class="p"><span class="pre">[</span></span><span class="pre">float64</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">uint32</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">solution</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="element.html#mfv2d.element.FlexibleElementArray" title="mfv2d.element.FlexibleElementArray"><span class="pre">FlexibleElementArray</span></a><span class="p"><span class="pre">[</span></span><span class="pre">float64</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">uint32</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><span class="pre">ndarray</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><span class="pre">tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.13)"><span class="pre">Any</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.dtype.html#numpy.dtype" title="(in NumPy v2.3)"><span class="pre">dtype</span></a><span class="p"><span class="pre">[</span></span><span class="pre">float64</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/mfv2d/solve_system.html#assemble_forcing"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mfv2d.solve_system.assemble_forcing" title="Link to this definition">#</a></dt>
<dd><p>Assemble global vector.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="mfv2d.solve_system._compute_element_forcing">
<span class="sig-prename descclassname"><span class="pre">mfv2d.solve_system.</span></span><span class="sig-name descname"><span class="pre">_compute_element_forcing</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">unknown_ordering</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">UnknownOrderings</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">collection</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="element.html#mfv2d.element.ElementCollection" title="mfv2d.element.ElementCollection"><span class="pre">ElementCollection</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">ie</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">dof_offsets_array</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="element.html#mfv2d.element.FixedElementArray" title="mfv2d.element.FixedElementArray"><span class="pre">FixedElementArray</span></a><span class="p"><span class="pre">[</span></span><span class="pre">uint32</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">leaf_vectors</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="element.html#mfv2d.element.FlexibleElementArray" title="mfv2d.element.FlexibleElementArray"><span class="pre">FlexibleElementArray</span></a><span class="p"><span class="pre">[</span></span><span class="pre">float64</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">uint32</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">solution</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="element.html#mfv2d.element.FlexibleElementArray" title="mfv2d.element.FlexibleElementArray"><span class="pre">FlexibleElementArray</span></a><span class="p"><span class="pre">[</span></span><span class="pre">float64</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">uint32</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><span class="pre">ndarray</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><span class="pre">tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.13)"><span class="pre">Any</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.dtype.html#numpy.dtype" title="(in NumPy v2.3)"><span class="pre">dtype</span></a><span class="p"><span class="pre">[</span></span><span class="pre">float64</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/mfv2d/solve_system.html#_compute_element_forcing"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mfv2d.solve_system._compute_element_forcing" title="Link to this definition">#</a></dt>
<dd><p>Compute forcing for an element.</p>
</dd></dl>

</section>
<section id="global-continuity">
<h2>Global Continuity<a class="headerlink" href="#global-continuity" title="Link to this heading">#</a></h2>
<p>For generating the continuity <a class="reference internal" href="#mfv2d.solve_system.Constraint" title="mfv2d.solve_system.Constraint"><code class="xref py py-class docutils literal notranslate"><span class="pre">Constraint</span></code></a> values for global
continuity, the function
<a class="reference internal" href="#mfv2d.solve_system.mesh_continuity_constraints" title="mfv2d.solve_system.mesh_continuity_constraints"><code class="xref py py-func docutils literal notranslate"><span class="pre">mesh_continuity_constraints()</span></code></a> is used. It uses quite a few
helper functions, such as <a class="reference internal" href="#mfv2d.solve_system._top_level_continuity_0" title="mfv2d.solve_system._top_level_continuity_0"><code class="xref py py-func docutils literal notranslate"><span class="pre">_top_level_continuity_0()</span></code></a> for generating
top level continuity of 0-forms and <a class="reference internal" href="#mfv2d.solve_system._top_level_continuity_1" title="mfv2d.solve_system._top_level_continuity_1"><code class="xref py py-func docutils literal notranslate"><span class="pre">_top_level_continuity_1()</span></code></a> for
1-form continuity.</p>
<dl class="py function">
<dt class="sig sig-object py" id="mfv2d.solve_system.mesh_continuity_constraints">
<span class="sig-prename descclassname"><span class="pre">mfv2d.solve_system.</span></span><span class="sig-name descname"><span class="pre">mesh_continuity_constraints</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">system</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="kform.html#mfv2d.kform.KFormSystem" title="mfv2d.kform.KFormSystem"><span class="pre">KFormSystem</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">mesh</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="mimetic2d.html#mfv2d.mimetic2d.Mesh2D" title="mfv2d.mimetic2d.Mesh2D"><span class="pre">Mesh2D</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">top_indices</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><span class="pre">ndarray</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><span class="pre">tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.13)"><span class="pre">Any</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.dtype.html#numpy.dtype" title="(in NumPy v2.3)"><span class="pre">dtype</span></a><span class="p"><span class="pre">[</span></span><span class="pre">uint32</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">unknown_orders</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">UnknownOrderings</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">elements</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="element.html#mfv2d.element.ElementCollection" title="mfv2d.element.ElementCollection"><span class="pre">ElementCollection</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">only_first_order</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><span class="pre">bool</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">dof_offsets</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="element.html#mfv2d.element.FixedElementArray" title="mfv2d.element.FixedElementArray"><span class="pre">FixedElementArray</span></a><span class="p"><span class="pre">[</span></span><span class="pre">uint32</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><span class="pre">tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#mfv2d.solve_system.Constraint" title="mfv2d.solve_system.Constraint"><span class="pre">Constraint</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/mfv2d/solve_system.html#mesh_continuity_constraints"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mfv2d.solve_system.mesh_continuity_constraints" title="Link to this definition">#</a></dt>
<dd><p>Return the boundary conditions system.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="mfv2d.solve_system._top_level_continuity_0">
<span class="sig-prename descclassname"><span class="pre">mfv2d.solve_system.</span></span><span class="sig-name descname"><span class="pre">_top_level_continuity_0</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mesh</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="mimetic2d.html#mfv2d.mimetic2d.Mesh2D" title="mfv2d.mimetic2d.Mesh2D"><span class="pre">Mesh2D</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">top_indices</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><span class="pre">ndarray</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><span class="pre">tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.13)"><span class="pre">Any</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.dtype.html#numpy.dtype" title="(in NumPy v2.3)"><span class="pre">dtype</span></a><span class="p"><span class="pre">[</span></span><span class="pre">uint32</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">elements</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="element.html#mfv2d.element.ElementCollection" title="mfv2d.element.ElementCollection"><span class="pre">ElementCollection</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">unknown_orders</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">UnknownOrderings</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">only_first_order</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><span class="pre">bool</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">dof_offsets</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="element.html#mfv2d.element.FixedElementArray" title="mfv2d.element.FixedElementArray"><span class="pre">FixedElementArray</span></a><span class="p"><span class="pre">[</span></span><span class="pre">uint32</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><span class="pre">list</span></a><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#mfv2d.solve_system.Constraint" title="mfv2d.solve_system.Constraint"><span class="pre">Constraint</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/mfv2d/solve_system.html#_top_level_continuity_0"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mfv2d.solve_system._top_level_continuity_0" title="Link to this definition">#</a></dt>
<dd><p>Create equations enforcing 0-form continuity between top level elements.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="mfv2d.solve_system._top_level_continuity_1">
<span class="sig-prename descclassname"><span class="pre">mfv2d.solve_system.</span></span><span class="sig-name descname"><span class="pre">_top_level_continuity_1</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mesh</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="mimetic2d.html#mfv2d.mimetic2d.Mesh2D" title="mfv2d.mimetic2d.Mesh2D"><span class="pre">Mesh2D</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">top_indices</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><span class="pre">ndarray</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><span class="pre">tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.13)"><span class="pre">Any</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.dtype.html#numpy.dtype" title="(in NumPy v2.3)"><span class="pre">dtype</span></a><span class="p"><span class="pre">[</span></span><span class="pre">uint32</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">elements</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="element.html#mfv2d.element.ElementCollection" title="mfv2d.element.ElementCollection"><span class="pre">ElementCollection</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">unknown_orders</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">UnknownOrderings</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dof_offsets</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="element.html#mfv2d.element.FixedElementArray" title="mfv2d.element.FixedElementArray"><span class="pre">FixedElementArray</span></a><span class="p"><span class="pre">[</span></span><span class="pre">uint32</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><span class="pre">list</span></a><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#mfv2d.solve_system.Constraint" title="mfv2d.solve_system.Constraint"><span class="pre">Constraint</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/mfv2d/solve_system.html#_top_level_continuity_1"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mfv2d.solve_system._top_level_continuity_1" title="Link to this definition">#</a></dt>
<dd><p>Create equations enforcing 1-form continuity between top level elements.</p>
</dd></dl>

</section>
<section id="boundary-conditions">
<h2>Boundary Conditions<a class="headerlink" href="#boundary-conditions" title="Link to this heading">#</a></h2>
<p>For generating the boundary condtition <a class="reference internal" href="#mfv2d.solve_system.Constraint" title="mfv2d.solve_system.Constraint"><code class="xref py py-class docutils literal notranslate"><span class="pre">Constraint</span></code></a> and
<a class="reference internal" href="#mfv2d.solve_system.ElementConstraint" title="mfv2d.solve_system.ElementConstraint"><code class="xref py py-class docutils literal notranslate"><span class="pre">ElementConstraint</span></code></a> values, the function
<a class="reference internal" href="#mfv2d.solve_system.mesh_boundary_conditions" title="mfv2d.solve_system.mesh_boundary_conditions"><code class="xref py py-func docutils literal notranslate"><span class="pre">mesh_boundary_conditions()</span></code></a> is used, which returns the strong and
weak boundary condition results.</p>
<p>Internally it calls <a class="reference internal" href="#mfv2d.solve_system._element_weak_boundary_condition" title="mfv2d.solve_system._element_weak_boundary_condition"><code class="xref py py-func docutils literal notranslate"><span class="pre">_element_weak_boundary_condition()</span></code></a> and
<a class="reference internal" href="#mfv2d.solve_system._element_strong_boundary_condition" title="mfv2d.solve_system._element_strong_boundary_condition"><code class="xref py py-func docutils literal notranslate"><span class="pre">_element_strong_boundary_condition()</span></code></a> for each boundary edge
and element, depending on which (if any) is specified on that edge.</p>
<dl class="py function">
<dt class="sig sig-object py" id="mfv2d.solve_system.mesh_boundary_conditions">
<span class="sig-prename descclassname"><span class="pre">mfv2d.solve_system.</span></span><span class="sig-name descname"><span class="pre">mesh_boundary_conditions</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">evaluatable_terms</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Sequence" title="(in Python v3.13)"><span class="pre">Sequence</span></a><span class="p"><span class="pre">[</span></span><a class="reference internal" href="kform.html#mfv2d.kform.KSum" title="mfv2d.kform.KSum"><span class="pre">KSum</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mesh</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="mimetic2d.html#mfv2d.mimetic2d.Mesh2D" title="mfv2d.mimetic2d.Mesh2D"><span class="pre">Mesh2D</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">unknown_order</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">UnknownOrderings</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">elements</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="element.html#mfv2d.element.ElementCollection" title="mfv2d.element.ElementCollection"><span class="pre">ElementCollection</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">dof_offsets</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="element.html#mfv2d.element.FixedElementArray" title="mfv2d.element.FixedElementArray"><span class="pre">FixedElementArray</span></a><span class="p"><span class="pre">[</span></span><span class="pre">uint32</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">top_indices</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><span class="pre">ndarray</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><span class="pre">tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.13)"><span class="pre">Any</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.dtype.html#numpy.dtype" title="(in NumPy v2.3)"><span class="pre">dtype</span></a><span class="p"><span class="pre">[</span></span><span class="pre">uint32</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">strong_bcs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Sequence" title="(in Python v3.13)"><span class="pre">Sequence</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Sequence" title="(in Python v3.13)"><span class="pre">Sequence</span></a><span class="p"><span class="pre">[</span></span><a class="reference internal" href="boundary.html#mfv2d.boundary.BoundaryCondition2DSteady" title="mfv2d.boundary.BoundaryCondition2DSteady"><span class="pre">BoundaryCondition2DSteady</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cache_1d</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="mimetic2d.html#mfv2d.mimetic2d.FemCache" title="mfv2d.mimetic2d.FemCache"><span class="pre">FemCache</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><span class="pre">tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><span class="pre">tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#mfv2d.solve_system.ElementConstraint" title="mfv2d.solve_system.ElementConstraint"><span class="pre">ElementConstraint</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><span class="pre">tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#mfv2d.solve_system.ElementConstraint" title="mfv2d.solve_system.ElementConstraint"><span class="pre">ElementConstraint</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/mfv2d/solve_system.html#mesh_boundary_conditions"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mfv2d.solve_system.mesh_boundary_conditions" title="Link to this definition">#</a></dt>
<dd><p>Compute boundary condition contributions and constraints.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>evaluatable_terms</strong> (<em>Sequence</em><em> of </em><a class="reference internal" href="kform.html#mfv2d.kform.KSum" title="mfv2d.kform.KSum"><em>KSum</em></a>) – Right sides of equations that contain boundary projections to be evaluated. Must
be ordered according to weights.</p></li>
<li><p><strong>mesh</strong> (<a class="reference internal" href="mimetic2d.html#mfv2d.mimetic2d.Mesh2D" title="mfv2d.mimetic2d.Mesh2D"><em>Mesh2D</em></a>) – Mesh of the top level elements.</p></li>
<li><p><strong>unknown_order</strong> (<em>UnknownOrderings</em>) – Orders of unknown forms.</p></li>
<li><p><strong>elements</strong> (<a class="reference internal" href="element.html#mfv2d.element.ElementCollection" title="mfv2d.element.ElementCollection"><em>ElementCollection</em></a>) – Collection of elements to use.</p></li>
<li><p><strong>dof_offsets</strong> (<a class="reference internal" href="element.html#mfv2d.element.FixedElementArray" title="mfv2d.element.FixedElementArray"><em>FixedElementArray</em></a><em>[</em><em>np.uint32</em><em>]</em>) – Offsets of DoFs within each element.</p></li>
<li><p><strong>top_indices</strong> (<em>npt.NDArray</em><em>[</em><em>np.uint32</em><em>]</em>) – Array with corrected indices for top level elements.</p></li>
<li><p><strong>strong_bcs</strong> (<em>Sequence</em><em> of </em><em>Sequence</em><em> of </em><a class="reference internal" href="boundary.html#mfv2d.boundary.BoundaryCondition2DSteady" title="mfv2d.boundary.BoundaryCondition2DSteady"><em>BoundaryCondition2DSteady</em></a>) – Boundary conditions grouped per weight functions and correctly ordered to match
the order of weight functions in the system.</p></li>
<li><p><strong>caches</strong> (<em>MutableMapping</em><em> of </em><em>(</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>, </em><em>BasisCache</em><em>)</em>) – Caches which can be used and appended to.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><em>tuple of ElementConstraint</em> – Strong boundary conditions in a specific notation. Each of these means
that for element given by <code class="docutils literal notranslate"><span class="pre">ElementConstraint.i_e</span></code>, all dofs with
indices <code class="docutils literal notranslate"><span class="pre">ElementConstraint.dofs</span></code> should be constrained to value
<code class="docutils literal notranslate"><span class="pre">ElementConstraint.coeffs</span></code>.</p></li>
<li><p><em>tuple of ElementConstraint</em> – Weak boundary conditions in a specific notation. Each of these means
that for element given by <code class="docutils literal notranslate"><span class="pre">ElementConstraint.i_e</span></code>, all equations with
indices <code class="docutils literal notranslate"><span class="pre">ElementConstraint.dofs</span></code> should have the value
<code class="docutils literal notranslate"><span class="pre">ElementConstraint.coeffs</span></code> added to them.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="mfv2d.solve_system._element_weak_boundary_condition">
<span class="sig-prename descclassname"><span class="pre">mfv2d.solve_system.</span></span><span class="sig-name descname"><span class="pre">_element_weak_boundary_condition</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">elements</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="element.html#mfv2d.element.ElementCollection" title="mfv2d.element.ElementCollection"><span class="pre">ElementCollection</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">ie</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">side</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ElementSide</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">unknown_orders</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">UnknownOrderings</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">unknown_index</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">dof_offsets</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="element.html#mfv2d.element.FixedElementArray" title="mfv2d.element.FixedElementArray"><span class="pre">FixedElementArray</span></a><span class="p"><span class="pre">[</span></span><span class="pre">uint32</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weak_terms</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Sequence" title="(in Python v3.13)"><span class="pre">Sequence</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><span class="pre">tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><span class="pre">float</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="kform.html#mfv2d.kform.KBoundaryProjection" title="mfv2d.kform.KBoundaryProjection"><span class="pre">KBoundaryProjection</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cache_1d</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="mimetic2d.html#mfv2d.mimetic2d.FemCache" title="mfv2d.mimetic2d.FemCache"><span class="pre">FemCache</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><span class="pre">tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#mfv2d.solve_system.ElementConstraint" title="mfv2d.solve_system.ElementConstraint"><span class="pre">ElementConstraint</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/mfv2d/solve_system.html#_element_weak_boundary_condition"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mfv2d.solve_system._element_weak_boundary_condition" title="Link to this definition">#</a></dt>
<dd><p>Determine boundary conditions given an element and a side.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="mfv2d.solve_system._element_strong_boundary_condition">
<span class="sig-prename descclassname"><span class="pre">mfv2d.solve_system.</span></span><span class="sig-name descname"><span class="pre">_element_strong_boundary_condition</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">elements</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="element.html#mfv2d.element.ElementCollection" title="mfv2d.element.ElementCollection"><span class="pre">ElementCollection</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">ie</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">side</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ElementSide</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">unknown_orders</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">UnknownOrderings</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">unknown_index</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">dof_offsets</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="element.html#mfv2d.element.FixedElementArray" title="mfv2d.element.FixedElementArray"><span class="pre">FixedElementArray</span></a><span class="p"><span class="pre">[</span></span><span class="pre">uint32</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">strong_bc</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="boundary.html#mfv2d.boundary.BoundaryCondition2DSteady" title="mfv2d.boundary.BoundaryCondition2DSteady"><span class="pre">BoundaryCondition2DSteady</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">cache_1d</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="mimetic2d.html#mfv2d.mimetic2d.FemCache" title="mfv2d.mimetic2d.FemCache"><span class="pre">FemCache</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">skip_first</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><span class="pre">bool</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">skip_last</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><span class="pre">bool</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><span class="pre">tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#mfv2d.solve_system.ElementConstraint" title="mfv2d.solve_system.ElementConstraint"><span class="pre">ElementConstraint</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/mfv2d/solve_system.html#_element_strong_boundary_condition"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mfv2d.solve_system._element_strong_boundary_condition" title="Link to this definition">#</a></dt>
<dd><p>Determine boundary conditions given an element and a side.</p>
</dd></dl>

</section>
<section id="global-reconstruction">
<h2>Global Reconstruction<a class="headerlink" href="#global-reconstruction" title="Link to this heading">#</a></h2>
<p>Based on <a class="reference internal" href="element.html#mfv2d.element.reconstruct" title="mfv2d.element.reconstruct"><code class="xref py py-func docutils literal notranslate"><span class="pre">mfv2d.element.reconstruct()</span></code></a> a global reconstruction
of the solution for all leaf elements is implemented with the
<a class="reference internal" href="#mfv2d.solve_system.reconstruct_mesh_from_solution" title="mfv2d.solve_system.reconstruct_mesh_from_solution"><code class="xref py py-func docutils literal notranslate"><span class="pre">reconstruct_mesh_from_solution()</span></code></a> function. It returns a
<a class="reference external" href="https://docs.pyvista.org/api/core/_autosummary/pyvista.UnstructuredGrid.html#pyvista.UnstructuredGrid" title="(in PyVista v0.45.2)"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyvista.UnstructuredGrid</span></code></a>, which can be added to the list
of outputs.</p>
<dl class="py function">
<dt class="sig sig-object py" id="mfv2d.solve_system.reconstruct_mesh_from_solution">
<span class="sig-prename descclassname"><span class="pre">mfv2d.solve_system.</span></span><span class="sig-name descname"><span class="pre">reconstruct_mesh_from_solution</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">system</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="kform.html#mfv2d.kform.KFormSystem" title="mfv2d.kform.KFormSystem"><span class="pre">KFormSystem</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">recon_order</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><span class="pre">None</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">element_collection</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="element.html#mfv2d.element.ElementCollection" title="mfv2d.element.ElementCollection"><span class="pre">ElementCollection</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">caches</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="mimetic2d.html#mfv2d.mimetic2d.FemCache" title="mfv2d.mimetic2d.FemCache"><span class="pre">FemCache</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">dof_offsets</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="element.html#mfv2d.element.FixedElementArray" title="mfv2d.element.FixedElementArray"><span class="pre">FixedElementArray</span></a><span class="p"><span class="pre">[</span></span><span class="pre">uint32</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">solution</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="element.html#mfv2d.element.FlexibleElementArray" title="mfv2d.element.FlexibleElementArray"><span class="pre">FlexibleElementArray</span></a><span class="p"><span class="pre">[</span></span><span class="pre">float64</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">uint32</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.pyvista.org/api/core/_autosummary/pyvista.UnstructuredGrid.html#pyvista.UnstructuredGrid" title="(in PyVista v0.45.2)"><span class="pre">UnstructuredGrid</span></a></span></span><a class="reference internal" href="../_modules/mfv2d/solve_system.html#reconstruct_mesh_from_solution"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mfv2d.solve_system.reconstruct_mesh_from_solution" title="Link to this definition">#</a></dt>
<dd><p>Reconstruct the unknown differential forms.</p>
</dd></dl>

</section>
<section id="time-march-support">
<h2>Time March Support<a class="headerlink" href="#time-march-support" title="Link to this heading">#</a></h2>
<p>Since for time marching certain quantities must be extracted from
the non-constraint equations, supporting functions are provided here. Namely,
<a class="reference internal" href="#mfv2d.solve_system._extract_time_carry" title="mfv2d.solve_system._extract_time_carry"><code class="xref py py-func docutils literal notranslate"><span class="pre">_extract_time_carry()</span></code></a> is called on each element, which
<a class="reference internal" href="#mfv2d.solve_system.extract_carry" title="mfv2d.solve_system.extract_carry"><code class="xref py py-func docutils literal notranslate"><span class="pre">extract_carry()</span></code></a> wraps. To determine what are the indices of degrees
of freedom to carry <a class="reference internal" href="#mfv2d.solve_system.find_time_carry_indices" title="mfv2d.solve_system.find_time_carry_indices"><code class="xref py py-func docutils literal notranslate"><span class="pre">find_time_carry_indices()</span></code></a> is used.</p>
<dl class="py function">
<dt class="sig sig-object py" id="mfv2d.solve_system.extract_carry">
<span class="sig-prename descclassname"><span class="pre">mfv2d.solve_system.</span></span><span class="sig-name descname"><span class="pre">extract_carry</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">element_collection</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="element.html#mfv2d.element.ElementCollection" title="mfv2d.element.ElementCollection"><span class="pre">ElementCollection</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_carry_index_array</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="element.html#mfv2d.element.FlexibleElementArray" title="mfv2d.element.FlexibleElementArray"><span class="pre">FlexibleElementArray</span></a><span class="p"><span class="pre">[</span></span><span class="pre">uint32</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">uint32</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">initial_solution</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="element.html#mfv2d.element.FlexibleElementArray" title="mfv2d.element.FlexibleElementArray"><span class="pre">FlexibleElementArray</span></a><span class="p"><span class="pre">[</span></span><span class="pre">float64</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">uint32</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mfv2d/solve_system.html#extract_carry"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mfv2d.solve_system.extract_carry" title="Link to this definition">#</a></dt>
<dd><p>Extract carry terms from solution.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="mfv2d.solve_system._extract_time_carry">
<span class="sig-prename descclassname"><span class="pre">mfv2d.solve_system.</span></span><span class="sig-name descname"><span class="pre">_extract_time_carry</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ie</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_carry_index_array</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="element.html#mfv2d.element.FlexibleElementArray" title="mfv2d.element.FlexibleElementArray"><span class="pre">FlexibleElementArray</span></a><span class="p"><span class="pre">[</span></span><span class="pre">uint32</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">uint32</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">solution</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="element.html#mfv2d.element.FlexibleElementArray" title="mfv2d.element.FlexibleElementArray"><span class="pre">FlexibleElementArray</span></a><span class="p"><span class="pre">[</span></span><span class="pre">float64</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">uint32</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><span class="pre">ndarray</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><span class="pre">tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.13)"><span class="pre">Any</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.dtype.html#numpy.dtype" title="(in NumPy v2.3)"><span class="pre">dtype</span></a><span class="p"><span class="pre">[</span></span><span class="pre">float64</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/mfv2d/solve_system.html#_extract_time_carry"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mfv2d.solve_system._extract_time_carry" title="Link to this definition">#</a></dt>
<dd><p>Element function for extraction.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="mfv2d.solve_system.find_time_carry_indices">
<span class="sig-prename descclassname"><span class="pre">mfv2d.solve_system.</span></span><span class="sig-name descname"><span class="pre">find_time_carry_indices</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ie</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">unknowns</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Sequence" title="(in Python v3.13)"><span class="pre">Sequence</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dof_offsets</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="element.html#mfv2d.element.FixedElementArray" title="mfv2d.element.FixedElementArray"><span class="pre">FixedElementArray</span></a><span class="p"><span class="pre">[</span></span><span class="pre">uint32</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">child_count_array</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="element.html#mfv2d.element.FixedElementArray" title="mfv2d.element.FixedElementArray"><span class="pre">FixedElementArray</span></a><span class="p"><span class="pre">[</span></span><span class="pre">uint32</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><span class="pre">ndarray</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><span class="pre">tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.13)"><span class="pre">Any</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.dtype.html#numpy.dtype" title="(in NumPy v2.3)"><span class="pre">dtype</span></a><span class="p"><span class="pre">[</span></span><span class="pre">uint32</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/mfv2d/solve_system.html#find_time_carry_indices"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mfv2d.solve_system.find_time_carry_indices" title="Link to this definition">#</a></dt>
<dd><p>Find what are the indices of DoFs that should be carried for the time march.</p>
</dd></dl>

</section>
<section id="leaf-calculations">
<h2>Leaf Calculations<a class="headerlink" href="#leaf-calculations" title="Link to this heading">#</a></h2>
<p>For computing leaf element matrices and forcing, <a class="reference internal" href="#mfv2d.solve_system.compute_leaf_matrix" title="mfv2d.solve_system.compute_leaf_matrix"><code class="xref py py-func docutils literal notranslate"><span class="pre">compute_leaf_matrix()</span></code></a>
and <a class="reference internal" href="#mfv2d.solve_system.compute_leaf_vector" title="mfv2d.solve_system.compute_leaf_vector"><code class="xref py py-func docutils literal notranslate"><span class="pre">compute_leaf_vector()</span></code></a> are available. These pretty much just
coordinate calls to <code class="xref py py-func docutils literal notranslate"><span class="pre">mfv2d._mfv2d.compute_element_matrix()</span></code> and
<code class="xref py py-func docutils literal notranslate"><span class="pre">mfv2d._mfv2d.compute_element_vector()</span></code>.</p>
<dl class="py function">
<dt class="sig sig-object py" id="mfv2d.solve_system.compute_leaf_matrix">
<span class="sig-prename descclassname"><span class="pre">mfv2d.solve_system.</span></span><span class="sig-name descname"><span class="pre">compute_leaf_matrix</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ie</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">expressions</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Sequence" title="(in Python v3.13)"><span class="pre">Sequence</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Sequence" title="(in Python v3.13)"><span class="pre">Sequence</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Sequence" title="(in Python v3.13)"><span class="pre">Sequence</span></a><span class="p"><span class="pre">[</span></span><a class="reference internal" href="eval.html#mfv2d.eval.MatOpCode" title="mfv2d.eval.MatOpCode"><span class="pre">MatOpCode</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><span class="pre">float</span></a><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><span class="pre">None</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">unknowns</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">UnknownOrderings</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">orders</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="element.html#mfv2d.element.FixedElementArray" title="mfv2d.element.FixedElementArray"><span class="pre">FixedElementArray</span></a><span class="p"><span class="pre">[</span></span><span class="pre">uint32</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">basis_cache</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="mimetic2d.html#mfv2d.mimetic2d.FemCache" title="mfv2d.mimetic2d.FemCache"><span class="pre">FemCache</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">corners</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="element.html#mfv2d.element.FixedElementArray" title="mfv2d.element.FixedElementArray"><span class="pre">FixedElementArray</span></a><span class="p"><span class="pre">[</span></span><span class="pre">float64</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fields</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="element.html#mfv2d.element.FixedElementArray" title="mfv2d.element.FixedElementArray"><span class="pre">FixedElementArray</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://numpy.org/doc/stable/reference/arrays.scalars.html#numpy.object_" title="(in NumPy v2.3)"><span class="pre">object_</span></a><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><span class="pre">ndarray</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><span class="pre">tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.13)"><span class="pre">Any</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.dtype.html#numpy.dtype" title="(in NumPy v2.3)"><span class="pre">dtype</span></a><span class="p"><span class="pre">[</span></span><span class="pre">float64</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/mfv2d/solve_system.html#compute_leaf_matrix"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mfv2d.solve_system.compute_leaf_matrix" title="Link to this definition">#</a></dt>
<dd><p>Compute the element matrix.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="mfv2d.solve_system.compute_leaf_vector">
<span class="sig-prename descclassname"><span class="pre">mfv2d.solve_system.</span></span><span class="sig-name descname"><span class="pre">compute_leaf_vector</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ie</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">expressions</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Sequence" title="(in Python v3.13)"><span class="pre">Sequence</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Sequence" title="(in Python v3.13)"><span class="pre">Sequence</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Sequence" title="(in Python v3.13)"><span class="pre">Sequence</span></a><span class="p"><span class="pre">[</span></span><a class="reference internal" href="eval.html#mfv2d.eval.MatOpCode" title="mfv2d.eval.MatOpCode"><span class="pre">MatOpCode</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><span class="pre">float</span></a><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><span class="pre">None</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">unknowns</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">UnknownOrderings</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">orders</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="element.html#mfv2d.element.FixedElementArray" title="mfv2d.element.FixedElementArray"><span class="pre">FixedElementArray</span></a><span class="p"><span class="pre">[</span></span><span class="pre">uint32</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">basis_cache</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="mimetic2d.html#mfv2d.mimetic2d.FemCache" title="mfv2d.mimetic2d.FemCache"><span class="pre">FemCache</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">corners</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="element.html#mfv2d.element.FixedElementArray" title="mfv2d.element.FixedElementArray"><span class="pre">FixedElementArray</span></a><span class="p"><span class="pre">[</span></span><span class="pre">float64</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fields</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="element.html#mfv2d.element.FixedElementArray" title="mfv2d.element.FixedElementArray"><span class="pre">FixedElementArray</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://numpy.org/doc/stable/reference/arrays.scalars.html#numpy.object_" title="(in NumPy v2.3)"><span class="pre">object_</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">solution</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="element.html#mfv2d.element.FlexibleElementArray" title="mfv2d.element.FlexibleElementArray"><span class="pre">FlexibleElementArray</span></a><span class="p"><span class="pre">[</span></span><span class="pre">float64</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">uint32</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><span class="pre">ndarray</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><span class="pre">tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.13)"><span class="pre">Any</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.dtype.html#numpy.dtype" title="(in NumPy v2.3)"><span class="pre">dtype</span></a><span class="p"><span class="pre">[</span></span><span class="pre">float64</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/mfv2d/solve_system.html#compute_leaf_vector"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mfv2d.solve_system.compute_leaf_vector" title="Link to this definition">#</a></dt>
<dd><p>Compute the element vector.</p>
</dd></dl>

<p>Since these also need vector field information for any interior products,
functions to compute are also given:
<a class="reference internal" href="#mfv2d.solve_system.compute_element_vector_fields_nonlin" title="mfv2d.solve_system.compute_element_vector_fields_nonlin"><code class="xref py py-func docutils literal notranslate"><span class="pre">compute_element_vector_fields_nonlin()</span></code></a> and its wrapper
<a class="reference internal" href="#mfv2d.solve_system.compute_element_vector_fields" title="mfv2d.solve_system.compute_element_vector_fields"><code class="xref py py-func docutils literal notranslate"><span class="pre">compute_element_vector_fields()</span></code></a>.</p>
<dl class="py function">
<dt class="sig sig-object py" id="mfv2d.solve_system.compute_element_vector_fields_nonlin">
<span class="sig-prename descclassname"><span class="pre">mfv2d.solve_system.</span></span><span class="sig-name descname"><span class="pre">compute_element_vector_fields_nonlin</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">system</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="kform.html#mfv2d.kform.KFormSystem" title="mfv2d.kform.KFormSystem"><span class="pre">KFormSystem</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">element_basis</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Basis2D</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_basis</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Basis2D</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vector_fields</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Sequence" title="(in Python v3.13)"><span class="pre">Sequence</span></a><span class="p"><span class="pre">[</span></span><span class="pre">Function2D</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="kform.html#mfv2d.kform.KFormUnknown" title="mfv2d.kform.KFormUnknown"><span class="pre">KFormUnknown</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">element_corners</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><span class="pre">ndarray</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><span class="pre">tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.13)"><span class="pre">Any</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.dtype.html#numpy.dtype" title="(in NumPy v2.3)"><span class="pre">dtype</span></a><span class="p"><span class="pre">[</span></span><span class="pre">float64</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">unknown_offsets</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><span class="pre">ndarray</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><span class="pre">tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.13)"><span class="pre">Any</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.dtype.html#numpy.dtype" title="(in NumPy v2.3)"><span class="pre">dtype</span></a><span class="p"><span class="pre">[</span></span><span class="pre">uint32</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">solution</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><span class="pre">ndarray</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><span class="pre">tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.13)"><span class="pre">Any</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.dtype.html#numpy.dtype" title="(in NumPy v2.3)"><span class="pre">dtype</span></a><span class="p"><span class="pre">[</span></span><span class="pre">float64</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><span class="pre">None</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><span class="pre">tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><span class="pre">ndarray</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><span class="pre">tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.13)"><span class="pre">Any</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.dtype.html#numpy.dtype" title="(in NumPy v2.3)"><span class="pre">dtype</span></a><span class="p"><span class="pre">[</span></span><span class="pre">float64</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/mfv2d/solve_system.html#compute_element_vector_fields_nonlin"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mfv2d.solve_system.compute_element_vector_fields_nonlin" title="Link to this definition">#</a></dt>
<dd><p>Evaluate vector fields which may be non-linear.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>system</strong> (<a class="reference internal" href="kform.html#mfv2d.kform.KFormSystem" title="mfv2d.kform.KFormSystem"><em>KFormSystem</em></a>) – System for which these vector fields should be computed.
TODO: REPLACE WITH JUST UNKNOWN FORMS</p></li>
<li><p><strong>element_basis</strong> (<em>Basis2D</em>) – Basis functions that the element uses. This needs to match
with the number of degrees of freedom of the element.</p></li>
<li><p><strong>output_basis</strong> (<em>Basis2D</em>) – Basis onto which the result is to be computed.</p></li>
<li><p><strong>vector_fields</strong> (<em>Sequence</em><em> of </em><em>Function2D</em><em> or </em><a class="reference internal" href="kform.html#mfv2d.kform.KFormUnknown" title="mfv2d.kform.KFormUnknown"><em>KFormUnknown</em></a>) – Description of the vector fields. Can be a callable which gives its
value at a point, or instead it can be an unknown in the system.</p></li>
<li><p><strong>element_corners</strong> (<em>(</em><em>4</em><em>, </em><em>2</em><em>) </em><em>array</em>) – Array of the element corner points.</p></li>
<li><p><strong>unknown_offsets</strong> (<em>array</em>) – Array with offsets of the degrees of freedom within the element. This
is used to pick correct degrees of freedom from the element DoFs vector.</p></li>
<li><p><strong>solution</strong> (<em>array</em><em>, </em><em>optional</em>) – Array of the element degrees of freedom. If not provided, all are assumed
to be zero instead.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Tuple with arrays with values of the vector field at each point of the 2D
basis integration rules.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)">tuple</a> of array</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="mfv2d.solve_system.compute_element_vector_fields">
<span class="sig-prename descclassname"><span class="pre">mfv2d.solve_system.</span></span><span class="sig-name descname"><span class="pre">compute_element_vector_fields</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ie</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">system</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="kform.html#mfv2d.kform.KFormSystem" title="mfv2d.kform.KFormSystem"><span class="pre">KFormSystem</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">child_count_array</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="element.html#mfv2d.element.FixedElementArray" title="mfv2d.element.FixedElementArray"><span class="pre">FixedElementArray</span></a><span class="p"><span class="pre">[</span></span><span class="pre">uint32</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">orders_in</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="element.html#mfv2d.element.FixedElementArray" title="mfv2d.element.FixedElementArray"><span class="pre">FixedElementArray</span></a><span class="p"><span class="pre">[</span></span><span class="pre">uint32</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">orders_out</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="element.html#mfv2d.element.FixedElementArray" title="mfv2d.element.FixedElementArray"><span class="pre">FixedElementArray</span></a><span class="p"><span class="pre">[</span></span><span class="pre">uint32</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">basis_cache</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="mimetic2d.html#mfv2d.mimetic2d.FemCache" title="mfv2d.mimetic2d.FemCache"><span class="pre">FemCache</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">vector_fields</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Sequence" title="(in Python v3.13)"><span class="pre">Sequence</span></a><span class="p"><span class="pre">[</span></span><span class="pre">Function2D</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="kform.html#mfv2d.kform.KFormUnknown" title="mfv2d.kform.KFormUnknown"><span class="pre">KFormUnknown</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">corners</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="element.html#mfv2d.element.FixedElementArray" title="mfv2d.element.FixedElementArray"><span class="pre">FixedElementArray</span></a><span class="p"><span class="pre">[</span></span><span class="pre">float64</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dof_offsets</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="element.html#mfv2d.element.FixedElementArray" title="mfv2d.element.FixedElementArray"><span class="pre">FixedElementArray</span></a><span class="p"><span class="pre">[</span></span><span class="pre">uint32</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">solution</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="element.html#mfv2d.element.FlexibleElementArray" title="mfv2d.element.FlexibleElementArray"><span class="pre">FlexibleElementArray</span></a><span class="p"><span class="pre">[</span></span><span class="pre">float64</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">uint32</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><span class="pre">tuple</span></a></span></span><a class="reference internal" href="../_modules/mfv2d/solve_system.html#compute_element_vector_fields"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mfv2d.solve_system.compute_element_vector_fields" title="Link to this definition">#</a></dt>
<dd><p>Wrap the vector fields func.</p>
</dd></dl>

</section>
<section id="the-actual-solver">
<h2>The Actual Solver<a class="headerlink" href="#the-actual-solver" title="Link to this heading">#</a></h2>
<p>The actual solver that runs to solve the (potentially non-linear) system
is implemented in the <a class="reference internal" href="#mfv2d.solve_system.non_linear_solve_run" title="mfv2d.solve_system.non_linear_solve_run"><code class="xref py py-func docutils literal notranslate"><span class="pre">non_linear_solve_run()</span></code></a> function.</p>
<dl class="py function">
<dt class="sig sig-object py" id="mfv2d.solve_system.non_linear_solve_run">
<span class="sig-prename descclassname"><span class="pre">mfv2d.solve_system.</span></span><span class="sig-name descname"><span class="pre">non_linear_solve_run</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">system</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="kform.html#mfv2d.kform.KFormSystem" title="mfv2d.kform.KFormSystem"><span class="pre">KFormSystem</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_iterations</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">relax</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><span class="pre">float</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">atol</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><span class="pre">float</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">rtol</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><span class="pre">float</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">print_residual</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><span class="pre">bool</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">unknown_ordering</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">UnknownOrderings</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">element_collection</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="element.html#mfv2d.element.ElementCollection" title="mfv2d.element.ElementCollection"><span class="pre">ElementCollection</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">leaf_elements</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><span class="pre">ndarray</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><span class="pre">tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.13)"><span class="pre">Any</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.dtype.html#numpy.dtype" title="(in NumPy v2.3)"><span class="pre">dtype</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://numpy.org/doc/stable/reference/arrays.scalars.html#numpy.integer" title="(in NumPy v2.3)"><span class="pre">integer</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cache_2d</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="mimetic2d.html#mfv2d.mimetic2d.FemCache" title="mfv2d.mimetic2d.FemCache"><span class="pre">FemCache</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">compiled_system</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="eval.html#mfv2d.eval.CompiledSystem" title="mfv2d.eval.CompiledSystem"><span class="pre">CompiledSystem</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">explicit_vec</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><span class="pre">ndarray</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><span class="pre">tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.13)"><span class="pre">Any</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.dtype.html#numpy.dtype" title="(in NumPy v2.3)"><span class="pre">dtype</span></a><span class="p"><span class="pre">[</span></span><span class="pre">float64</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dof_offsets</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="element.html#mfv2d.element.FixedElementArray" title="mfv2d.element.FixedElementArray"><span class="pre">FixedElementArray</span></a><span class="p"><span class="pre">[</span></span><span class="pre">uint32</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">element_offsets</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><span class="pre">ndarray</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><span class="pre">tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.13)"><span class="pre">Any</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.dtype.html#numpy.dtype" title="(in NumPy v2.3)"><span class="pre">dtype</span></a><span class="p"><span class="pre">[</span></span><span class="pre">uint32</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">linear_element_matrices</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="element.html#mfv2d.element.FlexibleElementArray" title="mfv2d.element.FlexibleElementArray"><span class="pre">FlexibleElementArray</span></a><span class="p"><span class="pre">[</span></span><span class="pre">float64</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">uint32</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_carry_index_array</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="element.html#mfv2d.element.FlexibleElementArray" title="mfv2d.element.FlexibleElementArray"><span class="pre">FlexibleElementArray</span></a><span class="p"><span class="pre">[</span></span><span class="pre">uint32</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">uint32</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><span class="pre">None</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_carry_term</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="element.html#mfv2d.element.FlexibleElementArray" title="mfv2d.element.FlexibleElementArray"><span class="pre">FlexibleElementArray</span></a><span class="p"><span class="pre">[</span></span><span class="pre">float64</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">uint32</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><span class="pre">None</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">solution</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="element.html#mfv2d.element.FlexibleElementArray" title="mfv2d.element.FlexibleElementArray"><span class="pre">FlexibleElementArray</span></a><span class="p"><span class="pre">[</span></span><span class="pre">float64</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">uint32</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">global_lagrange</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><span class="pre">ndarray</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><span class="pre">tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.13)"><span class="pre">Any</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.dtype.html#numpy.dtype" title="(in NumPy v2.3)"><span class="pre">dtype</span></a><span class="p"><span class="pre">[</span></span><span class="pre">float64</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_mag</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><span class="pre">float</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">vector_fields</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Sequence" title="(in Python v3.13)"><span class="pre">Sequence</span></a><span class="p"><span class="pre">[</span></span><span class="pre">Function2D</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="kform.html#mfv2d.kform.KFormUnknown" title="mfv2d.kform.KFormUnknown"><span class="pre">KFormUnknown</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">system_decomp</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">SuperLU</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lagrange_mat</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.sparse.csr_array.html#scipy.sparse.csr_array" title="(in SciPy v1.15.3)"><span class="pre">csr_array</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><span class="pre">None</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_all_residuals</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mfv2d/solve_system.html#non_linear_solve_run"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mfv2d.solve_system.non_linear_solve_run" title="Link to this definition">#</a></dt>
<dd><p>Run the iterative non-linear solver.</p>
<p>Based on how the compiled system looks, this may only take a single iteration,
otherwise, it may run for as long as it needs to converge.</p>
</dd></dl>

<section id="solver-settings">
<h3>Solver Settings<a class="headerlink" href="#solver-settings" title="Link to this heading">#</a></h3>
<p>To configure the solver, several settings dataclasses are provided. These
each handle a different aspect of the solver and most have some default
values.</p>
<dl class="py class">
<dt class="sig sig-object py" id="mfv2d.solve_system.SystemSettings">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mfv2d.solve_system.</span></span><span class="sig-name descname"><span class="pre">SystemSettings</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">system:</span> <span class="pre">~mfv2d.kform.KFormSystem,</span> <span class="pre">boundary_conditions:</span> <span class="pre">~collections.abc.Sequence[~mfv2d.boundary.BoundaryCondition2DSteady]</span> <span class="pre">=</span> <span class="pre">&lt;factory&gt;,</span> <span class="pre">constrained_forms:</span> <span class="pre">~collections.abc.Sequence[tuple[float,</span> <span class="pre">~mfv2d.kform.KFormUnknown]]</span> <span class="pre">=</span> <span class="pre">&lt;factory&gt;,</span> <span class="pre">initial_conditions:</span> <span class="pre">~collections.abc.Mapping[~mfv2d.kform.KFormUnknown,</span> <span class="pre">~collections.abc.Callable[[~numpy.ndarray[tuple[~typing.Any,</span> <span class="pre">...],</span> <span class="pre">~numpy.dtype[~numpy.float64]],</span> <span class="pre">~numpy.ndarray[tuple[~typing.Any,</span> <span class="pre">...],</span> <span class="pre">~numpy.dtype[~numpy.float64]]],</span> <span class="pre">~collections.abc.Buffer</span> <span class="pre">|</span> <span class="pre">~numpy._typing._array_like._SupportsArray[~numpy.dtype[~typing.Any]]</span> <span class="pre">|</span> <span class="pre">~numpy._typing._nested_sequence._NestedSequence[~numpy._typing._array_like._SupportsArray[~numpy.dtype[~typing.Any]]]</span> <span class="pre">|</span> <span class="pre">complex</span> <span class="pre">|</span> <span class="pre">bytes</span> <span class="pre">|</span> <span class="pre">str</span> <span class="pre">|</span> <span class="pre">~numpy._typing._nested_sequence._NestedSequence[complex</span> <span class="pre">|</span> <span class="pre">bytes</span> <span class="pre">|</span> <span class="pre">str]]]</span> <span class="pre">=</span> <span class="pre">&lt;factory&gt;</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mfv2d/solve_system.html#SystemSettings"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mfv2d.solve_system.SystemSettings" title="Link to this definition">#</a></dt>
<dd><p>Type used to hold system information for solving.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>system</strong> (<a class="reference internal" href="kform.html#mfv2d.kform.KFormSystem" title="mfv2d.kform.KFormSystem"><em>KFormSystem</em></a>) – System of equations to solve.</p></li>
<li><p><strong>boundaray_conditions</strong> (<em>Sequence</em><em> of </em><a class="reference internal" href="boundary.html#mfv2d.boundary.BoundaryCondition2DSteady" title="mfv2d.boundary.BoundaryCondition2DSteady"><em>BoundaryCondition2DSteady</em></a><em>, </em><em>optional</em>) – Sequence of boundary conditions to be applied to the system.</p></li>
<li><p><strong>constrained_forms</strong> (<em>Sequence</em><em> of </em><em>(</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a><em>, </em><a class="reference internal" href="kform.html#mfv2d.kform.KFormUnknown" title="mfv2d.kform.KFormUnknown"><em>KFormUnknown</em></a><em>)</em><em>, </em><em>optional</em>) – <p>Sequence of 2-form unknowns which must be constrained. These can arrise form
cases where a continuous variable acts as a Lagrange multiplier on the continuous
level and only appears in the PDE as a gradient. In that case it will result
in a singular system if not constrained manually to a fixed value.</p>
<p>An example of such a case is pressure in Stokes flow or incompressible
Navier-Stokes equations.</p>
</p></li>
<li><p><strong>intial_conditions</strong> (<em>Mapping</em><em> of </em><em>(</em><a class="reference internal" href="kform.html#mfv2d.kform.KFormUnknown" title="mfv2d.kform.KFormUnknown"><em>KFormUnknown</em></a><em>, </em><em>Callable</em><em>)</em><em>, </em><em>optional</em>) – Functions which give initial conditions for different forms.</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="mfv2d.solve_system.SystemSettings.boundary_conditions">
<span class="sig-name descname"><span class="pre">boundary_conditions</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Sequence" title="(in Python v3.13)"><span class="pre">Sequence</span></a><span class="p"><span class="pre">[</span></span><a class="reference internal" href="boundary.html#mfv2d.boundary.BoundaryCondition2DSteady" title="mfv2d.boundary.BoundaryCondition2DSteady"><span class="pre">BoundaryCondition2DSteady</span></a><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#mfv2d.solve_system.SystemSettings.boundary_conditions" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="mfv2d.solve_system.SystemSettings.constrained_forms">
<span class="sig-name descname"><span class="pre">constrained_forms</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Sequence" title="(in Python v3.13)"><span class="pre">Sequence</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><span class="pre">tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><span class="pre">float</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="kform.html#mfv2d.kform.KFormUnknown" title="mfv2d.kform.KFormUnknown"><span class="pre">KFormUnknown</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#mfv2d.solve_system.SystemSettings.constrained_forms" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="mfv2d.solve_system.SystemSettings.initial_conditions">
<span class="sig-name descname"><span class="pre">initial_conditions</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Mapping" title="(in Python v3.13)"><span class="pre">Mapping</span></a><span class="p"><span class="pre">[</span></span><a class="reference internal" href="kform.html#mfv2d.kform.KFormUnknown" title="mfv2d.kform.KFormUnknown"><span class="pre">KFormUnknown</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Callable" title="(in Python v3.13)"><span class="pre">Callable</span></a><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><span class="pre">ndarray</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><span class="pre">tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.13)"><span class="pre">Any</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.dtype.html#numpy.dtype" title="(in NumPy v2.3)"><span class="pre">dtype</span></a><span class="p"><span class="pre">[</span></span><span class="pre">float64</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><span class="pre">ndarray</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><span class="pre">tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.13)"><span class="pre">Any</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.dtype.html#numpy.dtype" title="(in NumPy v2.3)"><span class="pre">dtype</span></a><span class="p"><span class="pre">[</span></span><span class="pre">float64</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Buffer" title="(in Python v3.13)"><span class="pre">Buffer</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">_SupportsArray</span><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.dtype.html#numpy.dtype" title="(in NumPy v2.3)"><span class="pre">dtype</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.13)"><span class="pre">Any</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">_NestedSequence</span><span class="p"><span class="pre">[</span></span><span class="pre">_SupportsArray</span><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.dtype.html#numpy.dtype" title="(in NumPy v2.3)"><span class="pre">dtype</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.13)"><span class="pre">Any</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#complex" title="(in Python v3.13)"><span class="pre">complex</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#bytes" title="(in Python v3.13)"><span class="pre">bytes</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">_NestedSequence</span><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#complex" title="(in Python v3.13)"><span class="pre">complex</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#bytes" title="(in Python v3.13)"><span class="pre">bytes</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#mfv2d.solve_system.SystemSettings.initial_conditions" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="mfv2d.solve_system.SystemSettings.system">
<span class="sig-name descname"><span class="pre">system</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="kform.html#mfv2d.kform.KFormSystem" title="mfv2d.kform.KFormSystem"><span class="pre">KFormSystem</span></a></em><a class="headerlink" href="#mfv2d.solve_system.SystemSettings.system" title="Link to this definition">#</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mfv2d.solve_system.SolverSettings">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mfv2d.solve_system.</span></span><span class="sig-name descname"><span class="pre">SolverSettings</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">maximum_iterations</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">relaxation</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><span class="pre">float</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">absolute_tolerance</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><span class="pre">float</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1e-06</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">relative_tolerance</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><span class="pre">float</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1e-05</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mfv2d/solve_system.html#SolverSettings"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mfv2d.solve_system.SolverSettings" title="Link to this definition">#</a></dt>
<dd><p>Settings used by the non-linear solver.</p>
<p>Solver finds a solution to the system <a class="reference internal" href="#equation-solve-system-equation">(1)</a>, where
<span class="math notranslate nohighlight">\(\mathbb{I}\)</span> is the implicit part of the system, <span class="math notranslate nohighlight">\(\vec{E}\)</span> is the explicit
part of the system, and <span class="math notranslate nohighlight">\(\vec{F}\)</span> is the constant part of the system.</p>
<p>This is done by computing updates to the state <span class="math notranslate nohighlight">\(\Delta u\)</span> as per
<a class="reference internal" href="#equation-solve-system-iteration">(2)</a>. The iterations stop once the residual
<span class="math notranslate nohighlight">\(\vec{E}\left({\vec{u}}^i\right) + \vec{F} + \vec{I}\left({\vec{u}}^i\right)\)</span>
falls under the specified criterion.</p>
<p>The stopping criterion has two tolerances - absolute and relative - which both need
to be met in order for the solver to stop. The absolute criterion checks if the
highest absolute value of the residual elements is bellow the value specified. The
relative first scales it by the maximum absolute value of the constant forcing.
Depending on the system and the solution, these may need to be adjusted. If the system
is linear, meaning that <span class="math notranslate nohighlight">\(\vec{E} = 0\)</span> and <span class="math notranslate nohighlight">\(\mathbb{I}\)</span> is
not dependant on math:<cite>vec{u}</cite>, then the solver will terminate in a single iteration.</p>
<p>Last thing to consider is the relaxation. Sometimes, the system is very stiff and does
not converge nicely. This can be the case for steady-state calculations of non-linear
systems with bad initial guesses. In such cases, the correction can be too large and
overshoot the solution. In such cases, convergence may still be achieved if the update
is scaled by a “relaxation factor”. Conversely, convergence may be slightly sped up
for some very stable problems if the increment is amplified, meaning the relaxation
factor is greater than 1.</p>
<div class="math notranslate nohighlight" id="equation-solve-system-equation">
<span class="eqno">(1)<a class="headerlink" href="#equation-solve-system-equation" title="Link to this equation">#</a></span>\[\mathbb{I}\left({\vec{u}}\right) {\vec{u}} = \vec{E}\left({\vec{u}}^i
\right) + \vec{F}\]</div>
<div class="math notranslate nohighlight" id="equation-solve-system-iteration">
<span class="eqno">(2)<a class="headerlink" href="#equation-solve-system-iteration" title="Link to this equation">#</a></span>\[\Delta {\vec{u}}^i = \left(\mathbb{I}\left({\vec{u}}^i\right)\right)^{-1} \left(
\vec{E}\left({\vec{u}}^i\right) + \vec{F} + \vec{I}\left({\vec{u}}^i\right)\right)\]</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>maximum_iterations</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>, </em><em>default: 100</em>) – Maximum number of iterations the solver performs.</p></li>
<li><p><strong>relaxation</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a><em>, </em><em>default: 1.0</em>) – Fraction of solution increment to use.</p></li>
<li><p><strong>absolute_tolerance</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a><em>, </em><em>default: 1e-6</em>) – Maximum value of the residual must meet in order for the solution
to be considered converged.</p></li>
<li><p><strong>relative_tolerance</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a><em>, </em><em>default: 1e-5</em>) – Maximum fraction of the maximum of the right side of the equation the residual
must meet in order for the solution to be considered converged.</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="mfv2d.solve_system.SolverSettings.absolute_tolerance">
<span class="sig-name descname"><span class="pre">absolute_tolerance</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><span class="pre">float</span></a></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">1e-06</span></em><a class="headerlink" href="#mfv2d.solve_system.SolverSettings.absolute_tolerance" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="mfv2d.solve_system.SolverSettings.maximum_iterations">
<span class="sig-name descname"><span class="pre">maximum_iterations</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">100</span></em><a class="headerlink" href="#mfv2d.solve_system.SolverSettings.maximum_iterations" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="mfv2d.solve_system.SolverSettings.relative_tolerance">
<span class="sig-name descname"><span class="pre">relative_tolerance</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><span class="pre">float</span></a></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">1e-05</span></em><a class="headerlink" href="#mfv2d.solve_system.SolverSettings.relative_tolerance" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="mfv2d.solve_system.SolverSettings.relaxation">
<span class="sig-name descname"><span class="pre">relaxation</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><span class="pre">float</span></a></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">1.0</span></em><a class="headerlink" href="#mfv2d.solve_system.SolverSettings.relaxation" title="Link to this definition">#</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mfv2d.solve_system.RefinementSettings">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mfv2d.solve_system.</span></span><span class="sig-name descname"><span class="pre">RefinementSettings</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">refinement_levels:</span> <span class="pre">int,</span> <span class="pre">division_predicate:</span> <span class="pre">~collections.abc.Callable[[~mfv2d.mimetic2d.ElementLeaf2D,</span> <span class="pre">int],</span> <span class="pre">bool]</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None,</span> <span class="pre">division_function:</span> <span class="pre">~collections.abc.Callable[[int,</span> <span class="pre">int,</span> <span class="pre">int],</span> <span class="pre">tuple[int</span> <span class="pre">|</span> <span class="pre">None,</span> <span class="pre">tuple[int,</span> <span class="pre">int,</span> <span class="pre">int,</span> <span class="pre">int]]]</span> <span class="pre">=</span> <span class="pre">&lt;function</span> <span class="pre">divide_old&gt;</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mfv2d/solve_system.html#RefinementSettings"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mfv2d.solve_system.RefinementSettings" title="Link to this definition">#</a></dt>
<dd><p>Type used to hold settings related to refinement information.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>refinement_levels</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – Number of mesh refinement levels which can be done. When zero,
no refinement is done.</p></li>
<li><p><strong>division_predicate</strong> (<em>Callable</em><em> (</em><em>Element2D</em><em>, </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>) </em><em>-&gt; bool</em><em>, </em><em>optional</em>) – Callable used to determine if an element should be divided further. If
not specified, no refinement is done.</p></li>
<li><p><strong>division_function</strong> (<em>OrderDivisionFunction</em><em>, </em><em>optional</em>) – Function which determines order of the parent and child elements resulting from
the division of the element. When not specified, the “old” method is used.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="mfv2d.solve_system.RefinementSettings.division_function">
<span class="sig-name descname"><span class="pre">division_function</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">level</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_level</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><span class="pre">tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><span class="pre">None</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><span class="pre">tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#mfv2d.solve_system.RefinementSettings.division_function" title="Link to this definition">#</a></dt>
<dd><p>Keep child order equal to parent and set parent to double the child.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="mfv2d.solve_system.RefinementSettings.division_predicate">
<span class="sig-name descname"><span class="pre">division_predicate</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Callable" title="(in Python v3.13)"><span class="pre">Callable</span></a><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="pre">ElementLeaf2D</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><span class="pre">bool</span></a><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><span class="pre">None</span></a></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#mfv2d.solve_system.RefinementSettings.division_predicate" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="mfv2d.solve_system.RefinementSettings.refinement_levels">
<span class="sig-name descname"><span class="pre">refinement_levels</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></em><a class="headerlink" href="#mfv2d.solve_system.RefinementSettings.refinement_levels" title="Link to this definition">#</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mfv2d.solve_system.TimeSettings">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mfv2d.solve_system.</span></span><span class="sig-name descname"><span class="pre">TimeSettings</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dt</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><span class="pre">float</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">nt</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_march_relations</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Mapping" title="(in Python v3.13)"><span class="pre">Mapping</span></a><span class="p"><span class="pre">[</span></span><a class="reference internal" href="kform.html#mfv2d.kform.KWeight" title="mfv2d.kform.KWeight"><span class="pre">KWeight</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="kform.html#mfv2d.kform.KFormUnknown" title="mfv2d.kform.KFormUnknown"><span class="pre">KFormUnknown</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample_rate</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mfv2d/solve_system.html#TimeSettings"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mfv2d.solve_system.TimeSettings" title="Link to this definition">#</a></dt>
<dd><p>Type for defining time settings of the solver.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dt</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – Time step to take.</p></li>
<li><p><strong>nt</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – Number of time steps to simulate.</p></li>
<li><p><strong>time_march_relations</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><em>dict</em></a><em> of </em><em>(</em><a class="reference internal" href="kform.html#mfv2d.kform.KWeight" title="mfv2d.kform.KWeight"><em>KWeight</em></a><em>, </em><a class="reference internal" href="kform.html#mfv2d.kform.KFormUnknown" title="mfv2d.kform.KFormUnknown"><em>KFormUnknown</em></a><em>)</em>) – Pairs of weights and unknowns, which determine what equations are treated as time
marching equations for which unknowns. At least one should be present.</p></li>
<li><p><strong>sample_rate</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>, </em><em>optional</em>) – How often the output is saved. If not specified, every time step is saved. First
and last steps are always saved.</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="mfv2d.solve_system.TimeSettings.dt">
<span class="sig-name descname"><span class="pre">dt</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><span class="pre">float</span></a></em><a class="headerlink" href="#mfv2d.solve_system.TimeSettings.dt" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="mfv2d.solve_system.TimeSettings.nt">
<span class="sig-name descname"><span class="pre">nt</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></em><a class="headerlink" href="#mfv2d.solve_system.TimeSettings.nt" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="mfv2d.solve_system.TimeSettings.sample_rate">
<span class="sig-name descname"><span class="pre">sample_rate</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">1</span></em><a class="headerlink" href="#mfv2d.solve_system.TimeSettings.sample_rate" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="mfv2d.solve_system.TimeSettings.time_march_relations">
<span class="sig-name descname"><span class="pre">time_march_relations</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Mapping" title="(in Python v3.13)"><span class="pre">Mapping</span></a><span class="p"><span class="pre">[</span></span><a class="reference internal" href="kform.html#mfv2d.kform.KWeight" title="mfv2d.kform.KWeight"><span class="pre">KWeight</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="kform.html#mfv2d.kform.KFormUnknown" title="mfv2d.kform.KFormUnknown"><span class="pre">KFormUnknown</span></a><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#mfv2d.solve_system.TimeSettings.time_march_relations" title="Link to this definition">#</a></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="solver-statistics">
<h3>Solver Statistics<a class="headerlink" href="#solver-statistics" title="Link to this heading">#</a></h3>
<p>To return feedback on how the solver ran and more information about the system
it just solved, <a class="reference internal" href="#mfv2d.solve_system.SolutionStatistics" title="mfv2d.solve_system.SolutionStatistics"><code class="xref py py-class docutils literal notranslate"><span class="pre">SolutionStatistics</span></code></a> type is provided. As such, an
object of this type is returned when the solver runs.</p>
<dl class="py class">
<dt class="sig sig-object py" id="mfv2d.solve_system.SolutionStatistics">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mfv2d.solve_system.</span></span><span class="sig-name descname"><span class="pre">SolutionStatistics</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">element_orders</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><span class="pre">dict</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_total_dofs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_leaf_dofs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_lagrange</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_elems</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_leaves</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">iter_history</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><span class="pre">ndarray</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><span class="pre">tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.13)"><span class="pre">Any</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.dtype.html#numpy.dtype" title="(in NumPy v2.3)"><span class="pre">dtype</span></a><span class="p"><span class="pre">[</span></span><span class="pre">uint32</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">residual_history</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><span class="pre">ndarray</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><span class="pre">tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.13)"><span class="pre">Any</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.dtype.html#numpy.dtype" title="(in NumPy v2.3)"><span class="pre">dtype</span></a><span class="p"><span class="pre">[</span></span><span class="pre">float64</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mfv2d/solve_system.html#SolutionStatistics"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mfv2d.solve_system.SolutionStatistics" title="Link to this definition">#</a></dt>
<dd><p>Information about the solution.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="mfv2d.solve_system.SolutionStatistics.element_orders">
<span class="sig-name descname"><span class="pre">element_orders</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><span class="pre">dict</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#mfv2d.solve_system.SolutionStatistics.element_orders" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="mfv2d.solve_system.SolutionStatistics.iter_history">
<span class="sig-name descname"><span class="pre">iter_history</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><span class="pre">ndarray</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><span class="pre">tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.13)"><span class="pre">Any</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.dtype.html#numpy.dtype" title="(in NumPy v2.3)"><span class="pre">dtype</span></a><span class="p"><span class="pre">[</span></span><span class="pre">uint32</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#mfv2d.solve_system.SolutionStatistics.iter_history" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="mfv2d.solve_system.SolutionStatistics.n_elems">
<span class="sig-name descname"><span class="pre">n_elems</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></em><a class="headerlink" href="#mfv2d.solve_system.SolutionStatistics.n_elems" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="mfv2d.solve_system.SolutionStatistics.n_lagrange">
<span class="sig-name descname"><span class="pre">n_lagrange</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></em><a class="headerlink" href="#mfv2d.solve_system.SolutionStatistics.n_lagrange" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="mfv2d.solve_system.SolutionStatistics.n_leaf_dofs">
<span class="sig-name descname"><span class="pre">n_leaf_dofs</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></em><a class="headerlink" href="#mfv2d.solve_system.SolutionStatistics.n_leaf_dofs" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="mfv2d.solve_system.SolutionStatistics.n_leaves">
<span class="sig-name descname"><span class="pre">n_leaves</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></em><a class="headerlink" href="#mfv2d.solve_system.SolutionStatistics.n_leaves" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="mfv2d.solve_system.SolutionStatistics.n_total_dofs">
<span class="sig-name descname"><span class="pre">n_total_dofs</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></em><a class="headerlink" href="#mfv2d.solve_system.SolutionStatistics.n_total_dofs" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="mfv2d.solve_system.SolutionStatistics.residual_history">
<span class="sig-name descname"><span class="pre">residual_history</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><span class="pre">ndarray</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><span class="pre">tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.13)"><span class="pre">Any</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.dtype.html#numpy.dtype" title="(in NumPy v2.3)"><span class="pre">dtype</span></a><span class="p"><span class="pre">[</span></span><span class="pre">float64</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#mfv2d.solve_system.SolutionStatistics.residual_history" title="Link to this definition">#</a></dt>
<dd></dd></dl>

</dd></dl>

</section>
</section>
</section>


                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="mimetic2d.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">mimetic2d</p>
      </div>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#computing-the-explicit-terms">Computing the Explicit Terms</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mfv2d.solve_system.compute_element_rhs"><code class="docutils literal notranslate"><span class="pre">compute_element_rhs()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mfv2d.solve_system._extract_rhs_2d"><code class="docutils literal notranslate"><span class="pre">_extract_rhs_2d()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mfv2d.solve_system.rhs_2d_element_projection"><code class="docutils literal notranslate"><span class="pre">rhs_2d_element_projection()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#lagrange-multipliers-and-constraints">Lagrange Multipliers and Constraints</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mfv2d.solve_system.ElementConstraint"><code class="docutils literal notranslate"><span class="pre">ElementConstraint</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#mfv2d.solve_system.ElementConstraint.coeffs"><code class="docutils literal notranslate"><span class="pre">ElementConstraint.coeffs</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#mfv2d.solve_system.ElementConstraint.dofs"><code class="docutils literal notranslate"><span class="pre">ElementConstraint.dofs</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#mfv2d.solve_system.ElementConstraint.i_e"><code class="docutils literal notranslate"><span class="pre">ElementConstraint.i_e</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mfv2d.solve_system.Constraint"><code class="docutils literal notranslate"><span class="pre">Constraint</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#mfv2d.solve_system.Constraint.element_constraints"><code class="docutils literal notranslate"><span class="pre">Constraint.element_constraints</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#mfv2d.solve_system.Constraint.rhs"><code class="docutils literal notranslate"><span class="pre">Constraint.rhs</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#continuity">Continuity</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mfv2d.solve_system.continuity_matrices"><code class="docutils literal notranslate"><span class="pre">continuity_matrices()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mfv2d.solve_system._continuity_element_1_forms"><code class="docutils literal notranslate"><span class="pre">_continuity_element_1_forms()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mfv2d.solve_system._continuity_element_0_forms_inner"><code class="docutils literal notranslate"><span class="pre">_continuity_element_0_forms_inner()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mfv2d.solve_system._continuity_element_0_forms_corner"><code class="docutils literal notranslate"><span class="pre">_continuity_element_0_forms_corner()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mfv2d.solve_system.continuity_child_matrices"><code class="docutils literal notranslate"><span class="pre">continuity_child_matrices()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mfv2d.solve_system._continuity_parent_child_nodes"><code class="docutils literal notranslate"><span class="pre">_continuity_parent_child_nodes()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mfv2d.solve_system._continuity_parent_child_edges"><code class="docutils literal notranslate"><span class="pre">_continuity_parent_child_edges()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mfv2d.solve_system._parent_child_equations"><code class="docutils literal notranslate"><span class="pre">_parent_child_equations()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#matrix-assembly">Matrix Assembly</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mfv2d.solve_system.assemble_matrix"><code class="docutils literal notranslate"><span class="pre">assemble_matrix()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mfv2d.solve_system._compute_element_matrix"><code class="docutils literal notranslate"><span class="pre">_compute_element_matrix()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#vector-assembly">Vector Assembly</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mfv2d.solve_system.assemble_vector"><code class="docutils literal notranslate"><span class="pre">assemble_vector()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mfv2d.solve_system._compute_element_vector"><code class="docutils literal notranslate"><span class="pre">_compute_element_vector()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#forcing-assembly">Forcing Assembly</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mfv2d.solve_system.assemble_forcing"><code class="docutils literal notranslate"><span class="pre">assemble_forcing()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mfv2d.solve_system._compute_element_forcing"><code class="docutils literal notranslate"><span class="pre">_compute_element_forcing()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#global-continuity">Global Continuity</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mfv2d.solve_system.mesh_continuity_constraints"><code class="docutils literal notranslate"><span class="pre">mesh_continuity_constraints()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mfv2d.solve_system._top_level_continuity_0"><code class="docutils literal notranslate"><span class="pre">_top_level_continuity_0()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mfv2d.solve_system._top_level_continuity_1"><code class="docutils literal notranslate"><span class="pre">_top_level_continuity_1()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#boundary-conditions">Boundary Conditions</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mfv2d.solve_system.mesh_boundary_conditions"><code class="docutils literal notranslate"><span class="pre">mesh_boundary_conditions()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mfv2d.solve_system._element_weak_boundary_condition"><code class="docutils literal notranslate"><span class="pre">_element_weak_boundary_condition()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mfv2d.solve_system._element_strong_boundary_condition"><code class="docutils literal notranslate"><span class="pre">_element_strong_boundary_condition()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#global-reconstruction">Global Reconstruction</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mfv2d.solve_system.reconstruct_mesh_from_solution"><code class="docutils literal notranslate"><span class="pre">reconstruct_mesh_from_solution()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#time-march-support">Time March Support</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mfv2d.solve_system.extract_carry"><code class="docutils literal notranslate"><span class="pre">extract_carry()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mfv2d.solve_system._extract_time_carry"><code class="docutils literal notranslate"><span class="pre">_extract_time_carry()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mfv2d.solve_system.find_time_carry_indices"><code class="docutils literal notranslate"><span class="pre">find_time_carry_indices()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#leaf-calculations">Leaf Calculations</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mfv2d.solve_system.compute_leaf_matrix"><code class="docutils literal notranslate"><span class="pre">compute_leaf_matrix()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mfv2d.solve_system.compute_leaf_vector"><code class="docutils literal notranslate"><span class="pre">compute_leaf_vector()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mfv2d.solve_system.compute_element_vector_fields_nonlin"><code class="docutils literal notranslate"><span class="pre">compute_element_vector_fields_nonlin()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mfv2d.solve_system.compute_element_vector_fields"><code class="docutils literal notranslate"><span class="pre">compute_element_vector_fields()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-actual-solver">The Actual Solver</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mfv2d.solve_system.non_linear_solve_run"><code class="docutils literal notranslate"><span class="pre">non_linear_solve_run()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#solver-settings">Solver Settings</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#mfv2d.solve_system.SystemSettings"><code class="docutils literal notranslate"><span class="pre">SystemSettings</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#mfv2d.solve_system.SystemSettings.boundary_conditions"><code class="docutils literal notranslate"><span class="pre">SystemSettings.boundary_conditions</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#mfv2d.solve_system.SystemSettings.constrained_forms"><code class="docutils literal notranslate"><span class="pre">SystemSettings.constrained_forms</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#mfv2d.solve_system.SystemSettings.initial_conditions"><code class="docutils literal notranslate"><span class="pre">SystemSettings.initial_conditions</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#mfv2d.solve_system.SystemSettings.system"><code class="docutils literal notranslate"><span class="pre">SystemSettings.system</span></code></a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#mfv2d.solve_system.SolverSettings"><code class="docutils literal notranslate"><span class="pre">SolverSettings</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#mfv2d.solve_system.SolverSettings.absolute_tolerance"><code class="docutils literal notranslate"><span class="pre">SolverSettings.absolute_tolerance</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#mfv2d.solve_system.SolverSettings.maximum_iterations"><code class="docutils literal notranslate"><span class="pre">SolverSettings.maximum_iterations</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#mfv2d.solve_system.SolverSettings.relative_tolerance"><code class="docutils literal notranslate"><span class="pre">SolverSettings.relative_tolerance</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#mfv2d.solve_system.SolverSettings.relaxation"><code class="docutils literal notranslate"><span class="pre">SolverSettings.relaxation</span></code></a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#mfv2d.solve_system.RefinementSettings"><code class="docutils literal notranslate"><span class="pre">RefinementSettings</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#mfv2d.solve_system.RefinementSettings.division_function"><code class="docutils literal notranslate"><span class="pre">RefinementSettings.division_function()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#mfv2d.solve_system.RefinementSettings.division_predicate"><code class="docutils literal notranslate"><span class="pre">RefinementSettings.division_predicate</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#mfv2d.solve_system.RefinementSettings.refinement_levels"><code class="docutils literal notranslate"><span class="pre">RefinementSettings.refinement_levels</span></code></a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#mfv2d.solve_system.TimeSettings"><code class="docutils literal notranslate"><span class="pre">TimeSettings</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#mfv2d.solve_system.TimeSettings.dt"><code class="docutils literal notranslate"><span class="pre">TimeSettings.dt</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#mfv2d.solve_system.TimeSettings.nt"><code class="docutils literal notranslate"><span class="pre">TimeSettings.nt</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#mfv2d.solve_system.TimeSettings.sample_rate"><code class="docutils literal notranslate"><span class="pre">TimeSettings.sample_rate</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#mfv2d.solve_system.TimeSettings.time_march_relations"><code class="docutils literal notranslate"><span class="pre">TimeSettings.time_march_relations</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#solver-statistics">Solver Statistics</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#mfv2d.solve_system.SolutionStatistics"><code class="docutils literal notranslate"><span class="pre">SolutionStatistics</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#mfv2d.solve_system.SolutionStatistics.element_orders"><code class="docutils literal notranslate"><span class="pre">SolutionStatistics.element_orders</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#mfv2d.solve_system.SolutionStatistics.iter_history"><code class="docutils literal notranslate"><span class="pre">SolutionStatistics.iter_history</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#mfv2d.solve_system.SolutionStatistics.n_elems"><code class="docutils literal notranslate"><span class="pre">SolutionStatistics.n_elems</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#mfv2d.solve_system.SolutionStatistics.n_lagrange"><code class="docutils literal notranslate"><span class="pre">SolutionStatistics.n_lagrange</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#mfv2d.solve_system.SolutionStatistics.n_leaf_dofs"><code class="docutils literal notranslate"><span class="pre">SolutionStatistics.n_leaf_dofs</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#mfv2d.solve_system.SolutionStatistics.n_leaves"><code class="docutils literal notranslate"><span class="pre">SolutionStatistics.n_leaves</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#mfv2d.solve_system.SolutionStatistics.n_total_dofs"><code class="docutils literal notranslate"><span class="pre">SolutionStatistics.n_total_dofs</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#mfv2d.solve_system.SolutionStatistics.residual_history"><code class="docutils literal notranslate"><span class="pre">SolutionStatistics.residual_history</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Jan Roth
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2025, Jan Roth.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>