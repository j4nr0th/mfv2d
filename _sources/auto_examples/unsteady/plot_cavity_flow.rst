
.. DO NOT EDIT.
.. THIS FILE WAS AUTOMATICALLY GENERATED BY SPHINX-GALLERY.
.. TO MAKE CHANGES, EDIT THE SOURCE PYTHON FILE:
.. "auto_examples/unsteady/plot_cavity_flow.py"
.. LINE NUMBERS ARE GIVEN BELOW.

.. only:: html

    .. note::
        :class: sphx-glr-download-link-note

        :ref:`Go to the end <sphx_glr_download_auto_examples_unsteady_plot_cavity_flow.py>`
        to download the full example code.

.. rst-class:: sphx-glr-example-title

.. _sphx_glr_auto_examples_unsteady_plot_cavity_flow.py:


Navier-Stokes: Cavity Flow
==========================

Cavity flow can be considered a canonical solution for the Navier-Stokes,
given how well the solution to this problem is known. In this exampled it
is solved for the case of :math:`Re = 10`, since that allows for quick convergence
on a fairly coarse grid.

.. GENERATED FROM PYTHON SOURCE LINES 10-25

.. code-block:: Python


    import numpy as np
    import pyvista as pv
    import rmsh
    from mfv2d import (
        BoundaryCondition2DSteady,
        KFormSystem,
        KFormUnknown,
        Mesh2D,
        SolverSettings,
        SystemSettings,
        TimeSettings,
        solve_system_2d,
    )








.. GENERATED FROM PYTHON SOURCE LINES 26-33

Setup
-----

Since there's no manufactured solution, the only necessary setup
is the boundary velocity, which should be 2 on the top side of the
mesh and zero elsewhere. The reason for it being 2 is because the
domain length is also 2.

.. GENERATED FROM PYTHON SOURCE LINES 34-45

.. code-block:: Python


    RE = 1e1


    def boundary_velocty(x, y):
        """Exact velocity solution."""
        vx = 2 * (y == 1) + 0 * x
        vy = 0 * (x + y)
        return np.stack((vx, vy), axis=-1)









.. GENERATED FROM PYTHON SOURCE LINES 46-53

System Setup
------------

System is set up the same as with the steady example of Navier-Stokes,
with the only difference being the weak pressure boundary conditions
not being included, due to the fact that the strong boundary conditions
on the normal velocity mean that they would not be used either way.

.. GENERATED FROM PYTHON SOURCE LINES 53-114

.. code-block:: Python


    pre = KFormUnknown(2, "pre", 2)
    w_pre = pre.weight
    vel = KFormUnknown(2, "vel", 1)
    w_vel = vel.weight
    vor = KFormUnknown(2, "vor", 0)
    w_vor = vor.weight

    system = KFormSystem(
        w_vor.derivative * vel - w_vor * vor == w_vor ^ boundary_velocty,
        # No weak BC for pressure, since normal velocity is given
        (1 / RE) * (w_vel * vor.derivative) + w_vel.derivative * pre
        == -(w_vel * (vel ^ (~vor))),
        w_pre * vel.derivative == 0,
        sorting=lambda f: f.order,
    )
    print(system)

    N = 6
    P = 3

    n1 = N
    n2 = N

    rect_mesh, rx, ry = rmsh.create_elliptical_mesh(
        rmsh.MeshBlock(
            label=None,
            bottom=rmsh.BoundaryCurve.from_knots(n1, (-1, -1), (+1, -1)),
            right=rmsh.BoundaryCurve.from_knots(n2, (+1, -1), (+1, +1)),
            top=rmsh.BoundaryCurve.from_knots(n1, (+1, +1), (-1, +1)),
            left=rmsh.BoundaryCurve.from_knots(n2, (-1, +1), (-1, -1)),
        )
    )
    assert rx < 1e-6, ry < 1e-6

    mesh = Mesh2D(
        P,
        np.stack((rect_mesh.pos_x, rect_mesh.pos_y), axis=-1),
        rect_mesh.lines + 1,
        rect_mesh.surfaces,
    )

    solutions, stats = solve_system_2d(
        mesh,
        SystemSettings(
            system,
            [BoundaryCondition2DSteady(vel, mesh.boundary_indices, boundary_velocty)],
            [(0.0, pre)],
        ),
        solver_settings=SolverSettings(
            maximum_iterations=100,
            absolute_tolerance=1e-10,
            relative_tolerance=0,
        ),
        time_settings=TimeSettings(dt=5, nt=20, time_march_relations={w_vel: vel}),
        print_residual=True,
        recon_order=25,
    )
    print(stats)






.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    [vor(0*)]^T  ([           -1 * M(0) | (E(1, 0))^T @ M(0) |                  0]  [vor(0)]   [<vor, boundary_velocty>])   [vor(0*)]^T  ([                              0 |                        0 | 0]  [vor(0)] 
    [vel(1*)]    ([0.1 * M(1) @ E(1, 0) |                  0 | (E(2, 1))^T @ M(1)]  [vel(1)] = [                       ]) + [vel(1*)]    ([-1 * M(1) @ M(1, 2; vel) @ M(0) | -1 * M(1) @ N(1, 2; vor) | 0]  [vel(1)] 
    [pre(2*)]    ([                   0 |     M(2) @ E(2, 1) |                  0]  [pre(2)]   [                      0])   [pre(2*)]    ([                              0 |                        0 | 0]  [pre(2)] 
    ⠋ - Iteration   0 out of 100[          ] | Error at 3.333e-01 / 1.000e-10 [*|                    | ]    ⠙ - Iteration   1 out of 100[          ] | Error at 1.439e+00 / 1.000e-10 [*|                    | ]    ⠹ - Iteration   2 out of 100[          ] | Error at 1.633e-01 / 1.000e-10 [ |*                   | ]    ⠸ - Iteration   3 out of 100[          ] | Error at 2.998e-02 / 1.000e-10 [ |  *                 | ]    ⠼ - Iteration   4 out of 100[          ] | Error at 9.171e-03 / 1.000e-10 [ |   *                | ]    ⠴ - Iteration   5 out of 100[          ] | Error at 2.124e-03 / 1.000e-10 [ |    *               | ]    ⠦ - Iteration   6 out of 100[          ] | Error at 6.547e-04 / 1.000e-10 [ |     *              | ]    ⠧ - Iteration   7 out of 100[          ] | Error at 1.700e-04 / 1.000e-10 [ |      *             | ]    ⠇ - Iteration   8 out of 100[          ] | Error at 5.200e-05 / 1.000e-10 [ |       *            | ]    ⠏ - Iteration   9 out of 100[          ] | Error at 1.344e-05 / 1.000e-10 [ |         *          | ]    ⠋ - Iteration  10 out of 100[█         ] | Error at 4.368e-06 / 1.000e-10 [ |          *         | ]    ⠙ - Iteration  11 out of 100[█         ] | Error at 1.052e-06 / 1.000e-10 [ |           *        | ]    ⠹ - Iteration  12 out of 100[█         ] | Error at 3.817e-07 / 1.000e-10 [ |            *       | ]    ⠸ - Iteration  13 out of 100[█         ] | Error at 8.002e-08 / 1.000e-10 [ |             *      | ]    ⠼ - Iteration  14 out of 100[█         ] | Error at 3.434e-08 / 1.000e-10 [ |              *     | ]    ⠴ - Iteration  15 out of 100[█         ] | Error at 8.702e-09 / 1.000e-10 [ |               *    | ]    ⠦ - Iteration  16 out of 100[█         ] | Error at 3.554e-09 / 1.000e-10 [ |                *   | ]    ⠧ - Iteration  17 out of 100[█         ] | Error at 9.773e-10 / 1.000e-10 [ |                 *  | ]    ⠇ - Iteration  18 out of 100[█         ] | Error at 4.148e-10 / 1.000e-10 [ |                  * | ]    ⠏ - Iteration  19 out of 100[█         ] | Error at 1.064e-10 / 1.000e-10 [ |                   *| ]    ⠋ - Iteration  20 out of 100[██        ] | Error at 4.730e-11 / 1.000e-10 [ |                    |*]    Time step 0 finished in 20 iterations with residual of 4.73037e-11
    ⠋ - Iteration   0 out of 100[          ] | Error at 2.340e-01 / 1.000e-10 [*|                    | ]    ⠙ - Iteration   1 out of 100[          ] | Error at 2.433e-01 / 1.000e-10 [*|                    | ]    ⠹ - Iteration   2 out of 100[          ] | Error at 6.047e-02 / 1.000e-10 [ | *                  | ]    ⠸ - Iteration   3 out of 100[          ] | Error at 1.104e-02 / 1.000e-10 [ |  *                 | ]    ⠼ - Iteration   4 out of 100[          ] | Error at 5.549e-03 / 1.000e-10 [ |   *                | ]    ⠴ - Iteration   5 out of 100[          ] | Error at 1.221e-03 / 1.000e-10 [ |    *               | ]    ⠦ - Iteration   6 out of 100[          ] | Error at 6.162e-04 / 1.000e-10 [ |     *              | ]    ⠧ - Iteration   7 out of 100[          ] | Error at 2.094e-04 / 1.000e-10 [ |      *             | ]    ⠇ - Iteration   8 out of 100[          ] | Error at 6.968e-05 / 1.000e-10 [ |       *            | ]    ⠏ - Iteration   9 out of 100[          ] | Error at 3.121e-05 / 1.000e-10 [ |        *           | ]    ⠋ - Iteration  10 out of 100[█         ] | Error at 8.815e-06 / 1.000e-10 [ |         *          | ]    ⠙ - Iteration  11 out of 100[█         ] | Error at 4.327e-06 / 1.000e-10 [ |          *         | ]    ⠹ - Iteration  12 out of 100[█         ] | Error at 1.223e-06 / 1.000e-10 [ |           *        | ]    ⠸ - Iteration  13 out of 100[█         ] | Error at 5.886e-07 / 1.000e-10 [ |           *        | ]    ⠼ - Iteration  14 out of 100[█         ] | Error at 1.712e-07 / 1.000e-10 [ |             *      | ]    ⠴ - Iteration  15 out of 100[█         ] | Error at 8.058e-08 / 1.000e-10 [ |             *      | ]    ⠦ - Iteration  16 out of 100[█         ] | Error at 3.337e-08 / 1.000e-10 [ |              *     | ]    ⠧ - Iteration  17 out of 100[█         ] | Error at 1.437e-08 / 1.000e-10 [ |               *    | ]    ⠇ - Iteration  18 out of 100[█         ] | Error at 6.231e-09 / 1.000e-10 [ |                *   | ]    ⠏ - Iteration  19 out of 100[█         ] | Error at 2.839e-09 / 1.000e-10 [ |                *   | ]    ⠋ - Iteration  20 out of 100[██        ] | Error at 1.123e-09 / 1.000e-10 [ |                 *  | ]    ⠙ - Iteration  21 out of 100[██        ] | Error at 5.413e-10 / 1.000e-10 [ |                  * | ]    ⠹ - Iteration  22 out of 100[██        ] | Error at 1.952e-10 / 1.000e-10 [ |                   *| ]    ⠸ - Iteration  23 out of 100[██        ] | Error at 1.021e-10 / 1.000e-10 [ |                   *| ]    ⠼ - Iteration  24 out of 100[██        ] | Error at 3.789e-11 / 1.000e-10 [ |                    |*]    Time step 1 finished in 24 iterations with residual of 3.78858e-11
    ⠋ - Iteration   0 out of 100[          ] | Error at 2.224e-01 / 1.000e-10 [*|                    | ]    ⠙ - Iteration   1 out of 100[          ] | Error at 1.815e-01 / 1.000e-10 [ |*                   | ]    ⠹ - Iteration   2 out of 100[          ] | Error at 4.157e-02 / 1.000e-10 [ | *                  | ]    ⠸ - Iteration   3 out of 100[          ] | Error at 6.878e-03 / 1.000e-10 [ |   *                | ]    ⠼ - Iteration   4 out of 100[          ] | Error at 2.698e-03 / 1.000e-10 [ |    *               | ]    ⠴ - Iteration   5 out of 100[          ] | Error at 5.412e-04 / 1.000e-10 [ |     *              | ]    ⠦ - Iteration   6 out of 100[          ] | Error at 2.168e-04 / 1.000e-10 [ |      *             | ]    ⠧ - Iteration   7 out of 100[          ] | Error at 5.622e-05 / 1.000e-10 [ |       *            | ]    ⠇ - Iteration   8 out of 100[          ] | Error at 1.793e-05 / 1.000e-10 [ |        *           | ]    ⠏ - Iteration   9 out of 100[          ] | Error at 5.950e-06 / 1.000e-10 [ |         *          | ]    ⠋ - Iteration  10 out of 100[█         ] | Error at 1.539e-06 / 1.000e-10 [ |           *        | ]    ⠙ - Iteration  11 out of 100[█         ] | Error at 5.690e-07 / 1.000e-10 [ |           *        | ]    ⠹ - Iteration  12 out of 100[█         ] | Error at 1.685e-07 / 1.000e-10 [ |             *      | ]    ⠸ - Iteration  13 out of 100[█         ] | Error at 5.308e-08 / 1.000e-10 [ |              *     | ]    ⠼ - Iteration  14 out of 100[█         ] | Error at 1.804e-08 / 1.000e-10 [ |               *    | ]    ⠴ - Iteration  15 out of 100[█         ] | Error at 6.674e-09 / 1.000e-10 [ |                *   | ]    ⠦ - Iteration  16 out of 100[█         ] | Error at 2.345e-09 / 1.000e-10 [ |                 *  | ]    ⠧ - Iteration  17 out of 100[█         ] | Error at 8.507e-10 / 1.000e-10 [ |                  * | ]    ⠇ - Iteration  18 out of 100[█         ] | Error at 3.473e-10 / 1.000e-10 [ |                  * | ]    ⠏ - Iteration  19 out of 100[█         ] | Error at 1.333e-10 / 1.000e-10 [ |                   *| ]    ⠋ - Iteration  20 out of 100[██        ] | Error at 4.946e-11 / 1.000e-10 [ |                    |*]    Time step 2 finished in 20 iterations with residual of 4.94558e-11
    ⠋ - Iteration   0 out of 100[          ] | Error at 2.130e-01 / 1.000e-10 [*|                    | ]    ⠙ - Iteration   1 out of 100[          ] | Error at 1.378e-01 / 1.000e-10 [ |*                   | ]    ⠹ - Iteration   2 out of 100[          ] | Error at 3.706e-02 / 1.000e-10 [ | *                  | ]    ⠸ - Iteration   3 out of 100[          ] | Error at 6.043e-03 / 1.000e-10 [ |   *                | ]    ⠼ - Iteration   4 out of 100[          ] | Error at 3.080e-03 / 1.000e-10 [ |   *                | ]    ⠴ - Iteration   5 out of 100[          ] | Error at 5.983e-04 / 1.000e-10 [ |     *              | ]    ⠦ - Iteration   6 out of 100[          ] | Error at 3.158e-04 / 1.000e-10 [ |      *             | ]    ⠧ - Iteration   7 out of 100[          ] | Error at 8.497e-05 / 1.000e-10 [ |       *            | ]    ⠇ - Iteration   8 out of 100[          ] | Error at 3.382e-05 / 1.000e-10 [ |        *           | ]    ⠏ - Iteration   9 out of 100[          ] | Error at 1.149e-05 / 1.000e-10 [ |         *          | ]    ⠋ - Iteration  10 out of 100[█         ] | Error at 3.681e-06 / 1.000e-10 [ |          *         | ]    ⠙ - Iteration  11 out of 100[█         ] | Error at 1.406e-06 / 1.000e-10 [ |           *        | ]    ⠹ - Iteration  12 out of 100[█         ] | Error at 4.765e-07 / 1.000e-10 [ |            *       | ]    ⠸ - Iteration  13 out of 100[█         ] | Error at 1.659e-07 / 1.000e-10 [ |             *      | ]    ⠼ - Iteration  14 out of 100[█         ] | Error at 6.730e-08 / 1.000e-10 [ |             *      | ]    ⠴ - Iteration  15 out of 100[█         ] | Error at 2.061e-08 / 1.000e-10 [ |               *    | ]    ⠦ - Iteration  16 out of 100[█         ] | Error at 9.345e-09 / 1.000e-10 [ |               *    | ]    ⠧ - Iteration  17 out of 100[█         ] | Error at 3.304e-09 / 1.000e-10 [ |                *   | ]    ⠇ - Iteration  18 out of 100[█         ] | Error at 1.449e-09 / 1.000e-10 [ |                 *  | ]    ⠏ - Iteration  19 out of 100[█         ] | Error at 5.276e-10 / 1.000e-10 [ |                  * | ]    ⠋ - Iteration  20 out of 100[██        ] | Error at 2.675e-10 / 1.000e-10 [ |                   *| ]    ⠙ - Iteration  21 out of 100[██        ] | Error at 1.035e-10 / 1.000e-10 [ |                   *| ]    ⠹ - Iteration  22 out of 100[██        ] | Error at 4.774e-11 / 1.000e-10 [ |                    |*]    Time step 3 finished in 22 iterations with residual of 4.77371e-11
    ⠋ - Iteration   0 out of 100[          ] | Error at 2.054e-01 / 1.000e-10 [*|                    | ]    ⠙ - Iteration   1 out of 100[          ] | Error at 1.102e-01 / 1.000e-10 [ |*                   | ]    ⠹ - Iteration   2 out of 100[          ] | Error at 2.978e-02 / 1.000e-10 [ | *                  | ]    ⠸ - Iteration   3 out of 100[          ] | Error at 4.391e-03 / 1.000e-10 [ |   *                | ]    ⠼ - Iteration   4 out of 100[          ] | Error at 2.097e-03 / 1.000e-10 [ |    *               | ]    ⠴ - Iteration   5 out of 100[          ] | Error at 3.663e-04 / 1.000e-10 [ |     *              | ]    ⠦ - Iteration   6 out of 100[          ] | Error at 1.857e-04 / 1.000e-10 [ |      *             | ]    ⠧ - Iteration   7 out of 100[          ] | Error at 4.035e-05 / 1.000e-10 [ |       *            | ]    ⠇ - Iteration   8 out of 100[          ] | Error at 1.728e-05 / 1.000e-10 [ |        *           | ]    ⠏ - Iteration   9 out of 100[          ] | Error at 4.862e-06 / 1.000e-10 [ |         *          | ]    ⠋ - Iteration  10 out of 100[█         ] | Error at 1.640e-06 / 1.000e-10 [ |          *         | ]    ⠙ - Iteration  11 out of 100[█         ] | Error at 5.278e-07 / 1.000e-10 [ |            *       | ]    ⠹ - Iteration  12 out of 100[█         ] | Error at 1.861e-07 / 1.000e-10 [ |            *       | ]    ⠸ - Iteration  13 out of 100[█         ] | Error at 5.541e-08 / 1.000e-10 [ |              *     | ]    ⠼ - Iteration  14 out of 100[█         ] | Error at 2.311e-08 / 1.000e-10 [ |              *     | ]    ⠴ - Iteration  15 out of 100[█         ] | Error at 6.501e-09 / 1.000e-10 [ |                *   | ]    ⠦ - Iteration  16 out of 100[█         ] | Error at 2.811e-09 / 1.000e-10 [ |                *   | ]    ⠧ - Iteration  17 out of 100[█         ] | Error at 9.344e-10 / 1.000e-10 [ |                 *  | ]    ⠇ - Iteration  18 out of 100[█         ] | Error at 4.136e-10 / 1.000e-10 [ |                  * | ]    ⠏ - Iteration  19 out of 100[█         ] | Error at 1.408e-10 / 1.000e-10 [ |                   *| ]    ⠋ - Iteration  20 out of 100[██        ] | Error at 6.631e-11 / 1.000e-10 [ |                    |*]    Time step 4 finished in 20 iterations with residual of 6.63146e-11
    ⠋ - Iteration   0 out of 100[          ] | Error at 1.988e-01 / 1.000e-10 [*|                    | ]    ⠙ - Iteration   1 out of 100[          ] | Error at 8.892e-02 / 1.000e-10 [ |*                   | ]    ⠹ - Iteration   2 out of 100[          ] | Error at 2.750e-02 / 1.000e-10 [ | *                  | ]    ⠸ - Iteration   3 out of 100[          ] | Error at 3.914e-03 / 1.000e-10 [ |   *                | ]    ⠼ - Iteration   4 out of 100[          ] | Error at 2.186e-03 / 1.000e-10 [ |    *               | ]    ⠴ - Iteration   5 out of 100[          ] | Error at 3.851e-04 / 1.000e-10 [ |     *              | ]    ⠦ - Iteration   6 out of 100[          ] | Error at 2.163e-04 / 1.000e-10 [ |      *             | ]    ⠧ - Iteration   7 out of 100[          ] | Error at 4.583e-05 / 1.000e-10 [ |       *            | ]    ⠇ - Iteration   8 out of 100[          ] | Error at 2.257e-05 / 1.000e-10 [ |        *           | ]    ⠏ - Iteration   9 out of 100[          ] | Error at 6.301e-06 / 1.000e-10 [ |         *          | ]    ⠋ - Iteration  10 out of 100[█         ] | Error at 2.403e-06 / 1.000e-10 [ |          *         | ]    ⠙ - Iteration  11 out of 100[█         ] | Error at 7.700e-07 / 1.000e-10 [ |           *        | ]    ⠹ - Iteration  12 out of 100[█         ] | Error at 2.665e-07 / 1.000e-10 [ |            *       | ]    ⠸ - Iteration  13 out of 100[█         ] | Error at 9.035e-08 / 1.000e-10 [ |             *      | ]    ⠼ - Iteration  14 out of 100[█         ] | Error at 3.682e-08 / 1.000e-10 [ |              *     | ]    ⠴ - Iteration  15 out of 100[█         ] | Error at 1.055e-08 / 1.000e-10 [ |               *    | ]    ⠦ - Iteration  16 out of 100[█         ] | Error at 4.969e-09 / 1.000e-10 [ |                *   | ]    ⠧ - Iteration  17 out of 100[█         ] | Error at 1.623e-09 / 1.000e-10 [ |                 *  | ]    ⠇ - Iteration  18 out of 100[█         ] | Error at 7.209e-10 / 1.000e-10 [ |                  * | ]    ⠏ - Iteration  19 out of 100[█         ] | Error at 2.568e-10 / 1.000e-10 [ |                   *| ]    ⠋ - Iteration  20 out of 100[██        ] | Error at 1.298e-10 / 1.000e-10 [ |                   *| ]    ⠙ - Iteration  21 out of 100[██        ] | Error at 4.926e-11 / 1.000e-10 [ |                    |*]    Time step 5 finished in 21 iterations with residual of 4.92628e-11
    ⠋ - Iteration   0 out of 100[          ] | Error at 1.928e-01 / 1.000e-10 [*|                    | ]    ⠙ - Iteration   1 out of 100[          ] | Error at 7.497e-02 / 1.000e-10 [ |*                   | ]    ⠹ - Iteration   2 out of 100[          ] | Error at 2.388e-02 / 1.000e-10 [ | *                  | ]    ⠸ - Iteration   3 out of 100[          ] | Error at 3.148e-03 / 1.000e-10 [ |   *                | ]    ⠼ - Iteration   4 out of 100[          ] | Error at 1.734e-03 / 1.000e-10 [ |    *               | ]    ⠴ - Iteration   5 out of 100[          ] | Error at 3.193e-04 / 1.000e-10 [ |     *              | ]    ⠦ - Iteration   6 out of 100[          ] | Error at 1.600e-04 / 1.000e-10 [ |      *             | ]    ⠧ - Iteration   7 out of 100[          ] | Error at 2.874e-05 / 1.000e-10 [ |        *           | ]    ⠇ - Iteration   8 out of 100[          ] | Error at 1.564e-05 / 1.000e-10 [ |        *           | ]    ⠏ - Iteration   9 out of 100[          ] | Error at 3.708e-06 / 1.000e-10 [ |          *         | ]    ⠋ - Iteration  10 out of 100[█         ] | Error at 1.562e-06 / 1.000e-10 [ |          *         | ]    ⠙ - Iteration  11 out of 100[█         ] | Error at 4.384e-07 / 1.000e-10 [ |            *       | ]    ⠹ - Iteration  12 out of 100[█         ] | Error at 1.696e-07 / 1.000e-10 [ |             *      | ]    ⠸ - Iteration  13 out of 100[█         ] | Error at 5.015e-08 / 1.000e-10 [ |              *     | ]    ⠼ - Iteration  14 out of 100[█         ] | Error at 2.182e-08 / 1.000e-10 [ |              *     | ]    ⠴ - Iteration  15 out of 100[█         ] | Error at 5.747e-09 / 1.000e-10 [ |                *   | ]    ⠦ - Iteration  16 out of 100[█         ] | Error at 2.733e-09 / 1.000e-10 [ |                *   | ]    ⠧ - Iteration  17 out of 100[█         ] | Error at 8.682e-10 / 1.000e-10 [ |                 *  | ]    ⠇ - Iteration  18 out of 100[█         ] | Error at 4.154e-10 / 1.000e-10 [ |                  * | ]    ⠏ - Iteration  19 out of 100[█         ] | Error at 1.398e-10 / 1.000e-10 [ |                   *| ]    ⠋ - Iteration  20 out of 100[██        ] | Error at 6.857e-11 / 1.000e-10 [ |                    |*]    Time step 6 finished in 20 iterations with residual of 6.85678e-11
    ⠋ - Iteration   0 out of 100[          ] | Error at 1.874e-01 / 1.000e-10 [*|                    | ]    ⠙ - Iteration   1 out of 100[          ] | Error at 6.387e-02 / 1.000e-10 [ | *                  | ]    ⠹ - Iteration   2 out of 100[          ] | Error at 2.240e-02 / 1.000e-10 [ | *                  | ]    ⠸ - Iteration   3 out of 100[          ] | Error at 3.347e-03 / 1.000e-10 [ |   *                | ]    ⠼ - Iteration   4 out of 100[          ] | Error at 1.749e-03 / 1.000e-10 [ |    *               | ]    ⠴ - Iteration   5 out of 100[          ] | Error at 3.490e-04 / 1.000e-10 [ |     *              | ]    ⠦ - Iteration   6 out of 100[          ] | Error at 1.713e-04 / 1.000e-10 [ |      *             | ]    ⠧ - Iteration   7 out of 100[          ] | Error at 3.326e-05 / 1.000e-10 [ |        *           | ]    ⠇ - Iteration   8 out of 100[          ] | Error at 1.775e-05 / 1.000e-10 [ |        *           | ]    ⠏ - Iteration   9 out of 100[          ] | Error at 4.097e-06 / 1.000e-10 [ |          *         | ]    ⠋ - Iteration  10 out of 100[█         ] | Error at 1.872e-06 / 1.000e-10 [ |          *         | ]    ⠙ - Iteration  11 out of 100[█         ] | Error at 5.239e-07 / 1.000e-10 [ |           *        | ]    ⠹ - Iteration  12 out of 100[█         ] | Error at 1.972e-07 / 1.000e-10 [ |            *       | ]    ⠸ - Iteration  13 out of 100[█         ] | Error at 6.417e-08 / 1.000e-10 [ |             *      | ]    ⠼ - Iteration  14 out of 100[█         ] | Error at 2.659e-08 / 1.000e-10 [ |              *     | ]    ⠴ - Iteration  15 out of 100[█         ] | Error at 7.823e-09 / 1.000e-10 [ |               *    | ]    ⠦ - Iteration  16 out of 100[█         ] | Error at 3.443e-09 / 1.000e-10 [ |                *   | ]    ⠧ - Iteration  17 out of 100[█         ] | Error at 1.196e-09 / 1.000e-10 [ |                 *  | ]    ⠇ - Iteration  18 out of 100[█         ] | Error at 5.939e-10 / 1.000e-10 [ |                  * | ]    ⠏ - Iteration  19 out of 100[█         ] | Error at 2.154e-10 / 1.000e-10 [ |                   *| ]    ⠋ - Iteration  20 out of 100[██        ] | Error at 1.029e-10 / 1.000e-10 [ |                   *| ]    ⠙ - Iteration  21 out of 100[██        ] | Error at 4.048e-11 / 1.000e-10 [ |                    |*]    Time step 7 finished in 21 iterations with residual of 4.04777e-11
    ⠋ - Iteration   0 out of 100[          ] | Error at 1.825e-01 / 1.000e-10 [*|                    | ]    ⠙ - Iteration   1 out of 100[          ] | Error at 5.677e-02 / 1.000e-10 [ | *                  | ]    ⠹ - Iteration   2 out of 100[          ] | Error at 2.019e-02 / 1.000e-10 [ |  *                 | ]    ⠸ - Iteration   3 out of 100[          ] | Error at 3.207e-03 / 1.000e-10 [ |   *                | ]    ⠼ - Iteration   4 out of 100[          ] | Error at 1.491e-03 / 1.000e-10 [ |    *               | ]    ⠴ - Iteration   5 out of 100[          ] | Error at 3.163e-04 / 1.000e-10 [ |     *              | ]    ⠦ - Iteration   6 out of 100[          ] | Error at 1.412e-04 / 1.000e-10 [ |      *             | ]    ⠧ - Iteration   7 out of 100[          ] | Error at 2.883e-05 / 1.000e-10 [ |        *           | ]    ⠇ - Iteration   8 out of 100[          ] | Error at 1.424e-05 / 1.000e-10 [ |        *           | ]    ⠏ - Iteration   9 out of 100[          ] | Error at 2.815e-06 / 1.000e-10 [ |          *         | ]    ⠋ - Iteration  10 out of 100[█         ] | Error at 1.468e-06 / 1.000e-10 [ |           *        | ]    ⠙ - Iteration  11 out of 100[█         ] | Error at 3.586e-07 / 1.000e-10 [ |            *       | ]    ⠹ - Iteration  12 out of 100[█         ] | Error at 1.584e-07 / 1.000e-10 [ |             *      | ]    ⠸ - Iteration  13 out of 100[█         ] | Error at 4.398e-08 / 1.000e-10 [ |              *     | ]    ⠼ - Iteration  14 out of 100[█         ] | Error at 2.092e-08 / 1.000e-10 [ |              *     | ]    ⠴ - Iteration  15 out of 100[█         ] | Error at 5.710e-09 / 1.000e-10 [ |                *   | ]    ⠦ - Iteration  16 out of 100[█         ] | Error at 2.675e-09 / 1.000e-10 [ |                *   | ]    ⠧ - Iteration  17 out of 100[█         ] | Error at 8.292e-10 / 1.000e-10 [ |                  * | ]    ⠇ - Iteration  18 out of 100[█         ] | Error at 4.329e-10 / 1.000e-10 [ |                  * | ]    ⠏ - Iteration  19 out of 100[█         ] | Error at 1.449e-10 / 1.000e-10 [ |                   *| ]    ⠋ - Iteration  20 out of 100[██        ] | Error at 7.245e-11 / 1.000e-10 [ |                    |*]    Time step 8 finished in 20 iterations with residual of 7.24522e-11
    ⠋ - Iteration   0 out of 100[          ] | Error at 1.779e-01 / 1.000e-10 [*|                    | ]    ⠙ - Iteration   1 out of 100[          ] | Error at 5.249e-02 / 1.000e-10 [ | *                  | ]    ⠹ - Iteration   2 out of 100[          ] | Error at 1.900e-02 / 1.000e-10 [ |  *                 | ]    ⠸ - Iteration   3 out of 100[          ] | Error at 3.311e-03 / 1.000e-10 [ |   *                | ]    ⠼ - Iteration   4 out of 100[          ] | Error at 1.476e-03 / 1.000e-10 [ |    *               | ]    ⠴ - Iteration   5 out of 100[          ] | Error at 3.320e-04 / 1.000e-10 [ |     *              | ]    ⠦ - Iteration   6 out of 100[          ] | Error at 1.454e-04 / 1.000e-10 [ |      *             | ]    ⠧ - Iteration   7 out of 100[          ] | Error at 3.120e-05 / 1.000e-10 [ |        *           | ]    ⠇ - Iteration   8 out of 100[          ] | Error at 1.524e-05 / 1.000e-10 [ |        *           | ]    ⠏ - Iteration   9 out of 100[          ] | Error at 2.865e-06 / 1.000e-10 [ |          *         | ]    ⠋ - Iteration  10 out of 100[█         ] | Error at 1.627e-06 / 1.000e-10 [ |          *         | ]    ⠙ - Iteration  11 out of 100[█         ] | Error at 3.893e-07 / 1.000e-10 [ |            *       | ]    ⠹ - Iteration  12 out of 100[█         ] | Error at 1.764e-07 / 1.000e-10 [ |            *       | ]    ⠸ - Iteration  13 out of 100[█         ] | Error at 5.029e-08 / 1.000e-10 [ |              *     | ]    ⠼ - Iteration  14 out of 100[█         ] | Error at 2.419e-08 / 1.000e-10 [ |              *     | ]    ⠴ - Iteration  15 out of 100[█         ] | Error at 6.969e-09 / 1.000e-10 [ |                *   | ]    ⠦ - Iteration  16 out of 100[█         ] | Error at 3.184e-09 / 1.000e-10 [ |                *   | ]    ⠧ - Iteration  17 out of 100[█         ] | Error at 1.067e-09 / 1.000e-10 [ |                 *  | ]    ⠇ - Iteration  18 out of 100[█         ] | Error at 5.788e-10 / 1.000e-10 [ |                  * | ]    ⠏ - Iteration  19 out of 100[█         ] | Error at 2.054e-10 / 1.000e-10 [ |                   *| ]    ⠋ - Iteration  20 out of 100[██        ] | Error at 9.986e-11 / 1.000e-10 [ |                    |*]    Time step 9 finished in 20 iterations with residual of 9.98632e-11
    ⠋ - Iteration   0 out of 100[          ] | Error at 1.736e-01 / 1.000e-10 [*|                    | ]    ⠙ - Iteration   1 out of 100[          ] | Error at 4.883e-02 / 1.000e-10 [ | *                  | ]    ⠹ - Iteration   2 out of 100[          ] | Error at 1.745e-02 / 1.000e-10 [ |  *                 | ]    ⠸ - Iteration   3 out of 100[          ] | Error at 3.219e-03 / 1.000e-10 [ |   *                | ]    ⠼ - Iteration   4 out of 100[          ] | Error at 1.304e-03 / 1.000e-10 [ |    *               | ]    ⠴ - Iteration   5 out of 100[          ] | Error at 3.142e-04 / 1.000e-10 [ |     *              | ]    ⠦ - Iteration   6 out of 100[          ] | Error at 1.264e-04 / 1.000e-10 [ |      *             | ]    ⠧ - Iteration   7 out of 100[          ] | Error at 2.920e-05 / 1.000e-10 [ |        *           | ]    ⠇ - Iteration   8 out of 100[          ] | Error at 1.311e-05 / 1.000e-10 [ |        *           | ]    ⠏ - Iteration   9 out of 100[          ] | Error at 2.487e-06 / 1.000e-10 [ |          *         | ]    ⠋ - Iteration  10 out of 100[█         ] | Error at 1.398e-06 / 1.000e-10 [ |           *        | ]    ⠙ - Iteration  11 out of 100[█         ] | Error at 3.036e-07 / 1.000e-10 [ |            *       | ]    ⠹ - Iteration  12 out of 100[█         ] | Error at 1.545e-07 / 1.000e-10 [ |             *      | ]    ⠸ - Iteration  13 out of 100[█         ] | Error at 3.954e-08 / 1.000e-10 [ |              *     | ]    ⠼ - Iteration  14 out of 100[█         ] | Error at 2.126e-08 / 1.000e-10 [ |              *     | ]    ⠴ - Iteration  15 out of 100[█         ] | Error at 5.841e-09 / 1.000e-10 [ |                *   | ]    ⠦ - Iteration  16 out of 100[█         ] | Error at 2.838e-09 / 1.000e-10 [ |                *   | ]    ⠧ - Iteration  17 out of 100[█         ] | Error at 8.697e-10 / 1.000e-10 [ |                 *  | ]    ⠇ - Iteration  18 out of 100[█         ] | Error at 4.466e-10 / 1.000e-10 [ |                  * | ]    ⠏ - Iteration  19 out of 100[█         ] | Error at 1.432e-10 / 1.000e-10 [ |                   *| ]    ⠋ - Iteration  20 out of 100[██        ] | Error at 7.657e-11 / 1.000e-10 [ |                    |*]    Time step 10 finished in 20 iterations with residual of 7.65691e-11
    ⠋ - Iteration   0 out of 100[          ] | Error at 1.696e-01 / 1.000e-10 [*|                    | ]    ⠙ - Iteration   1 out of 100[          ] | Error at 4.568e-02 / 1.000e-10 [ | *                  | ]    ⠹ - Iteration   2 out of 100[          ] | Error at 1.639e-02 / 1.000e-10 [ |  *                 | ]    ⠸ - Iteration   3 out of 100[          ] | Error at 3.264e-03 / 1.000e-10 [ |   *                | ]    ⠼ - Iteration   4 out of 100[          ] | Error at 1.273e-03 / 1.000e-10 [ |    *               | ]    ⠴ - Iteration   5 out of 100[          ] | Error at 3.237e-04 / 1.000e-10 [ |     *              | ]    ⠦ - Iteration   6 out of 100[          ] | Error at 1.271e-04 / 1.000e-10 [ |      *             | ]    ⠧ - Iteration   7 out of 100[          ] | Error at 3.084e-05 / 1.000e-10 [ |        *           | ]    ⠇ - Iteration   8 out of 100[          ] | Error at 1.362e-05 / 1.000e-10 [ |        *           | ]    ⠏ - Iteration   9 out of 100[          ] | Error at 2.693e-06 / 1.000e-10 [ |          *         | ]    ⠋ - Iteration  10 out of 100[█         ] | Error at 1.498e-06 / 1.000e-10 [ |          *         | ]    ⠙ - Iteration  11 out of 100[█         ] | Error at 3.310e-07 / 1.000e-10 [ |            *       | ]    ⠹ - Iteration  12 out of 100[█         ] | Error at 1.700e-07 / 1.000e-10 [ |            *       | ]    ⠸ - Iteration  13 out of 100[█         ] | Error at 4.444e-08 / 1.000e-10 [ |              *     | ]    ⠼ - Iteration  14 out of 100[█         ] | Error at 2.435e-08 / 1.000e-10 [ |              *     | ]    ⠴ - Iteration  15 out of 100[█         ] | Error at 6.839e-09 / 1.000e-10 [ |                *   | ]    ⠦ - Iteration  16 out of 100[█         ] | Error at 3.368e-09 / 1.000e-10 [ |                *   | ]    ⠧ - Iteration  17 out of 100[█         ] | Error at 1.058e-09 / 1.000e-10 [ |                 *  | ]    ⠇ - Iteration  18 out of 100[█         ] | Error at 5.561e-10 / 1.000e-10 [ |                  * | ]    ⠏ - Iteration  19 out of 100[█         ] | Error at 1.840e-10 / 1.000e-10 [ |                   *| ]    ⠋ - Iteration  20 out of 100[██        ] | Error at 9.796e-11 / 1.000e-10 [ |                    |*]    Time step 11 finished in 20 iterations with residual of 9.79618e-11
    ⠋ - Iteration   0 out of 100[          ] | Error at 1.658e-01 / 1.000e-10 [*|                    | ]    ⠙ - Iteration   1 out of 100[          ] | Error at 4.290e-02 / 1.000e-10 [ | *                  | ]    ⠹ - Iteration   2 out of 100[          ] | Error at 1.520e-02 / 1.000e-10 [ |  *                 | ]    ⠸ - Iteration   3 out of 100[          ] | Error at 3.188e-03 / 1.000e-10 [ |   *                | ]    ⠼ - Iteration   4 out of 100[          ] | Error at 1.145e-03 / 1.000e-10 [ |    *               | ]    ⠴ - Iteration   5 out of 100[          ] | Error at 3.122e-04 / 1.000e-10 [ |     *              | ]    ⠦ - Iteration   6 out of 100[          ] | Error at 1.134e-04 / 1.000e-10 [ |      *             | ]    ⠧ - Iteration   7 out of 100[          ] | Error at 2.989e-05 / 1.000e-10 [ |        *           | ]    ⠇ - Iteration   8 out of 100[          ] | Error at 1.212e-05 / 1.000e-10 [ |        *           | ]    ⠏ - Iteration   9 out of 100[          ] | Error at 2.699e-06 / 1.000e-10 [ |          *         | ]    ⠋ - Iteration  10 out of 100[█         ] | Error at 1.340e-06 / 1.000e-10 [ |           *        | ]    ⠙ - Iteration  11 out of 100[█         ] | Error at 3.224e-07 / 1.000e-10 [ |            *       | ]    ⠹ - Iteration  12 out of 100[█         ] | Error at 1.518e-07 / 1.000e-10 [ |             *      | ]    ⠸ - Iteration  13 out of 100[█         ] | Error at 4.374e-08 / 1.000e-10 [ |              *     | ]    ⠼ - Iteration  14 out of 100[█         ] | Error at 2.200e-08 / 1.000e-10 [ |              *     | ]    ⠴ - Iteration  15 out of 100[█         ] | Error at 5.789e-09 / 1.000e-10 [ |                *   | ]    ⠦ - Iteration  16 out of 100[█         ] | Error at 3.101e-09 / 1.000e-10 [ |                *   | ]    ⠧ - Iteration  17 out of 100[█         ] | Error at 8.937e-10 / 1.000e-10 [ |                 *  | ]    ⠇ - Iteration  18 out of 100[█         ] | Error at 4.326e-10 / 1.000e-10 [ |                  * | ]    ⠏ - Iteration  19 out of 100[█         ] | Error at 1.444e-10 / 1.000e-10 [ |                   *| ]    ⠋ - Iteration  20 out of 100[██        ] | Error at 7.691e-11 / 1.000e-10 [ |                    |*]    Time step 12 finished in 20 iterations with residual of 7.69062e-11
    ⠋ - Iteration   0 out of 100[          ] | Error at 1.623e-01 / 1.000e-10 [*|                    | ]    ⠙ - Iteration   1 out of 100[          ] | Error at 4.047e-02 / 1.000e-10 [ | *                  | ]    ⠹ - Iteration   2 out of 100[          ] | Error at 1.424e-02 / 1.000e-10 [ |  *                 | ]    ⠸ - Iteration   3 out of 100[          ] | Error at 3.189e-03 / 1.000e-10 [ |   *                | ]    ⠼ - Iteration   4 out of 100[          ] | Error at 1.105e-03 / 1.000e-10 [ |    *               | ]    ⠴ - Iteration   5 out of 100[          ] | Error at 3.180e-04 / 1.000e-10 [ |     *              | ]    ⠦ - Iteration   6 out of 100[          ] | Error at 1.123e-04 / 1.000e-10 [ |      *             | ]    ⠧ - Iteration   7 out of 100[          ] | Error at 3.120e-05 / 1.000e-10 [ |        *           | ]    ⠇ - Iteration   8 out of 100[          ] | Error at 1.236e-05 / 1.000e-10 [ |        *           | ]    ⠏ - Iteration   9 out of 100[          ] | Error at 2.902e-06 / 1.000e-10 [ |          *         | ]    ⠋ - Iteration  10 out of 100[█         ] | Error at 1.408e-06 / 1.000e-10 [ |          *         | ]    ⠙ - Iteration  11 out of 100[█         ] | Error at 3.510e-07 / 1.000e-10 [ |            *       | ]    ⠹ - Iteration  12 out of 100[█         ] | Error at 1.643e-07 / 1.000e-10 [ |             *      | ]    ⠸ - Iteration  13 out of 100[█         ] | Error at 4.951e-08 / 1.000e-10 [ |              *     | ]    ⠼ - Iteration  14 out of 100[█         ] | Error at 2.475e-08 / 1.000e-10 [ |              *     | ]    ⠴ - Iteration  15 out of 100[█         ] | Error at 6.726e-09 / 1.000e-10 [ |                *   | ]    ⠦ - Iteration  16 out of 100[█         ] | Error at 3.620e-09 / 1.000e-10 [ |                *   | ]    ⠧ - Iteration  17 out of 100[█         ] | Error at 1.034e-09 / 1.000e-10 [ |                 *  | ]    ⠇ - Iteration  18 out of 100[█         ] | Error at 5.135e-10 / 1.000e-10 [ |                  * | ]    ⠏ - Iteration  19 out of 100[█         ] | Error at 1.715e-10 / 1.000e-10 [ |                   *| ]    ⠋ - Iteration  20 out of 100[██        ] | Error at 9.118e-11 / 1.000e-10 [ |                    |*]    Time step 13 finished in 20 iterations with residual of 9.11822e-11
    ⠋ - Iteration   0 out of 100[          ] | Error at 1.589e-01 / 1.000e-10 [*|                    | ]    ⠙ - Iteration   1 out of 100[          ] | Error at 3.829e-02 / 1.000e-10 [ | *                  | ]    ⠹ - Iteration   2 out of 100[          ] | Error at 1.327e-02 / 1.000e-10 [ |  *                 | ]    ⠸ - Iteration   3 out of 100[          ] | Error at 3.115e-03 / 1.000e-10 [ |   *                | ]    ⠼ - Iteration   4 out of 100[          ] | Error at 1.004e-03 / 1.000e-10 [ |    *               | ]    ⠴ - Iteration   5 out of 100[          ] | Error at 3.087e-04 / 1.000e-10 [ |     *              | ]    ⠦ - Iteration   6 out of 100[          ] | Error at 1.014e-04 / 1.000e-10 [ |      *             | ]    ⠧ - Iteration   7 out of 100[          ] | Error at 3.060e-05 / 1.000e-10 [ |        *           | ]    ⠇ - Iteration   8 out of 100[          ] | Error at 1.116e-05 / 1.000e-10 [ |         *          | ]    ⠏ - Iteration   9 out of 100[          ] | Error at 2.943e-06 / 1.000e-10 [ |          *         | ]    ⠋ - Iteration  10 out of 100[█         ] | Error at 1.281e-06 / 1.000e-10 [ |           *        | ]    ⠙ - Iteration  11 out of 100[█         ] | Error at 3.371e-07 / 1.000e-10 [ |            *       | ]    ⠹ - Iteration  12 out of 100[█         ] | Error at 1.502e-07 / 1.000e-10 [ |             *      | ]    ⠸ - Iteration  13 out of 100[█         ] | Error at 4.850e-08 / 1.000e-10 [ |              *     | ]    ⠼ - Iteration  14 out of 100[█         ] | Error at 2.233e-08 / 1.000e-10 [ |              *     | ]    ⠴ - Iteration  15 out of 100[█         ] | Error at 6.793e-09 / 1.000e-10 [ |                *   | ]    ⠦ - Iteration  16 out of 100[█         ] | Error at 3.325e-09 / 1.000e-10 [ |                *   | ]    ⠧ - Iteration  17 out of 100[█         ] | Error at 9.181e-10 / 1.000e-10 [ |                 *  | ]    ⠇ - Iteration  18 out of 100[█         ] | Error at 4.831e-10 / 1.000e-10 [ |                  * | ]    ⠏ - Iteration  19 out of 100[█         ] | Error at 1.477e-10 / 1.000e-10 [ |                   *| ]    ⠋ - Iteration  20 out of 100[██        ] | Error at 7.173e-11 / 1.000e-10 [ |                    |*]    Time step 14 finished in 20 iterations with residual of 7.17329e-11
    ⠋ - Iteration   0 out of 100[          ] | Error at 1.556e-01 / 1.000e-10 [*|                    | ]    ⠙ - Iteration   1 out of 100[          ] | Error at 3.637e-02 / 1.000e-10 [ | *                  | ]    ⠹ - Iteration   2 out of 100[          ] | Error at 1.240e-02 / 1.000e-10 [ |  *                 | ]    ⠸ - Iteration   3 out of 100[          ] | Error at 3.084e-03 / 1.000e-10 [ |   *                | ]    ⠼ - Iteration   4 out of 100[          ] | Error at 9.585e-04 / 1.000e-10 [ |    *               | ]    ⠴ - Iteration   5 out of 100[          ] | Error at 3.115e-04 / 1.000e-10 [ |     *              | ]    ⠦ - Iteration   6 out of 100[          ] | Error at 9.908e-05 / 1.000e-10 [ |      *             | ]    ⠧ - Iteration   7 out of 100[          ] | Error at 3.166e-05 / 1.000e-10 [ |        *           | ]    ⠇ - Iteration   8 out of 100[          ] | Error at 1.121e-05 / 1.000e-10 [ |         *          | ]    ⠏ - Iteration   9 out of 100[          ] | Error at 3.145e-06 / 1.000e-10 [ |          *         | ]    ⠋ - Iteration  10 out of 100[█         ] | Error at 1.325e-06 / 1.000e-10 [ |           *        | ]    ⠙ - Iteration  11 out of 100[█         ] | Error at 3.611e-07 / 1.000e-10 [ |            *       | ]    ⠹ - Iteration  12 out of 100[█         ] | Error at 1.603e-07 / 1.000e-10 [ |             *      | ]    ⠸ - Iteration  13 out of 100[█         ] | Error at 5.388e-08 / 1.000e-10 [ |              *     | ]    ⠼ - Iteration  14 out of 100[█         ] | Error at 2.446e-08 / 1.000e-10 [ |              *     | ]    ⠴ - Iteration  15 out of 100[█         ] | Error at 7.832e-09 / 1.000e-10 [ |               *    | ]    ⠦ - Iteration  16 out of 100[█         ] | Error at 3.768e-09 / 1.000e-10 [ |                *   | ]    ⠧ - Iteration  17 out of 100[█         ] | Error at 1.102e-09 / 1.000e-10 [ |                 *  | ]    ⠇ - Iteration  18 out of 100[█         ] | Error at 5.661e-10 / 1.000e-10 [ |                  * | ]    ⠏ - Iteration  19 out of 100[█         ] | Error at 1.655e-10 / 1.000e-10 [ |                   *| ]    ⠋ - Iteration  20 out of 100[██        ] | Error at 8.288e-11 / 1.000e-10 [ |                    |*]    Time step 15 finished in 20 iterations with residual of 8.28754e-11
    ⠋ - Iteration   0 out of 100[          ] | Error at 1.525e-01 / 1.000e-10 [*|                    | ]    ⠙ - Iteration   1 out of 100[          ] | Error at 3.461e-02 / 1.000e-10 [ | *                  | ]    ⠹ - Iteration   2 out of 100[          ] | Error at 1.159e-02 / 1.000e-10 [ |  *                 | ]    ⠸ - Iteration   3 out of 100[          ] | Error at 3.006e-03 / 1.000e-10 [ |   *                | ]    ⠼ - Iteration   4 out of 100[          ] | Error at 8.738e-04 / 1.000e-10 [ |    *               | ]    ⠴ - Iteration   5 out of 100[          ] | Error at 3.026e-04 / 1.000e-10 [ |     *              | ]    ⠦ - Iteration   6 out of 100[          ] | Error at 8.992e-05 / 1.000e-10 [ |       *            | ]    ⠧ - Iteration   7 out of 100[          ] | Error at 3.109e-05 / 1.000e-10 [ |        *           | ]    ⠇ - Iteration   8 out of 100[          ] | Error at 1.018e-05 / 1.000e-10 [ |         *          | ]    ⠏ - Iteration   9 out of 100[          ] | Error at 3.176e-06 / 1.000e-10 [ |          *         | ]    ⠋ - Iteration  10 out of 100[█         ] | Error at 1.212e-06 / 1.000e-10 [ |           *        | ]    ⠙ - Iteration  11 out of 100[█         ] | Error at 3.407e-07 / 1.000e-10 [ |            *       | ]    ⠹ - Iteration  12 out of 100[█         ] | Error at 1.486e-07 / 1.000e-10 [ |             *      | ]    ⠸ - Iteration  13 out of 100[█         ] | Error at 5.168e-08 / 1.000e-10 [ |              *     | ]    ⠼ - Iteration  14 out of 100[█         ] | Error at 2.189e-08 / 1.000e-10 [ |              *     | ]    ⠴ - Iteration  15 out of 100[█         ] | Error at 7.674e-09 / 1.000e-10 [ |               *    | ]    ⠦ - Iteration  16 out of 100[█         ] | Error at 3.429e-09 / 1.000e-10 [ |                *   | ]    ⠧ - Iteration  17 out of 100[█         ] | Error at 1.112e-09 / 1.000e-10 [ |                 *  | ]    ⠇ - Iteration  18 out of 100[█         ] | Error at 5.250e-10 / 1.000e-10 [ |                  * | ]    ⠏ - Iteration  19 out of 100[█         ] | Error at 1.563e-10 / 1.000e-10 [ |                   *| ]    ⠋ - Iteration  20 out of 100[██        ] | Error at 7.866e-11 / 1.000e-10 [ |                    |*]    Time step 16 finished in 20 iterations with residual of 7.86609e-11
    ⠋ - Iteration   0 out of 100[          ] | Error at 1.496e-01 / 1.000e-10 [*|                    | ]    ⠙ - Iteration   1 out of 100[          ] | Error at 3.305e-02 / 1.000e-10 [ | *                  | ]    ⠹ - Iteration   2 out of 100[          ] | Error at 1.080e-02 / 1.000e-10 [ |  *                 | ]    ⠸ - Iteration   3 out of 100[          ] | Error at 2.951e-03 / 1.000e-10 [ |   *                | ]    ⠼ - Iteration   4 out of 100[          ] | Error at 8.268e-04 / 1.000e-10 [ |    *               | ]    ⠴ - Iteration   5 out of 100[          ] | Error at 3.028e-04 / 1.000e-10 [ |     *              | ]    ⠦ - Iteration   6 out of 100[          ] | Error at 8.681e-05 / 1.000e-10 [ |       *            | ]    ⠧ - Iteration   7 out of 100[          ] | Error at 3.189e-05 / 1.000e-10 [ |        *           | ]    ⠇ - Iteration   8 out of 100[          ] | Error at 1.009e-05 / 1.000e-10 [ |         *          | ]    ⠏ - Iteration   9 out of 100[          ] | Error at 3.362e-06 / 1.000e-10 [ |          *         | ]    ⠋ - Iteration  10 out of 100[█         ] | Error at 1.235e-06 / 1.000e-10 [ |           *        | ]    ⠙ - Iteration  11 out of 100[█         ] | Error at 3.568e-07 / 1.000e-10 [ |            *       | ]    ⠹ - Iteration  12 out of 100[█         ] | Error at 1.562e-07 / 1.000e-10 [ |             *      | ]    ⠸ - Iteration  13 out of 100[█         ] | Error at 5.592e-08 / 1.000e-10 [ |              *     | ]    ⠼ - Iteration  14 out of 100[█         ] | Error at 2.328e-08 / 1.000e-10 [ |              *     | ]    ⠴ - Iteration  15 out of 100[█         ] | Error at 8.574e-09 / 1.000e-10 [ |               *    | ]    ⠦ - Iteration  16 out of 100[█         ] | Error at 3.760e-09 / 1.000e-10 [ |                *   | ]    ⠧ - Iteration  17 out of 100[█         ] | Error at 1.284e-09 / 1.000e-10 [ |                 *  | ]    ⠇ - Iteration  18 out of 100[█         ] | Error at 5.929e-10 / 1.000e-10 [ |                  * | ]    ⠏ - Iteration  19 out of 100[█         ] | Error at 1.872e-10 / 1.000e-10 [ |                   *| ]    ⠋ - Iteration  20 out of 100[██        ] | Error at 9.149e-11 / 1.000e-10 [ |                    |*]    Time step 17 finished in 20 iterations with residual of 9.14861e-11
    ⠋ - Iteration   0 out of 100[          ] | Error at 1.468e-01 / 1.000e-10 [*|                    | ]    ⠙ - Iteration   1 out of 100[          ] | Error at 3.160e-02 / 1.000e-10 [ | *                  | ]    ⠹ - Iteration   2 out of 100[          ] | Error at 1.010e-02 / 1.000e-10 [ |  *                 | ]    ⠸ - Iteration   3 out of 100[          ] | Error at 2.868e-03 / 1.000e-10 [ |   *                | ]    ⠼ - Iteration   4 out of 100[          ] | Error at 7.544e-04 / 1.000e-10 [ |    *               | ]    ⠴ - Iteration   5 out of 100[          ] | Error at 2.935e-04 / 1.000e-10 [ |     *              | ]    ⠦ - Iteration   6 out of 100[          ] | Error at 7.885e-05 / 1.000e-10 [ |       *            | ]    ⠧ - Iteration   7 out of 100[          ] | Error at 3.122e-05 / 1.000e-10 [ |        *           | ]    ⠇ - Iteration   8 out of 100[          ] | Error at 9.170e-06 / 1.000e-10 [ |         *          | ]    ⠏ - Iteration   9 out of 100[          ] | Error at 3.364e-06 / 1.000e-10 [ |          *         | ]    ⠋ - Iteration  10 out of 100[█         ] | Error at 1.130e-06 / 1.000e-10 [ |           *        | ]    ⠙ - Iteration  11 out of 100[█         ] | Error at 3.599e-07 / 1.000e-10 [ |            *       | ]    ⠹ - Iteration  12 out of 100[█         ] | Error at 1.445e-07 / 1.000e-10 [ |             *      | ]    ⠸ - Iteration  13 out of 100[█         ] | Error at 5.271e-08 / 1.000e-10 [ |              *     | ]    ⠼ - Iteration  14 out of 100[█         ] | Error at 2.061e-08 / 1.000e-10 [ |              *     | ]    ⠴ - Iteration  15 out of 100[█         ] | Error at 8.220e-09 / 1.000e-10 [ |               *    | ]    ⠦ - Iteration  16 out of 100[█         ] | Error at 3.389e-09 / 1.000e-10 [ |                *   | ]    ⠧ - Iteration  17 out of 100[█         ] | Error at 1.256e-09 / 1.000e-10 [ |                 *  | ]    ⠇ - Iteration  18 out of 100[█         ] | Error at 5.434e-10 / 1.000e-10 [ |                  * | ]    ⠏ - Iteration  19 out of 100[█         ] | Error at 1.876e-10 / 1.000e-10 [ |                   *| ]    ⠋ - Iteration  20 out of 100[██        ] | Error at 8.536e-11 / 1.000e-10 [ |                    |*]    Time step 18 finished in 20 iterations with residual of 8.53561e-11
    ⠋ - Iteration   0 out of 100[          ] | Error at 1.441e-01 / 1.000e-10 [*|                    | ]    ⠙ - Iteration   1 out of 100[          ] | Error at 3.031e-02 / 1.000e-10 [ | *                  | ]    ⠹ - Iteration   2 out of 100[          ] | Error at 9.390e-03 / 1.000e-10 [ |  *                 | ]    ⠸ - Iteration   3 out of 100[          ] | Error at 2.914e-03 / 1.000e-10 [ |   *                | ]    ⠼ - Iteration   4 out of 100[          ] | Error at 7.074e-04 / 1.000e-10 [ |     *              | ]    ⠴ - Iteration   5 out of 100[          ] | Error at 2.916e-04 / 1.000e-10 [ |     *              | ]    ⠦ - Iteration   6 out of 100[          ] | Error at 7.527e-05 / 1.000e-10 [ |       *            | ]    ⠧ - Iteration   7 out of 100[          ] | Error at 3.174e-05 / 1.000e-10 [ |       *            | ]    ⠇ - Iteration   8 out of 100[          ] | Error at 8.971e-06 / 1.000e-10 [ |         *          | ]    ⠏ - Iteration   9 out of 100[          ] | Error at 3.524e-06 / 1.000e-10 [ |          *         | ]    ⠋ - Iteration  10 out of 100[█         ] | Error at 1.136e-06 / 1.000e-10 [ |           *        | ]    ⠙ - Iteration  11 out of 100[█         ] | Error at 3.918e-07 / 1.000e-10 [ |            *       | ]    ⠹ - Iteration  12 out of 100[█         ] | Error at 1.495e-07 / 1.000e-10 [ |             *      | ]    ⠸ - Iteration  13 out of 100[█         ] | Error at 5.553e-08 / 1.000e-10 [ |              *     | ]    ⠼ - Iteration  14 out of 100[█         ] | Error at 2.125e-08 / 1.000e-10 [ |              *     | ]    ⠴ - Iteration  15 out of 100[█         ] | Error at 8.904e-09 / 1.000e-10 [ |               *    | ]    ⠦ - Iteration  16 out of 100[█         ] | Error at 3.599e-09 / 1.000e-10 [ |                *   | ]    ⠧ - Iteration  17 out of 100[█         ] | Error at 1.398e-09 / 1.000e-10 [ |                 *  | ]    ⠇ - Iteration  18 out of 100[█         ] | Error at 5.927e-10 / 1.000e-10 [ |                  * | ]    ⠏ - Iteration  19 out of 100[█         ] | Error at 2.149e-10 / 1.000e-10 [ |                   *| ]    ⠋ - Iteration  20 out of 100[██        ] | Error at 9.549e-11 / 1.000e-10 [ |                    |*]    Time step 19 finished in 20 iterations with residual of 9.54870e-11
    SolutionStatistics(element_orders={3: 50}, n_total_dofs=1550, n_leaf_dofs=1225, n_lagrange=325, n_elems=25, n_leaves=25, iter_history=array([20, 24, 20, 22, 20, 21, 20, 21, 20, 20, 20, 20, 20, 20, 20, 20, 20,
           20, 20, 20], dtype=uint32), residual_history=array([4.73037165e-11, 3.78858472e-11, 4.94558422e-11, 4.77370712e-11,
           6.63145927e-11, 4.92627883e-11, 6.85677626e-11, 4.04777045e-11,
           7.24521970e-11, 9.98632288e-11, 7.65691122e-11, 9.79617637e-11,
           7.69061551e-11, 9.11821799e-11, 7.17328905e-11, 8.28754287e-11,
           7.86609389e-11, 9.14861242e-11, 8.53561388e-11, 9.54870072e-11]))




.. GENERATED FROM PYTHON SOURCE LINES 115-120

Plot Streamlines
----------------

Pyvista allows for very simple 2D streamline plots.


.. GENERATED FROM PYTHON SOURCE LINES 121-142

.. code-block:: Python


    plotter = pv.Plotter(off_screen=True, shape=(1, 1), window_size=(1600, 800))

    solution = solutions[-1]
    solution.point_data[vel.label] = np.pad(solution.point_data[vel.label], ((0, 0), (0, 1)))
    plotter.add_mesh(solution.copy(), scalars=vor.label, clim=(-5, +5))
    plotter.add_mesh(solution.extract_all_edges(), color="black")
    plotter.add_mesh(
        solution.streamlines_evenly_spaced_2D(
            vectors=vel.label,
            step_length=0.3,
            start_position=(0, 0, 0),
            separating_distance=0.2,
            separating_distance_ratio=0.1,
            compute_vorticity=False,
        ),
        scalars=None,
        show_scalar_bar=False,
        color="white",
    )
    plotter.view_xy()



.. image-sg:: /auto_examples/unsteady/images/sphx_glr_plot_cavity_flow_001.png
   :alt: plot cavity flow
   :srcset: /auto_examples/unsteady/images/sphx_glr_plot_cavity_flow_001.png
   :class: sphx-glr-single-img






.. rst-class:: sphx-glr-timing

   **Total running time of the script:** (0 minutes 9.578 seconds)


.. _sphx_glr_download_auto_examples_unsteady_plot_cavity_flow.py:

.. only:: html

  .. container:: sphx-glr-footer sphx-glr-footer-example

    .. container:: sphx-glr-download sphx-glr-download-jupyter

      :download:`Download Jupyter notebook: plot_cavity_flow.ipynb <plot_cavity_flow.ipynb>`

    .. container:: sphx-glr-download sphx-glr-download-python

      :download:`Download Python source code: plot_cavity_flow.py <plot_cavity_flow.py>`

    .. container:: sphx-glr-download sphx-glr-download-zip

      :download:`Download zipped: plot_cavity_flow.zip <plot_cavity_flow.zip>`


.. only:: html

 .. rst-class:: sphx-glr-signature

    `Gallery generated by Sphinx-Gallery <https://sphinx-gallery.github.io>`_
